

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>(??) Fit neurons (MT) &#8212; MT/MST project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'nb/2023-04/??_reservoir';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../md/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../md/intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2022-01.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2022-01_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022-01/jan-23-2022.html">Jan 23rd, 2022 (jb tutorial)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">October 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2022-10.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2022-10_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-01-2022.html">Oct 1st, 2022 (Load Wild Data)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-06-2022.html">Oct 6th, 2022 (Python processed)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-07-2022.html">Oct 7th, 2022 (Linear: STA – draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-08-2022.html">Oct 8th, 2022 (Linear: STA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-09-2022.html">Oct 9th, 2022 (Opticflow stats)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-11-2022.html">Oct 11th, 2022 (Rot Conv verify)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-16-2022.html">Oct 16th, 2022 (Linear: GLM – spatial)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-01.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-01_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/08_wild.html">(08) Wild play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/10_nardin.html">(10) Nardin play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/15_sim-draft.html">(15) Simulation – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/16_sim-wrong.html">(16) Simulation – wrong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/21_sim-explore.html">(21) Simulation – explore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/23_sim-self-draft.html">(23) Simulation – self-motion aspect [draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/24_sim-self-draft.html">(24) Simulation – self [still draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/28_sim-self.html">(28) Simulation – self [velocity: new way]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/29_sim-full-draft.html">(29) Simulation – full [draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/30_sim-full-final.html">(30) Simulation – full [final]</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">February 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-02.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-02_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/01_play-nvae.html">(01) NVAE – play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/02_play-vae2d.html">(02) VAE2D – play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/09_rot-conv.html">(09) RotConv2d – verified</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/23_sim-gen.html">(23) Simulation – generate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/24_sim-gen-decoupled.html">(24) Simulation – generate (fix &amp; obj uncoupled)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/24_sim-gen-save.html">(24) Simulation – generate (save)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda.html">(25) Fit – cuda (gaban)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda0.html">(25) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda1.html">(25) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda2.html">(25) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/30_kl-balancer-debug.html">(30) KL Balancer</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">March 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-03.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-03_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/17_sim-new-draft.html">(17) Sim New – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/22_sim-new-draft.html">(22) Sim New – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/23_sim-new.html">(23) Sim New – visualize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda.html">(30) Fit – cuda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda0.html">(30) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda1.html">(30) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda2.html">(30) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_sim-final.html">(30) Sim – added <code class="docutils literal notranslate"><span class="pre">terrain</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/31_sim-factors.html">(31) Sim – true generative factors</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">April 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-04.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-04_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="02_fit-lin.html">(02) Fit neurons – Linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_fit-glm.html">(03) Fit neurons – GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_loop-glm.html">(03) Fit neurons – GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_loop-ridge.html">(03) Fit neurons – Ridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_dan.html">(04) Dan notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_profiler.html">(04) PyTorch profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_sim-kNN.html">(06) Sim – kNN analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_readout-3d.html">(07) Readout: 3D conv</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_readout-sep.html">(07) Readout: Separable</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_GLM-clu090.html">(08) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_GLM-clu096.html">(08) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_sim-accept-filter.html">(08) Sim – behavior of <code class="docutils literal notranslate"><span class="pre">filter()</span></code> when <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="08_sim-dim65-manyseeds.html">(08) Sim – many seeds <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="09_sim-final-save.html">(09) Sim – generate &amp; save <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="10_GLM-clu090.html">(10) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_GLM-pix.html">(12) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_dim17-accept-filter.html">(13) Sim – behavior of <code class="docutils literal notranslate"><span class="pre">filter()</span></code> when <code class="docutils literal notranslate"><span class="pre">dim=17</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="13_dim17-dists.html">(13) Sim – dists for <code class="docutils literal notranslate"><span class="pre">dim=17</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda.html">(13) Fit – cuda</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda0.html">(13) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda1.html">(13) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda2.html">(13) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_GLM-loop.html">(14) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_GLM-loop.html">(15) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_GLM-save.html">(16) Reservoir + GLM + Save</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_fixate1-glm-GABAN.html">(18) Fixate1 + GLM (GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_fixate1-glm-KABA.html">(18) Fixate1 + GLM (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="20_examine-readout-GABAN.html">(20) Load and plot readout results</a></li>
<li class="toctree-l2"><a class="reference internal" href="20_examine-readout-KABA.html">(20) Load and plot readout results</a></li>
<li class="toctree-l2"><a class="reference internal" href="23_nardin.html">(21) Nardin play</a></li>
<li class="toctree-l2"><a class="reference internal" href="24_meeting-plots.html">(24) Make some figs</a></li>
<li class="toctree-l2"><a class="reference internal" href="25_diameters.html">(25) Diameters: dist</a></li>
<li class="toctree-l2"><a class="reference internal" href="26_combine-fits.html">(26) Combine fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="28_eval.html">(28) Eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="%3F%3F_logging.html">(??) Regression – DCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="tmp.html">(??) Tmp</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hadivafaii/jb-MTMST" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hadivafaii/jb-MTMST/issues/new?title=Issue%20on%20page%20%2Fnb/2023-04/??_reservoir.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/nb/2023-04/??_reservoir.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>(??) Fit neurons (MT)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-neuron">Load neuron</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir">Reservoir</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-features">Extract features</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-what-is-r-between-pred-and-y-trn">TODO: what is r between pred and y_trn?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-neuron-clu267">Another neuron: <code class="docutils literal notranslate"><span class="pre">clu267</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Reservoir</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Reservoir</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Extract features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neuron-7">Neuron # 7</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fit-neurons-mt">
<h1>(??) Fit neurons (MT)<a class="headerlink" href="#fit-neurons-mt" title="Permalink to this headline">#</a></h1>
<p><strong>Motivation</strong>: Load models, evaluate then fit MT <br></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/_extras&#39;</span><span class="p">)</span>
<span class="n">fig_base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/figs&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/tmp&#39;</span><span class="p">)</span>

<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;_MTMST&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">vae.train_vae</span> <span class="kn">import</span> <span class="n">TrainerVAE</span><span class="p">,</span> <span class="n">ConfigTrainVAE</span>
<span class="kn">from</span> <span class="nn">vae.vae2d</span> <span class="kn">import</span> <span class="n">VAE</span><span class="p">,</span> <span class="n">ConfigVAE</span>
<span class="kn">from</span> <span class="nn">analysis.opticflow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">figures.fighelper</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># warnings, tqdm, &amp; style</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">rich.jupyter</span> <span class="kn">import</span> <span class="nb">print</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">set_style</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">analysis.linear</span> <span class="kn">import</span> <span class="n">LinearModel</span><span class="p">,</span> <span class="n">flatten_stim</span>
<span class="kn">from</span> <span class="nn">base.dataset</span> <span class="kn">import</span> <span class="n">setup_supervised_data</span><span class="p">,</span> <span class="n">setup_repeat_data</span><span class="p">,</span> <span class="n">time_embed</span>
</pre></div>
</div>
</div>
</div>
<section id="load-neuron">
<h2>Load neuron<a class="headerlink" href="#load-neuron" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConfigVAE</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">h_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">expt</span> <span class="o">=</span> <span class="s1">&#39;clu090&#39;</span>
<span class="n">grp</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">expt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scale</span> <span class="o">=</span> <span class="mf">2.25</span>
<span class="n">hf_kws</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s1">&#39;sres&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">hf</span> <span class="o">=</span> <span class="n">HyperFlow</span><span class="p">(</span>
    <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="mi">2</span><span class="p">:],</span>
    <span class="n">center</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="o">**</span><span class="n">hf_kws</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">stim</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">compute_hyperflow</span><span class="p">()</span>
<span class="n">spks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;spks&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">good</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;badspks&#39;</span><span class="p">])</span>
<span class="n">good</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">good</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># src, tgt = setup_supervised_data(lags, good, stim, spks)</span>
<span class="n">stim_r</span><span class="p">,</span> <span class="n">spks_r</span><span class="p">,</span> <span class="n">intvl</span> <span class="o">=</span> <span class="n">setup_repeat_data</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_kws</span><span class="o">=</span><span class="n">hf_kws</span><span class="p">)</span>

<span class="n">stim_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
<span class="n">stim</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>
<span class="k">if</span> <span class="n">stim_r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">stim_r</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>

<span class="n">stim</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">stim_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((72000, 2, 19, 19), (36000, 2, 19, 19))
</pre></div>
</div>
</div>
</div>
</section>
<section id="reservoir">
<h2>Reservoir<a class="headerlink" href="#reservoir" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">ConfigVAE</span><span class="p">(</span>
    <span class="n">n_kers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">n_latent_scales</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_groups_per_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_latent_per_group</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">scale_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">residual_kl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ada_groups</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">TrainerVAE</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">ConfigTrainVAE</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">total_latents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>210
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
<span class="n">vae</span><span class="o">.</span><span class="n">scales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+--------------+------------+
| Module Name  | Num Params |
+--------------+------------+
|     VAE      |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.0</span> Mil  |
|     ---      |    ---     |
|     stem     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1</span> K    |
| pre_process  |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96.0</span> K   |
|  enc_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.4</span> Mil   |
|     enc0     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.6</span> K   |
| enc_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
| dec_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
|    expand    |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.0</span> K   |
|  dec_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> Mil   |
| post_process |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.0</span> K   |
|     out      |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">578</span>     |
+--------------+------------+ 


</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, 4]
</pre></div>
</div>
</div>
</div>
<section id="extract-features">
<h3>Extract features<a class="headerlink" href="#extract-features" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stim</span>
<span class="n">enc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">)</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)))):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stim</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">])</span>
    <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">e4</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">e8</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
        <span class="nb">input</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">enc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4</span><span class="p">,</span> <span class="n">e8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>

<span class="c1"># Stim Repeat</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stim_r</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">e4_r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">e8_r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
    <span class="nb">input</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">enc_r</span> <span class="o">=</span> <span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4_r</span><span class="p">,</span> <span class="n">e8_r</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">enc</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">enc_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████| 144/144 [00:52&lt;00:00,  2.73it/s]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((72000, 5312, 4, 4), (1000, 5312, 4, 4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc_r</span><span class="p">))</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((72000, 500), (1000, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>
    
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">x_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
    <span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;~&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.303702294021782</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.07040245621759</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.23168658917338</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/dbbadf63bc525e56bd5b8157ad7fed64c008456d3628e72af41c6ffd42cbee26.png" src="../../_images/dbbadf63bc525e56bd5b8157ad7fed64c008456d3628e72af41c6ffd42cbee26.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.23573361705703</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.13576744951038</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.65558165842052</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/ebf74c1f143abc303dc6baa216b0beb4c2e9c2b062d43756f586e6b6960953cc.png" src="../../_images/ebf74c1f143abc303dc6baa216b0beb4c2e9c2b062d43756f586e6b6960953cc.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-69.64174009158128</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.636720000772385</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.74115544874821</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/0ee53e67b1f1cea527fc35f2f24f409a6c3194184c22e78fc2bf3ff0aed46a01.png" src="../../_images/0ee53e67b1f1cea527fc35f2f24f409a6c3194184c22e78fc2bf3ff0aed46a01.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-94.31653402058492</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.37264128293487</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.5962220961835</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/bbbd2f156e464f1b18a92f03e0ee0ea5d5ac47d5b19c8add6bdb47a1a202acff.png" src="../../_images/bbbd2f156e464f1b18a92f03e0ee0ea5d5ac47d5b19c8add6bdb47a1a202acff.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-95.68296477393112</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.00168055716584</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.60839899001178</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/fee38ba0dfc6a1b3806eb14560ebf00511d8b2be63f3fb0a91fc1936ba4dfa33.png" src="../../_images/fee38ba0dfc6a1b3806eb14560ebf00511d8b2be63f3fb0a91fc1936ba4dfa33.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-82.63456533995075</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.224893742165804</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.47464543015665</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/2f5e2ec039daed7eca8835563b1bd791a878fb2083c5168123fe4606ff24b031.png" src="../../_images/2f5e2ec039daed7eca8835563b1bd791a878fb2083c5168123fe4606ff24b031.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-63.90301386116959</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.31496397954474</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.070480099414137</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/373056a83039aa1fe4a3be24122b3ee444d3dc0c5146107a175566b462a1eb93.png" src="../../_images/373056a83039aa1fe4a3be24122b3ee444d3dc0c5146107a175566b462a1eb93.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-44.18051086991483</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.4439876882096154</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.2277712257947604</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/cc0594c3f09f7c1cd56221e80d73a33c91e0cbaa95f21df75c2f7deef3f4bed0.png" src="../../_images/cc0594c3f09f7c1cd56221e80d73a33c91e0cbaa95f21df75c2f7deef3f4bed0.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">good</span><span class="p">)</span>
<span class="n">src_r</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">intvl</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">src_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((54386, 5, 500), (200, 5, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">src_r</span><span class="p">,</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.787549034207046</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.00812149451333</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.14655501593958</span><span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<section id="todo-what-is-r-between-pred-and-y-trn">
<h4>TODO: what is r between pred and y_trn?<a class="headerlink" href="#todo-what-is-r-between-pred-and-y-trn" title="Permalink to this headline">#</a></h4>
<p>Use this to calibrate your expectations of the Conv3D model that is running on Cuda:1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(54386,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pred</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/90d51b40618de29017e654a35054f0c0e9029993a58fc0bcdfa4a05f75f76d84.png" src="../../_images/90d51b40618de29017e654a35054f0c0e9029993a58fc0bcdfa4a05f75f76d84.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp_stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span> <span class="n">pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.2910217247130925, 0.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.88628477613221</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.07998697957536</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.803989856854027</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.200090545108051</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.372907007006905</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31.626102279419634</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.53823622976818</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.760925598463274</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.809941353133436</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.50059746738271</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.458186513856475</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.04140535023382</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.4215249858006</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.1345893853703</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.250497317802385</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.84568947472112</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.595636706869257</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.108051583593014</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.41549486189459</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.90832918786476</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0376026961835048</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.45090074721545</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.33396062460725</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.715965601877265</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-142.95786446570565</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-161.85240369493715</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-121.37702026103537</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-60.6510439132681</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-175.71343353191287</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.297179810140527</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.0786150964219</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66.42561925896864</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.786726774946864</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.591662374950886</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.114230252844802</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.41352296151989</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.212554391247686</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.24974906412323</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.556597957824586</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.125156135786014</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.77115803849767</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.227380670483061</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.073199545120413</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.20247003885475</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-483.3049047890623</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-873.8526849554321</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-241.351295725346</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-85.79240966990096</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.582925222718806</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.88214350279159</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.51342272430204</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.817071588083852</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.067600833173088</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.501291571278472</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.403669636638027</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.115669111144422</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-331.59465678240485</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.492412166475475</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.487474629781005</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31.76987606020305</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-108.84217011902363</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.24027863881393</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.6165835373206425</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.11927506662155</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3h 11min 40s, sys: 24min 59s, total: 3h 36min 39s
Wall time: 48min 30s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2456880/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a0884964ba40c2a96f1b38aa94ffc0810d0e63bf8ba277704a05f36060808730.png" src="../../_images/a0884964ba40c2a96f1b38aa94ffc0810d0e63bf8ba277704a05f36060808730.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.008521475472016</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.4215249858006</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.1345893853703</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.14234636286034</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 12min 20s, sys: 1min 40s, total: 14min
Wall time: 3min 11s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 51.008521475472016,
 0.005: 68.4215249858006,
 0.01: 68.1345893853703,
 0.03: 62.14234636286034}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 0.775161130449842,
 0.005: 0.8282908049278253,
 0.01: 0.8278796889546903,
 0.03: 0.8360040524579301}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/116ffc54229d854a16bb9ce55c3ac0b5377b5ea957ede79a29e0c0909f200427.png" src="../../_images/116ffc54229d854a16bb9ce55c3ac0b5377b5ea957ede79a29e0c0909f200427.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">8e-3</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.008521475472016</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.64272725095095</span><span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 7min 9s, sys: 57.9 s, total: 8min 7s
Wall time: 1min 52s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/14fb3ae0da07c6d1d54e932d6a7f88be4d4f006be5434fc9c259deb37257b585.png" src="../../_images/14fb3ae0da07c6d1d54e932d6a7f88be4d4f006be5434fc9c259deb37257b585.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.620833661532856</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.73280416563001</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.88607909687642</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.534939583145729</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.481304709670795</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.225870171918434</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.82857113791968</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.967546962093795</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.247746768830837</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.6771601217158</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.961977524761124</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.09666361114553</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73.73576121198646</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73.88461227680936</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.89730582896179</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.18703136327374</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.53250501238174</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.85490131694263</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.25825227526537</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.942512422352042</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.695456645532353</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.347546386732496</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.48318383134491</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.85706886219539</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-294.16961324664845</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-228.80219011776762</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-150.65127991536906</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-73.97429914967704</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-125.65038560201182</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.366855445390296</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.76711322538855</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.8743999574422</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.517786163452744</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.5428817358841</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.487418252496862</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.336313216152035</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.44357805216618</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59.13667117135945</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.14235833564682</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.31622984683137</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.35659608965757</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.06952339432246</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0685673309302497</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.799575869454532</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-906.4656004371702</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-582.1211520931226</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-343.9997840584188</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-93.82358015183985</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.053441180057185</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.90104345650469</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.3674782462358</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.060883117983227</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.45046547671018</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.452053564788248</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.175896788188602</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.236563995979967</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-13.549677981868546</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.294752786996476</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.69756774523514</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.487164706552264</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-81.3098562408521</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-91.38082354485175</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1600959833629076</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.699765296919182</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2h 52min 48s, sys: 25min 36s, total: 3h 18min 25s
Wall time: 49min 23s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2969908/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0c59b84b6db80695e8b4bc6e7b1c12bb7053444e175749553651836f89ecb502.png" src="../../_images/0c59b84b6db80695e8b4bc6e7b1c12bb7053444e175749553651836f89ecb502.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.0956011152039</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73.88461227680936</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.89730582896179</span><span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 8min 59s, sys: 1min 9s, total: 10min 8s
Wall time: 2min 13s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 61.0956011152039, 0.01: 73.88461227680936, 0.05: 53.89730582896179}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 0.8066820117593878, 0.01: 0.8626518723561223, 0.05: 0.8692976787845867}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/12cf568b2f60117c79ac344dda2733ed5ac51dd50cd754988eb75d37136584fd.png" src="../../_images/12cf568b2f60117c79ac344dda2733ed5ac51dd50cd754988eb75d37136584fd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70.88916643251153</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.07950939031531</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.62691499801377</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70.20907595304146</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67.29583982325616</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.05871082305687</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.693117836001484</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 14min 23s, sys: 1min 49s, total: 16min 13s
Wall time: 3min 32s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/329c4852751fb585f1d7a17c54cdb24d97fec63b9601ab91dbeaf82b446598ab.png" src="../../_images/329c4852751fb585f1d7a17c54cdb24d97fec63b9601ab91dbeaf82b446598ab.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.03425217597673</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.01657247197635</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.9008986826959</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.7708330453482</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59.62959241727932</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52.699833089280276</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.37176100889194</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 15min 4s, sys: 2min, total: 17min 4s
Wall time: 3min 50s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/18a2cbb0814180c20e4ccc82055754d67aab60a1be23f7d2d3ba32201b9183e9.png" src="../../_images/18a2cbb0814180c20e4ccc82055754d67aab60a1be23f7d2d3ba32201b9183e9.png" />
</div>
</div>
</section>
</section>
</section>
<section id="another-neuron-clu267">
<h2>Another neuron: <code class="docutils literal notranslate"><span class="pre">clu267</span></code><a class="headerlink" href="#another-neuron-clu267" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConfigVAE</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">h_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">expt</span> <span class="o">=</span> <span class="s1">&#39;clu267&#39;</span>
<span class="n">grp</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">expt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scale</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">hf_kws</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s1">&#39;sres&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">hf</span> <span class="o">=</span> <span class="n">HyperFlow</span><span class="p">(</span>
    <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="mi">2</span><span class="p">:],</span>
    <span class="n">center</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="o">**</span><span class="n">hf_kws</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">stim</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">compute_hyperflow</span><span class="p">()</span>
<span class="n">spks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;spks&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">good</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;badspks&#39;</span><span class="p">])</span>
<span class="n">good</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">good</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># src, tgt = setup_supervised_data(lags, good, stim, spks)</span>
<span class="n">stim_r</span><span class="p">,</span> <span class="n">spks_r</span><span class="p">,</span> <span class="n">intvl</span> <span class="o">=</span> <span class="n">setup_repeat_data</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_kws</span><span class="o">=</span><span class="n">hf_kws</span><span class="p">)</span>

<span class="n">stim_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
<span class="n">stim</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>
<span class="k">if</span> <span class="n">stim_r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">stim_r</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>

<span class="n">stim</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">stim_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((43200, 19, 19, 2), (12040, 19, 19, 2))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">useful</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">useful_cells</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">expt</span><span class="p">,</span> <span class="p">{})</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">useful</span><span class="p">:</span>
    <span class="n">useful</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">spks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">useful</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>Reservoir<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">ConfigVAE</span><span class="p">(</span>
    <span class="n">n_kers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">n_latent_scales</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_groups_per_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_latent_per_group</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">scale_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">residual_kl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ada_groups</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">TrainerVAE</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">ConfigTrainVAE</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">total_latents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>210
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
<span class="n">vae</span><span class="o">.</span><span class="n">scales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+--------------+------------+
| Module Name  | Num Params |
+--------------+------------+
|     VAE      |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.0</span> Mil  |
|     ---      |    ---     |
|     stem     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1</span> K    |
| pre_process  |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96.0</span> K   |
|  enc_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.4</span> Mil   |
|     enc0     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.6</span> K   |
| enc_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
| dec_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
|    expand    |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.0</span> K   |
|  dec_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> Mil   |
| post_process |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.0</span> K   |
|     out      |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">578</span>     |
+--------------+------------+ 


</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, 4]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>Reservoir<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">ConfigVAE</span><span class="p">(</span>
    <span class="n">n_kers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">n_latent_scales</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_groups_per_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_latent_per_group</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">scale_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">residual_kl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ada_groups</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">TrainerVAE</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">ConfigTrainVAE</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">total_latents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>210
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
<span class="n">vae</span><span class="o">.</span><span class="n">scales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+--------------+------------+
| Module Name  | Num Params |
+--------------+------------+
|     VAE      |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.0</span> Mil  |
|     ---      |    ---     |
|     stem     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1</span> K    |
| pre_process  |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96.0</span> K   |
|  enc_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.4</span> Mil   |
|     enc0     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.6</span> K   |
| enc_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
| dec_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
|    expand    |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.0</span> K   |
|  dec_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> Mil   |
| post_process |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.0</span> K   |
|     out      |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">578</span>     |
+--------------+------------+ 


</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, 4]
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h3>Extract features<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stim</span>
<span class="n">enc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">)</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)))):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">stim</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">e4</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">e8</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
        <span class="nb">input</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">enc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4</span><span class="p">,</span> <span class="n">e8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>

<span class="c1"># Stim Repeat</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">stim_r</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">e4_r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">e8_r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
    <span class="nb">input</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">enc_r</span> <span class="o">=</span> <span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4_r</span><span class="p">,</span> <span class="n">e8_r</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">enc</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">enc_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████| 87/87 [00:20&lt;00:00,  4.22it/s]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((43200, 5248, 4, 4), (1000, 5248, 4, 4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc_r</span><span class="p">))</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((43200, 500), (1000, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="k">for</span> <span class="n">neuron_i</span> <span class="ow">in</span> <span class="n">useful</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

        <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
            <span class="n">x_tst</span><span class="o">=</span><span class="n">x_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
            <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Neuron # </span><span class="si">{</span><span class="n">neuron_i</span><span class="si">}</span><span class="s2">. lag = </span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s2">, r2:</span><span class="se">\n</span><span class="si">{</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;~&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.40657192024695</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.074905984385076</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-19.047669449121642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.347453507168716</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.278817971923772</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/cc8db27b34788b388121997490631a649e404f64d3aa9a9214f6d3d0633a43da.png" src="../../_images/cc8db27b34788b388121997490631a649e404f64d3aa9a9214f6d3d0633a43da.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-38.377894725809945</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-9.498493832994036</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.227497292720063</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.21216817148688</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.26437348682762</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/0d5c90770a0d754d4f8c5bb4ba35928af620ea7d1c969bc9842521f4a8e64a54.png" src="../../_images/0d5c90770a0d754d4f8c5bb4ba35928af620ea7d1c969bc9842521f4a8e64a54.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.530597877612255</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.2123446424512405</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.40601789300351</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.082031409291417</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.25053633283949</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/5034f24283b0de3ef2a02e468ad081cb9a703b8dacbffd6be030f3a5b1e4d42c.png" src="../../_images/5034f24283b0de3ef2a02e468ad081cb9a703b8dacbffd6be030f3a5b1e4d42c.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.080213733641912</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.586293743601578</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.737947933324815</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.97338314024249</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.238949308230563</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/83a48b0e7fb653cb1018ba902bfaf6b756abe0c18b4abb38c5a07b8243166102.png" src="../../_images/83a48b0e7fb653cb1018ba902bfaf6b756abe0c18b4abb38c5a07b8243166102.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-33.89465571528913</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.01026669533291</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.279436716233175</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.89096135453419</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.23006489630997</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/94bef764d4c0db66d9d3850b04747c127dc63d6e6de40a1015fe064aecf44e38.png" src="../../_images/94bef764d4c0db66d9d3850b04747c127dc63d6e6de40a1015fe064aecf44e38.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.56249797497559</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.606555107675736</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.964535720573348</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.832169195284347</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.22369853702906</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8fdb64aec2e63a029ed7207865b9b9c93a08bdce36ffb7ac617e9bc2ea5a439a.png" src="../../_images/8fdb64aec2e63a029ed7207865b9b9c93a08bdce36ffb7ac617e9bc2ea5a439a.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.801972803467393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.7596594081491297</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.729358533630533</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.790558296601418</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.21920974676113</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/71103b0ed4fce84ed12f9784d3a4f5bfb19d02f82db79c9206f3538dd0e6e868.png" src="../../_images/71103b0ed4fce84ed12f9784d3a4f5bfb19d02f82db79c9206f3538dd0e6e868.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.556587042436067</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.075090731438835</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.759252040812587</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.783936293494467</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.218351474521295</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/30c6c116def43527c504973a2616a1af7af29b784285e8009be1b66915a61db9.png" src="../../_images/30c6c116def43527c504973a2616a1af7af29b784285e8009be1b66915a61db9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.254592967542226</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.575749377342753</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.961952776770172</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.806034897799023</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.220570892261218</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/525d022bddf4faf9fc9a21fd6b6e5f5fa6d27f74bb81fa8815f1ed3e049b23c5.png" src="../../_images/525d022bddf4faf9fc9a21fd6b6e5f5fa6d27f74bb81fa8815f1ed3e049b23c5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.059109530051707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.41599025572479</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.351305459082543</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.857259622818596</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.22588818527025</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8cc449cde2b1ff05e78215efef3037e35849a65c5413bb521440f50486013573.png" src="../../_images/8cc449cde2b1ff05e78215efef3037e35849a65c5413bb521440f50486013573.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.864163492497084</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.89284727008228</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8050167642223327</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6685234834044707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7064479123444656</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/36c22a748ead81a5981ed3e29ab1ea1688d5dfd1085525bb1d7c72089656e740.png" src="../../_images/36c22a748ead81a5981ed3e29ab1ea1688d5dfd1085525bb1d7c72089656e740.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.833496189447253</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.259771969674466</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8338817030248746</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6687964219010079</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7064302597850292</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/88688087d80fb4ed18784586ab7f4b9bb9db817a15add60093a045e8f193cbe1.png" src="../../_images/88688087d80fb4ed18784586ab7f4b9bb9db817a15add60093a045e8f193cbe1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.87059635552801</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.462538493059133</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8626788061685708</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6707032640924204</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7066037743304276</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/879a93e03ada2a92a026965847e308cdd0938dafb27fea056818c5c15969a091.png" src="../../_images/879a93e03ada2a92a026965847e308cdd0938dafb27fea056818c5c15969a091.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.07011774848366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.568631662379887</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8892588629016984</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6733816210763743</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7068738837006983</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/db33ca146aa0639db54078eff510b7608c95ae022a3eee3541a2bbf50f51539f.png" src="../../_images/db33ca146aa0639db54078eff510b7608c95ae022a3eee3541a2bbf50f51539f.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.661215740411176</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.886474807040033</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.9576991234682586</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.681865117724878</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7077501231242733</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8c2f4526b77306e6fe1cfe3dec2aaeb8a60b3ca37731d34df8ab87f82febc077.png" src="../../_images/8c2f4526b77306e6fe1cfe3dec2aaeb8a60b3ca37731d34df8ab87f82febc077.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.638154654339957</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.083267103497892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.022472366581506</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6924794231103926</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7088669390266311</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/6323ef0e1c884a9eed8249f33a8d5fac4bbba650d7cf4a4133635c86be0cdaad.png" src="../../_images/6323ef0e1c884a9eed8249f33a8d5fac4bbba650d7cf4a4133635c86be0cdaad.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-22.312905983290833</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.33840468218987</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.1270069055081544</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.707683979366025</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.710469381104617</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/b61e29a9c4878e21483b50d57e4c782a73e4060c494c52e49441452e2322c3a6.png" src="../../_images/b61e29a9c4878e21483b50d57e4c782a73e4060c494c52e49441452e2322c3a6.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.990842881881047</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.606327824262671</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.2447547508310342</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7251761257861977</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7123159032758952</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/6ff5c7902d7c37dce3725f7cde5335b32608f11b327f027b953d98cb9837f699.png" src="../../_images/6ff5c7902d7c37dce3725f7cde5335b32608f11b327f027b953d98cb9837f699.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.89922367341302</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.950919531142642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.3900856736755118</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7467314310581008</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7145918376338711</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/c1098ab94bd7b03b830835cb9c8dd8fa247e4b95772f661ce751f28b7a0d41a8.png" src="../../_images/c1098ab94bd7b03b830835cb9c8dd8fa247e4b95772f661ce751f28b7a0d41a8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.987526628323554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.241581859903002</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5310801405512109</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7675087284809035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.716781962613533</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/57ebf9630530c11c664aa47b96529e894882146e1b456e0c30668ea99ff0b5c8.png" src="../../_images/57ebf9630530c11c664aa47b96529e894882146e1b456e0c30668ea99ff0b5c8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.476487994800804</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.494594935967083</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.506290705438786</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.640141224570005</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.345588721556076</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/71469f27294a75f38ad898701b5de89531953e5467018cff9bc0fa80ee27301b.png" src="../../_images/71469f27294a75f38ad898701b5de89531953e5467018cff9bc0fa80ee27301b.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.3281394388409362</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.147157973320304</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.095702532902685</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.075865296381366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.28394543241481</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/cb2e9da044ee0604fefde492ec5a4ad783bb8c5ae2c66b723b331f615fcd9cf0.png" src="../../_images/cb2e9da044ee0604fefde492ec5a4ad783bb8c5ae2c66b723b331f615fcd9cf0.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.613433561658023</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.826251452728698</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.936208945582795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.662175193289606</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.239045111609727</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/512d60b10c3828650a8ff7a47b465ce2def5d0cff04bbb3229900ee4085f3798.png" src="../../_images/512d60b10c3828650a8ff7a47b465ce2def5d0cff04bbb3229900ee4085f3798.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.00022839987753</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.8271455720366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.75772829237353</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.435996455171974</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.21493979597269</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/c8f160e98e80b335fcf60fa27782e4835a0fa4bbb32bf9d7a6ba1921ea076124.png" src="../../_images/c8f160e98e80b335fcf60fa27782e4835a0fa4bbb32bf9d7a6ba1921ea076124.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.243779433845484</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.207414698976194</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.43437438204689</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.406386027018272</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.212467416581298</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/2a0f53d0cb4c24a30a09cebf60bc8e5fd049c7da839cfd2ed3fb8253ee3ee164.png" src="../../_images/2a0f53d0cb4c24a30a09cebf60bc8e5fd049c7da839cfd2ed3fb8253ee3ee164.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.43359895539705</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.70367338756394</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.929191320021527</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.56428529201892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.230451666569785</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/7f692804ea8a00e37694be9438a26e4d02c19ddea8ef76a79da9fadea53c21b0.png" src="../../_images/7f692804ea8a00e37694be9438a26e4d02c19ddea8ef76a79da9fadea53c21b0.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.55102272869564</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.279623774715084</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.20768906688223</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.912299046477463</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.269179442278865</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/49d6f13a7558908610d27ddbfaea11e24b8ef8d49fd5fbdf551659768792bb70.png" src="../../_images/49d6f13a7558908610d27ddbfaea11e24b8ef8d49fd5fbdf551659768792bb70.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.573794965625071</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.131197464454225</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.426572707474346</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.424609187408823</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.325890231834357</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/28cebc3094bc917e4a0c59bde4facf0fb8932b530ea45494db30d77cf1b80ec8.png" src="../../_images/28cebc3094bc917e4a0c59bde4facf0fb8932b530ea45494db30d77cf1b80ec8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.836804672377514</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.04826031105208</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.683450259532087</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.074633115771086</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.397413792804734</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/5b105397602f4ef63482f4b1d3dfab355dca65dbe7f19e19b864171aa731a39c.png" src="../../_images/5b105397602f4ef63482f4b1d3dfab355dca65dbe7f19e19b864171aa731a39c.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.639209847656172</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.48372571298828</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.23186681754519</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.834563616645372</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.48092131636914</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8919ad8623192a51fd5c2f9279c72bfdacc6ccd60522803e05b415664e0913d4.png" src="../../_images/8919ad8623192a51fd5c2f9279c72bfdacc6ccd60522803e05b415664e0913d4.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-92.3050990077092</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.85879497482124</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.599928854392564</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.761351775105869</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.9632458135947939</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/c3e001d042edd8a9a5e1d75c311ecd7641b876d7ccdbd02e44f93704ee41a432.png" src="../../_images/c3e001d042edd8a9a5e1d75c311ecd7641b876d7ccdbd02e44f93704ee41a432.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-92.23084473706098</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.9970220314146</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.774523786249986</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.634135217798762</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.8677783358620248</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/cfc03585b8c3bbd4ffc4ada1e0d4fead7650f8bff2488e5b06feaabf8f4aeba1.png" src="../../_images/cfc03585b8c3bbd4ffc4ada1e0d4fead7650f8bff2488e5b06feaabf8f4aeba1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-67.92579631559555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.48645149419082</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.62679945119428</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.38704094505219</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7861425405743425</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/65f1f22446b916bc712c5f7b719478b25cb0cf88c26b0f881af3c708a154a9c3.png" src="../../_images/65f1f22446b916bc712c5f7b719478b25cb0cf88c26b0f881af3c708a154a9c3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-53.24393918526309</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.7890985896898</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.696487101891975</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.965707788479035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7236974047363463</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/a0f14d759545aa8c4fcb54bb2933d969c7bb5385c79a1dc213e2e61d3ae70be7.png" src="../../_images/a0f14d759545aa8c4fcb54bb2933d969c7bb5385c79a1dc213e2e61d3ae70be7.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-64.81641009645622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.613897481276425</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.891564070694663</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.352863513815043</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.6821918815151937</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/4fce45069ac4ca0625774f78ed116d50dc94f8488ce2e8c720cf81182b3ed3f9.png" src="../../_images/4fce45069ac4ca0625774f78ed116d50dc94f8488ce2e8c720cf81182b3ed3f9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-79.58630219425812</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.70972693425713</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.034181340415202</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.524331800438476</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.664034609090348</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/6aab86af5833c23f7824562eb74fb2fde182aa27d2837e7705b20ffac6871bbd.png" src="../../_images/6aab86af5833c23f7824562eb74fb2fde182aa27d2837e7705b20ffac6871bbd.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-74.96385899403522</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.443924240525796</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.153377314877762</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.480779753743425</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.669143516467031</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/dd7610ba04041359f2cfa65caf64fe5ae1d1b5e4e927bcbcab85175aed218ab3.png" src="../../_images/dd7610ba04041359f2cfa65caf64fe5ae1d1b5e4e927bcbcab85175aed218ab3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.316446998879165</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.1001603900513</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.094119500632885</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.2148947744853125</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.6980674114435823</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/26421ea4889399b22ba04df2f56389f850723b09cc33bbaec5c7125a050e50da.png" src="../../_images/26421ea4889399b22ba04df2f56389f850723b09cc33bbaec5c7125a050e50da.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.289150225599638</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.589240712403935</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.07141909460631</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.756622052203607</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7479036443673213</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/ce630a8fd5cd85f0c1bbc2818040cb34c8a3d06d87f1053f348dd6232ba57c2d.png" src="../../_images/ce630a8fd5cd85f0c1bbc2818040cb34c8a3d06d87f1053f348dd6232ba57c2d.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.33569152849148</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.568196045159446</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.086145382218294</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.126974588140763</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.8163302310897134</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/359e7b3e8f41c6f7ec9163192b129930bfd55eb190def45e7f2670e3e3e82064.png" src="../../_images/359e7b3e8f41c6f7ec9163192b129930bfd55eb190def45e7f2670e3e3e82064.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-58.61548728986716</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-46.49959789769393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-34.64402580469654</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.236498156153257</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.658086180873976</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/f764ef2e720713345aa5a64169fa1e89a68d970eebe346feed7db63ffc9c179c.png" src="../../_images/f764ef2e720713345aa5a64169fa1e89a68d970eebe346feed7db63ffc9c179c.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-61.79223991819662</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-48.35917388558224</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.1971948359036</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.309694329273242</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.66566694166346</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/4e52305bb12f50c1f5e536645f2214d217b111307f025cedfafdf467d0b2bb39.png" src="../../_images/4e52305bb12f50c1f5e536645f2214d217b111307f025cedfafdf467d0b2bb39.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-61.56683024227607</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-49.820584096004936</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.717905803529845</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.380728937725475</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.673051895393666</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/fdfac8faccee37f2e643977a773265e53c2e55641cf5d23f06294c129a6203c1.png" src="../../_images/fdfac8faccee37f2e643977a773265e53c2e55641cf5d23f06294c129a6203c1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-58.99998849816295</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-51.02354026616523</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.244126311701464</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.45508499878684</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.680813674885886</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/f39879ab835def34c756839280a957ff1fcbb151fb69de48afdf3742460277b6.png" src="../../_images/f39879ab835def34c756839280a957ff1fcbb151fb69de48afdf3742460277b6.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-51.521822490020575</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-51.78721189624022</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.758114183105306</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.530880343058197</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.688768133975362</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/3983cd5031e5f5ddce2a68db4cc822a739f5d9ee77f83158e56ccbdaeec313a9.png" src="../../_images/3983cd5031e5f5ddce2a68db4cc822a739f5d9ee77f83158e56ccbdaeec313a9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-54.185234099892355</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-53.656589531993085</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.40290217013891</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.621658098866035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.698243321041673</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/fb254a12b4f482195d6acd0d0c6ca7cb50de910363a6aea925d92f4f705d28ca.png" src="../../_images/fb254a12b4f482195d6acd0d0c6ca7cb50de910363a6aea925d92f4f705d28ca.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-52.97402260787629</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-54.895870615367116</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.99283528222295</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.708207545090758</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.707323571350443</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/21bc99713d9d0a3b6c046b0d4ee3aa860e335fcafea381e60bba3b69bff234cb.png" src="../../_images/21bc99713d9d0a3b6c046b0d4ee3aa860e335fcafea381e60bba3b69bff234cb.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-38.30020283441302</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-54.83607368615677</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-38.50704594688597</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.790281397847473</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.71601424696322</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/bf316b42210eb6f266488f68d3fef1a90c942904528a7eb48170f29b1f134245.png" src="../../_images/bf316b42210eb6f266488f68d3fef1a90c942904528a7eb48170f29b1f134245.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.116597413455516</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-55.48218053090039</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-39.07006956071915</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.877879351389794</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.72526640971185</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/48275d1f2d648ff6b704ebdd22c8b78df027b0ed490efbc70c87f78a5f0d4f57.png" src="../../_images/48275d1f2d648ff6b704ebdd22c8b78df027b0ed490efbc70c87f78a5f0d4f57.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-34.06510270115803</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-57.291606956577844</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-39.72746744369153</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.974032279675413</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.7353558625177</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/bd6e3635edbff99bd238749261c0292df7f273ad275fd88d8d74344dd283549c.png" src="../../_images/bd6e3635edbff99bd238749261c0292df7f273ad275fd88d8d74344dd283549c.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.89520991684442</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.8534591907535</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.488614267666629</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.342280586211534</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.801028838644086</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/14829feec78ac39b40c8c76ba81ebf72e2e87da08cc2ce78a9e4150d154840fa.png" src="../../_images/14829feec78ac39b40c8c76ba81ebf72e2e87da08cc2ce78a9e4150d154840fa.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.444558880938246</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.57117695395853</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.668269597519298</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.164956091167205</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.7824144640270765</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/cd7cc9ff5a483a8a6b7bb5a90098d9bd12b59ac22f1ee1214c8a4400d0b10557.png" src="../../_images/cd7cc9ff5a483a8a6b7bb5a90098d9bd12b59ac22f1ee1214c8a4400d0b10557.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.26852343997473</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.3890718048393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.589454544195565</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.024494056051432</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.767660078738059</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/d753fab7a000f192966c1ceeefc16e16e90a5cce5838e6a580ae37c25c13b1f4.png" src="../../_images/d753fab7a000f192966c1ceeefc16e16e90a5cce5838e6a580ae37c25c13b1f4.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.83518300246094</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.52238524725867</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.268961332051642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.918716596925421</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.75646745970342</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/204a0d368574740015ff69f53d222f9f24cc52f47e5b1392ba930bb214b58029.png" src="../../_images/204a0d368574740015ff69f53d222f9f24cc52f47e5b1392ba930bb214b58029.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65.54693298587672</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.678621590654465</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.633623052120669</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.857845340294942</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.750045752385848</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/81d51630b999c49d662574dd71f2b206637a8609345d67a77af2e5784c269c04.png" src="../../_images/81d51630b999c49d662574dd71f2b206637a8609345d67a77af2e5784c269c04.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63.56917788142946</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.88623868074705</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.652526637712125</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.8461785127496215</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.748747035071224</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/2850119529d44faeadd0a11dcfcac4c5d89ad0da8c69af2f12df316fc7255fc2.png" src="../../_images/2850119529d44faeadd0a11dcfcac4c5d89ad0da8c69af2f12df316fc7255fc2.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.64551414133159</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.91954176125073</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.267787160851096</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.891532689108802</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.753389743102712</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/a6978ac750e46685341c594b35bf21d41385bd59cdfff2a2374b095a04faf737.png" src="../../_images/a6978ac750e46685341c594b35bf21d41385bd59cdfff2a2374b095a04faf737.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.52040582712106</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.879923208721124</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.528723223323933</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.987617221446317</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.76333722471807</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/7f3e260f3c2708321696ad28bd4ff7d866b88ecbfbeadf21354ef8480a911303.png" src="../../_images/7f3e260f3c2708321696ad28bd4ff7d866b88ecbfbeadf21354ef8480a911303.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.39516065685799</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.42926427864738</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.51309859257078</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.12935414750888</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.778136476023612</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/083bcd36984228565e57e3c7394685dca7519f6e2da39519fdafd9a4b7f979ab.png" src="../../_images/083bcd36984228565e57e3c7394685dca7519f6e2da39519fdafd9a4b7f979ab.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.896684097085526</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.172126876416385</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.202641428127055</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.316659551213432</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.797764457091683</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8d88a9c07e8b17c9d341c198aae97338eb369f34dd565b4273e1373f9c49e569.png" src="../../_images/8d88a9c07e8b17c9d341c198aae97338eb369f34dd565b4273e1373f9c49e569.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-414.33618220140795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.71612939758431</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.841978508406275</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.568762086923206</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.3353858603839299</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/df0a5f020828eb9be0db779669f69701fdaaa2cab9f4bb815e68c3312a5a8328.png" src="../../_images/df0a5f020828eb9be0db779669f69701fdaaa2cab9f4bb815e68c3312a5a8328.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-548.3533087548572</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.59356900800207</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.45812339454801</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.017045082810312</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.2880892763289955</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/bb588840f719c64567571d411d6b25c01fc5845f653386ab3673c3993b8da8f4.png" src="../../_images/bb588840f719c64567571d411d6b25c01fc5845f653386ab3673c3993b8da8f4.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-444.103465168979</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.90392689029555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.526688825843564</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.376800213580902</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.25009738508734447</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/d2d132b71572d1e6a0a3383e0c6d9db2d6d07b5c63bf8ebeb15619363f84e37d.png" src="../../_images/d2d132b71572d1e6a0a3383e0c6d9db2d6d07b5c63bf8ebeb15619363f84e37d.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-357.8126360613227</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.605604061669478</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.07280081174261</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.65611012657341</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.22051762413373144</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/ee54dfbffdf4dcceb80482deedbf1e6d37990df1d15337507d479f8c4bba7b2e.png" src="../../_images/ee54dfbffdf4dcceb80482deedbf1e6d37990df1d15337507d479f8c4bba7b2e.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-288.8587479183993</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.18140825246687</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.047487427779544</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.837794754728531</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.20122720127413452</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/2b11d6443b258331164cb7c0dd32b00a61ce5adcbd97b91b2c8aef93a132088a.png" src="../../_images/2b11d6443b258331164cb7c0dd32b00a61ce5adcbd97b91b2c8aef93a132088a.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-220.18967529034717</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.522909908772622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.44357433972523</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.916675102146396</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.19275916154637418</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/fd93a9ffe1d5e33d05a057a67e089ab64ef6ea9f0620b2f82228d704229bb8bd.png" src="../../_images/fd93a9ffe1d5e33d05a057a67e089ab64ef6ea9f0620b2f82228d704229bb8bd.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-167.65700679493852</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.218572943773342</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.22919692256519</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.880724539677473</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.19654638700108418</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/a31720ba2f285ebb21ac769e0eba3d3ab12ff6b9e5ce2d3e6338c43ee85c9a06.png" src="../../_images/a31720ba2f285ebb21ac769e0eba3d3ab12ff6b9e5ce2d3e6338c43ee85c9a06.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-134.47598936733849</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.025662382129127</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.52191131920344</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.7461460870463</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.2108906298923685</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/30c6b2c7900e42d917b9e89a15baaa734779ed56a98075013c1d9d9624ff15d9.png" src="../../_images/30c6b2c7900e42d917b9e89a15baaa734779ed56a98075013c1d9d9624ff15d9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-126.8085743711199</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.072828260287748</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.30072925416394</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.508514414408561</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.23630799468725705</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/5aa2655221b76ad25bd7f60754ab2d7c92c74bc99c81df1a12cc632a758fd0ee.png" src="../../_images/5aa2655221b76ad25bd7f60754ab2d7c92c74bc99c81df1a12cc632a758fd0ee.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-59.6255585767427</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6253955471475781</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.559926194420555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.178326454049209</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.2715413454200677</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/7180fa0989f0c4c10040b98ae6e45bf3e88d290042957e6f9966952863782bdb.png" src="../../_images/7180fa0989f0c4c10040b98ae6e45bf3e88d290042957e6f9966952863782bdb.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.850278156107514</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.022785675024208</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5823123434313802</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.510582904410774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6402286187694024</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/522ecfb41df3dbe21300deb1e990415a7b9d5bf432ad7748ca0589b0317349b2.png" src="../../_images/522ecfb41df3dbe21300deb1e990415a7b9d5bf432ad7748ca0589b0317349b2.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.696297861419809</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.221834718042892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5196549520917868</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.502128978375695</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.639344957032841</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/0815ac492b3c745aabeb169265edcf31a38322d7983eccf6dd518a423e7dc8b5.png" src="../../_images/0815ac492b3c745aabeb169265edcf31a38322d7983eccf6dd518a423e7dc8b5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.7649357205786576</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.353081255455891</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.458630449341336</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4935395054369147</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6384470728882725</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/ee088ca180692d23c9beabc80cc2f27199cc36eab29cebf4e16e2693738ad5d3.png" src="../../_images/ee088ca180692d23c9beabc80cc2f27199cc36eab29cebf4e16e2693738ad5d3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.018607404903876</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.520006475671843</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.3827346962928644</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4833825941475096</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6373916137448994</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/f971dbc648b47794f20adf114beda62877f708fc6b80f1020b6ecaa93ab727e1.png" src="../../_images/f971dbc648b47794f20adf114beda62877f708fc6b80f1020b6ecaa93ab727e1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.639740265955785</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.75502579523621</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.2985130143235546</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4725210172964918</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.636267314424523</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8328bda66561d8aad1b3f17e877de0c27083fa34ee891b84061415ca9d577b78.png" src="../../_images/8328bda66561d8aad1b3f17e877de0c27083fa34ee891b84061415ca9d577b78.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.360858753094968</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.969075940074617</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.2137591930073688</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4618761088142094</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6351660538561195</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/af69eff8f9047781081566c9bbad2f096d9962e4736f58c606c4b888069b987d.png" src="../../_images/af69eff8f9047781081566c9bbad2f096d9962e4736f58c606c4b888069b987d.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.432352180694192</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.1266596871817876</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.1365627993066063</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4511398496272596</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.634052082369709</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/aa980b646cb1ea36287e4625ab57dcf894fd2ee2e68b84bb37f20e890a92fee8.png" src="../../_images/aa980b646cb1ea36287e4625ab57dcf894fd2ee2e68b84bb37f20e890a92fee8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.609440065950668</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.1733330331012666</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.0533318867347319</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4403089862478744</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6329211194348723</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/56c8f0a6f374cd66d7883122a962e07ac3b6e972da85eb6be017caebd74a35dd.png" src="../../_images/56c8f0a6f374cd66d7883122a962e07ac3b6e972da85eb6be017caebd74a35dd.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.713602846080992</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.3054539221165857</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.9707595201511765</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.42935662533057</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.631780638927772</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/359c99bd71c11a40591727ab7457b2a9bb83dc3294be96c697e17628afad3634.png" src="../../_images/359c99bd71c11a40591727ab7457b2a9bb83dc3294be96c697e17628afad3634.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.64863009945106</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.3816331117908605</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8938041903032046</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4200232265341626</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6308092864962163</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/d0dd619cf564f50c08aba155a8d80f42c24a05a1f843c9924c07259909a951b5.png" src="../../_images/d0dd619cf564f50c08aba155a8d80f42c24a05a1f843c9924c07259909a951b5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-56.071656962323836</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.567292584175117</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.443291844060774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8053818029133519</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.023624066114280584</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/ac51620550c011be166e999226b39443d06f33adb289784042462c027da6a3b0.png" src="../../_images/ac51620550c011be166e999226b39443d06f33adb289784042462c027da6a3b0.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-65.86174969859482</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.86706753694821</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.6706237796388965</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8343977330715013</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.026596945129686578</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/fccb6a472eea15e192ad195c453e07ed9574776754eacc8fcfe16008feecb7bb.png" src="../../_images/fccb6a472eea15e192ad195c453e07ed9574776754eacc8fcfe16008feecb7bb.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-77.46316401157985</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.862325189177973</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.835015259071509</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8564589470477224</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.028869489848903918</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/3852b080aac78367c107882e6d283cea142fbd8b66a53780a7e89eea85669238.png" src="../../_images/3852b080aac78367c107882e6d283cea142fbd8b66a53780a7e89eea85669238.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-82.22188802178074</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.61561512920875</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.890305119541285</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8655805238064085</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.029827541105387212</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/2016ef9a4f86dc70d6df27c617745de613c5de17860e2626ed932eb1af2934f8.png" src="../../_images/2016ef9a4f86dc70d6df27c617745de613c5de17860e2626ed932eb1af2934f8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.3000599543671</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.967230178498856</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.783652482945136</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8558155364673081</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.028870812229742082</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/12b0871c9c7b7996de9565fa5db414218f445d06ed3bc33dd366912ae478dd86.png" src="../../_images/12b0871c9c7b7996de9565fa5db414218f445d06ed3bc33dd366912ae478dd86.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-79.22195987460555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.09435772197707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.638761399651162</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8418871202326539</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02749597661333425</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/a2b8470da029a51131f8e0e6b29ac1d29856ae3139cdf200f23320aef84b0ac9.png" src="../../_images/a2b8470da029a51131f8e0e6b29ac1d29856ae3139cdf200f23320aef84b0ac9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.75437596039716</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.74298508592757</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.342393606595854</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8105502108044282</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.024359799308670826</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/43f01f70f078b4974be6e7c73f07291241bde8dc42fc394c00419652d475b51b.png" src="../../_images/43f01f70f078b4974be6e7c73f07291241bde8dc42fc394c00419652d475b51b.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-69.69670760857909</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.25022538314554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.963451054780833</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.768963678496104</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.020176778548119945</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/bb9b7371de4f5a6c221f86f865cddd06e2013b812cc28214c13f9be5a967a948.png" src="../../_images/bb9b7371de4f5a6c221f86f865cddd06e2013b812cc28214c13f9be5a967a948.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-69.20205106195007</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.663336510596274</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.539881391746361</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7217881340452648</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.015423097281153098</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/c8201a59f81d3473af12c5a9aa4aadcc1b52adf6f854a7f04bc6e80e92e59f9f.png" src="../../_images/c8201a59f81d3473af12c5a9aa4aadcc1b52adf6f854a7f04bc6e80e92e59f9f.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.37449006350143</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.69548542661982</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.029777506985024</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6646459263461413</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.009659749961921094</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/fc229b40fd203c2ea984f9581eca37edb0d72d541216d53f913da5ef67eb3dc3.png" src="../../_images/fc229b40fd203c2ea984f9581eca37edb0d72d541216d53f913da5ef67eb3dc3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-100.51573859046954</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.835432130350554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.289509283013697</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.097741607417795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.22168721654363</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/31da88ff8b8dca2ab3f08f221cca99d6f4bb09a2e82fdd40ed036acb4b3111d7.png" src="../../_images/31da88ff8b8dca2ab3f08f221cca99d6f4bb09a2e82fdd40ed036acb4b3111d7.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-96.26343492193475</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.795002943419984</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.2794839391359</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.08802552321034</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.220501518878578</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/be877b18a50e303170f1c1851937fd9009b3a01b630d1e0072a120b4a5d2af49.png" src="../../_images/be877b18a50e303170f1c1851937fd9009b3a01b630d1e0072a120b4a5d2af49.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-93.04949844280081</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.042097108262617</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.334416709386115</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.087847343109644</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.220332625451732</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/d8c12c4562e2db2819739ab79adca7f9571addc8691088fd5b89d2db6ac77442.png" src="../../_images/d8c12c4562e2db2819739ab79adca7f9571addc8691088fd5b89d2db6ac77442.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-97.30552958514838</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.076561123889075</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.495094502670153</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.101675624946694</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.221637765565514</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/1071c263a557e9223147ded5e24d04e03a2f350a8e56ad61f0fe59639f571703.png" src="../../_images/1071c263a557e9223147ded5e24d04e03a2f350a8e56ad61f0fe59639f571703.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-99.58529042703417</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.915189531523808</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.671658573003548</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.121800277947344</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.22367214276948</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/67d2a2f140d4bcd41697f28fae73dc55aa3b30ab62864473a89e741b2c23f311.png" src="../../_images/67d2a2f140d4bcd41697f28fae73dc55aa3b30ab62864473a89e741b2c23f311.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-98.83513969873971</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.469758443129376</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.87152950174529</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.14903947553868</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.22651355368297</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/91bb7e4cf507e0b13df460dba01fc5a22d6b3a470ad4a10f1723ffbbc1a55a9b.png" src="../../_images/91bb7e4cf507e0b13df460dba01fc5a22d6b3a470ad4a10f1723ffbbc1a55a9b.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-98.13079961150406</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.998695117202697</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.094469146683913</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.182749130436584</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.230086339157662</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/ba8a206287e2fdda7cfac6c34e02ecbacf92d1bd4e97495a5b56eabdb9e0caf8.png" src="../../_images/ba8a206287e2fdda7cfac6c34e02ecbacf92d1bd4e97495a5b56eabdb9e0caf8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-93.90516813204779</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.155638833769146</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.316339932390882</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.220173045530323</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.23410748366674</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/5f693a76049061a0faa002345a26c5edf4f7ba9a0a48c99087f10196421a8671.png" src="../../_images/5f693a76049061a0faa002345a26c5edf4f7ba9a0a48c99087f10196421a8671.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-88.840259025712</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.16067317067692</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.5570274727898</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.262900416690766</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.23872915506484</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8f22e8aa28b27ba1ef200a12ec9b4e930606edfd2edf2a6248244afec0a386a1.png" src="../../_images/8f22e8aa28b27ba1ef200a12ec9b4e930606edfd2edf2a6248244afec0a386a1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-88.3238490336635</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.7088288171607</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.862161558488346</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.313708019730583</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.244195566914104</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/0aa576f2e827464c7e7082a3c04a5d3ce3a2145d5bde458a772404217f3cc661.png" src="../../_images/0aa576f2e827464c7e7082a3c04a5d3ce3a2145d5bde458a772404217f3cc661.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.674573291713589</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.17866501478794</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.924686848062642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.822162775279427</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.7618796592849</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/8bc81b255fa515277574bfe3bddc511d60f54608f8de0e77a49a913ded330ca8.png" src="../../_images/8bc81b255fa515277574bfe3bddc511d60f54608f8de0e77a49a913ded330ca8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.861797743762615</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-22.46832588025147</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.25822212914011</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.552891455808396</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.725855129125094</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/390cecabc475abd61d7417a04e5939671adba751b9958d3df62c940d82c61c11.png" src="../../_images/390cecabc475abd61d7417a04e5939671adba751b9958d3df62c940d82c61c11.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.372911448230585</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.60314510176622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.02426326053238</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.37457252534532</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.700679654533445</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/7d67c31301fab23124aacf7c53a9ae9c00dee502d71eacf0c344ced5ad492cd7.png" src="../../_images/7d67c31301fab23124aacf7c53a9ae9c00dee502d71eacf0c344ced5ad492cd7.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.51464916498297</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.417314655781226</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.21039052828076</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.30274151592993</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.68850892241812</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/fb908ac6bc5df654e4939a88c522ebb7a44d433d3ceb115168a264187f3654d8.png" src="../../_images/fb908ac6bc5df654e4939a88c522ebb7a44d433d3ceb115168a264187f3654d8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.4516700876109</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.331921720295163</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.568781330161876</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.31539722304644</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.687444129295095</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/1940f5d8df3600f7c2edb9e9b1d3966b4633bad8115bdd793d5506164c578851.png" src="../../_images/1940f5d8df3600f7c2edb9e9b1d3966b4633bad8115bdd793d5506164c578851.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.141616107985373</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.337689458536758</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.36429987912803</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.438467268681713</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.69989426556834</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/5dcb0d07f08d8d1e41d95cb4599e37c848edaa6c924c0b18f388233120ca48bd.png" src="../../_images/5dcb0d07f08d8d1e41d95cb4599e37c848edaa6c924c0b18f388233120ca48bd.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.270410884319343</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.535814383365206</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.758161237585348</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.682016162783878</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.72673490759948</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/a2b4d2f45ac0ded95fb69ad29dd60a58ded72f57beab8b545ae027571090278c.png" src="../../_images/a2b4d2f45ac0ded95fb69ad29dd60a58ded72f57beab8b545ae027571090278c.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.718457411407666</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.728217339834945</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.12846124297493</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.979457794436517</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.76138385181648</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/e9e78eb104d04377544d7b013e2c9acb64532dce0095b012f290501a8d8d0367.png" src="../../_images/e9e78eb104d04377544d7b013e2c9acb64532dce0095b012f290501a8d8d0367.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0666931023915804</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.570948154148798</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-33.75172309111283</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.34984763487445</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.80524935875662</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/b1f777ef05b93ad0b29fbd65a966fb0b69ed05063bde32666ace70b34e04ba44.png" src="../../_images/b1f777ef05b93ad0b29fbd65a966fb0b69ed05063bde32666ace70b34e04ba44.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.60369245213677</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.661088686402913</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.42698640333366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.75330669772194</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.85377921401405</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/12275236e56576993b5216a3e7f9618b5e78030e2d3be613c839302bf087f0f2.png" src="../../_images/12275236e56576993b5216a3e7f9618b5e78030e2d3be613c839302bf087f0f2.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.522528348912836</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.087434714334172</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5219201896947374</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7120581653261349</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.031053604280073532</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/149775a485453d0c67bece46ecf4b2be5842d510cd9f7727d1c38360a1f28667.png" src="../../_images/149775a485453d0c67bece46ecf4b2be5842d510cd9f7727d1c38360a1f28667.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.644931958860035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.6088839088153986</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.2020299262929366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6932047474978664</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0300075952006984</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/6eb7aa3be1f5822fde6be7221b975948c97ca954deff8ffe62f04772051de708.png" src="../../_images/6eb7aa3be1f5822fde6be7221b975948c97ca954deff8ffe62f04772051de708.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.857247985827142</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.620253693612453</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.7178110341290909</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6385586351574268</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.024871803900883283</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/bce50a1f7d43acb14accf396e322ed0c3beb5f41c2e900f3c254e4d6b6f6431d.png" src="../../_images/bce50a1f7d43acb14accf396e322ed0c3beb5f41c2e900f3c254e4d6b6f6431d.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.054583470607092</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.213969481344826</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1802151487303347</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5575188538127107</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.016514065944484013</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/1972bfdc8f187a11bd2095ef6402306df785c257be48f7d6a401e279681d8cac.png" src="../../_images/1972bfdc8f187a11bd2095ef6402306df785c257be48f7d6a401e279681d8cac.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.8204611602498217</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.6866445933602545</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4442004898638774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.44171525515317445</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.004261896443358282</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/a5716f250cf1f14d97366ca2553f835d0e005359659a42baf7e74a3c69d671d3.png" src="../../_images/a5716f250cf1f14d97366ca2553f835d0e005359659a42baf7e74a3c69d671d3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.916525010187753</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5694211679753036</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.45304916530237715</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.29019675970599623</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.012127979177045667</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/e8bc445f16ef777cd455d0d520a0ed6b6c0be71f5dbb93c7ac4b2c4f792b65ac.png" src="../../_images/e8bc445f16ef777cd455d0d520a0ed6b6c0be71f5dbb93c7ac4b2c4f792b65ac.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.6244296988356774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.999065668307809</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.365897500239055</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.13086190017891353</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.029580096851855586</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/40217c81487f43c8c5a6f0ecec2b4eab029dc2a6f18d77cc3bef8655bf703bcd.png" src="../../_images/40217c81487f43c8c5a6f0ecec2b4eab029dc2a6f18d77cc3bef8655bf703bcd.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.674187516785084</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.349962171735777</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.3054687733222945</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.042405260067956974</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.048771128862545865</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/f3fe422cd223f38cb0781197f3361dd4550e1642c8d07087c665f6e769bb51b1.png" src="../../_images/f3fe422cd223f38cb0781197f3361dd4550e1642c8d07087c665f6e769bb51b1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.33846546411795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.704130152979393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.2309777125013595</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.22110747685464283</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.06878418482478832</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/a6b1942e73301689a1cbea81db05d222c94762bdd1969c5fa97b605ee51b65ae.png" src="../../_images/a6b1942e73301689a1cbea81db05d222c94762bdd1969c5fa97b605ee51b65ae.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.861013125398074</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.537419155388616</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.015879350332585</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.38538466649002956</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.08746822096359352</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/de8f505297f442ac7456684a9576943bdf91ee8e5928c44f11fcfba46c8c3b0a.png" src="../../_images/de8f505297f442ac7456684a9576943bdf91ee8e5928c44f11fcfba46c8c3b0a.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1h 44min 30s, sys: 4min 30s, total: 1h 49min 1s
Wall time: 9min 10s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">good</span><span class="p">)</span>
<span class="n">src_r</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">intvl</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">src_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((36591, 10, 500), (201, 10, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">src_r</span><span class="p">,</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.98253971862001</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.48968636326325</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.149068866979235</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.345905391399462</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/460dee0058842c007b81e96bea630cba9708219d9aa93a167bf8ecfde9802dff.png" src="../../_images/460dee0058842c007b81e96bea630cba9708219d9aa93a167bf8ecfde9802dff.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-296.825406527139</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.81541099266323</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.185901576651842</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.2555279351993196</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-225.8419451613009</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-78.1711580578063</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.854565499098145</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.199686685724094</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-805.421420894257</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-260.84427711282945</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.786946215299224</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.3004195896572996</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-22.745016214795257</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-64.13821953295862</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.985908280052028</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.56813803059379</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.6424345171163</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31.38278148605287</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.9154906856268</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.84710513024222</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.492607926345656</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.984036822856394</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.46699724124367</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.970273108897366</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65.98735366952049</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58.66058714739366</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.56978528949983</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.49532162325504</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2991.572463844293</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-763.5752012452142</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.04200412212233</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.23066363349865</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9461596687374785</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.56006470837457</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.20182741301235</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.664562099228824</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.99757524186751</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.31923852652776</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.23719328003905</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.85477703736372</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56.09714320542673</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.55231392204733</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.07039582219759</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.6862159776607</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-33.40179612205028</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.23296336846297</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.819802790857239</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.36506341086927</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.876636461585335</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54.3561656169271</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.890935707819487</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.725134437800264</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17239.83596240022</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5309.601172500764</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-57.53594790798382</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.342890483668754</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-34.61657861340812</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.841900443527727</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.340383370835387</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.43209573623314</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.23085774438386</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.40688865800508</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-14.502329734349262</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.439297296868142</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2h 11min 15s, sys: 15min 59s, total: 2h 27min 15s
Wall time: 31min 2s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2969908/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e0e6f44c5ba66f9237227856234c4b7303d46e08dfba17e6807fb250e8e99570.png" src="../../_images/e0e6f44c5ba66f9237227856234c4b7303d46e08dfba17e6807fb250e8e99570.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">4e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">6e-3</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">509</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.004</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.323840716014065</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65.98735366952049</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.006</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58.78159519628389</span><span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 14min 28s, sys: 1min 52s, total: 16min 20s
Wall time: 3min 30s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.004: 21.323840716014065, 0.005: 65.98735366952049, 0.006: 58.78159519628389}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.004: 0.850862575143545,
 0.005: 0.8515834605261383,
 0.006: 0.8484946983014074}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9cc6671844c75d24009dfcb07dfcf6397ce35a226fd39bac56bc1de7dba5a848.png" src="../../_images/9cc6671844c75d24009dfcb07dfcf6397ce35a226fd39bac56bc1de7dba5a848.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">2e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">8e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">509</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.002</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54.726434725588355</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.876636461585335</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.49639710620258</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54.3561656169271</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5min 17s, sys: 39.8 s, total: 5min 56s
Wall time: 1min 16s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.002: 54.726434725588355,
 0.005: 60.876636461585335,
 0.008: 57.49639710620258,
 0.01: 54.3561656169271}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.002: 0.816730300833981,
 0.005: 0.823988498802013,
 0.008: 0.8192084257801312,
 0.01: 0.8150759454886867}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4968fa4b4a330fd3f19ef188f86976761d8bc089aa6dd18fb40a7a0a5e84d530.png" src="../../_images/4968fa4b4a330fd3f19ef188f86976761d8bc089aa6dd18fb40a7a0a5e84d530.png" />
</div>
</div>
</section>
<section id="neuron-7">
<h3>Neuron # 7<a class="headerlink" href="#neuron-7" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">src_r</span><span class="p">,</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">8e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">3e-2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.45670079790126</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52.49199007159222</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.11001380280206</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.4684477257725</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-81.57196662111173</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-48.29200018758553</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-14.314233707853097</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-10.160843164412414</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.212734455238113</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.74182273329907</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.75944157397522</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90494686805101</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.104215215672175</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.0876824722854561</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.047083591610416</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.282142294950816</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.495504415813944</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.498379934582438</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.863022918579449</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.8407488712473774</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.593614709899434</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7489187516394278</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.466367143576646</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.603167379733433</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.88583067400881</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.75103022960318</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.613126110902982</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.9409148585645122</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-9.320388889608466</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.99835616157449</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.061993765114625</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.75081917137936</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90040799989362</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.788075535126062</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.900646778568824</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.476067248491608</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.30231499828329</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.605338458850753</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.978873724196633</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.88014144426296</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.26168190326541</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.03174526757141</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.2988167771788</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.797152636760903</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.882583628882255</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.016332150006986</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.510295626454763</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.517975380028748</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.9828713392121</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.9783266547432</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.40487033428497</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.488103061302946</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.476493032361919</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.749978691409986</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.76295201703682</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.51406232082546</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.13361228144466</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.81750082730308</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.729920913687598</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-43.45682346126311</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-14.47879344962022</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.849487571924865</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.671199791902307</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.74019115639499</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5462574301634557</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.071094079074377</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.388900994714897</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.375068936562522</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.8190335217427345</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-167.32719381937565</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.881777392639151</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.42271776066909</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.307972190543857</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.168130432934145</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.22730370224706</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56.7462218783237</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.17709172812484</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55.794374408412196</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.56021057887299</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.60071729953549</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.241977445089063</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.58235965155035</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.97587126456115</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.720515535778862</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2h 3min 59s, sys: 15min 12s, total: 2h 19min 11s
Wall time: 29min 33s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2969908/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d5284df90cd9b3dcef317ec4649c8954a4455f33cc62e40e514e467da1a86cb1.png" src="../../_images/d5284df90cd9b3dcef317ec4649c8954a4455f33cc62e40e514e467da1a86cb1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">3e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">8e-3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56.7462218783237</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.003</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.370853358571296</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.17709172812484</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.57309847231193</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55.794374408412196</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 7min 18s, sys: 52.4 s, total: 8min 10s
Wall time: 1min 42s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 56.7462218783237,
 0.003: 62.370853358571296,
 0.005: 60.17709172812484,
 0.008: 57.57309847231193,
 0.01: 55.794374408412196}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 0.8004467572385365,
 0.003: 0.7947794830616541,
 0.005: 0.7852522566915222,
 0.008: 0.7710579565156384,
 0.01: 0.7628137355096081}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d34ac3839097a8be4722c8e0b8f1d88639b181b0d884f31ad65f961fe79ebf7d.png" src="../../_images/d34ac3839097a8be4722c8e0b8f1d88639b181b0d884f31ad65f961fe79ebf7d.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./nb/2023-04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-neuron">Load neuron</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir">Reservoir</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-features">Extract features</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-what-is-r-between-pred-and-y-trn">TODO: what is r between pred and y_trn?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-neuron-clu267">Another neuron: <code class="docutils literal notranslate"><span class="pre">clu267</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Reservoir</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Reservoir</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Extract features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neuron-7">Neuron # 7</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hadi Vafaii
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>