
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>(??) Fit neurons (MT) &#8212; MT/MST project</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MT/MST project</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/intro.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  January 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/2022-01.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/2022-01_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-01/jan-23-2022.html">
     Jan 23rd, 2022 (jb tutorial)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  October 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/2022-10.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/2022-10_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-10/oct-01-2022.html">
     Oct 1st, 2022 (Load Wild Data)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-10/oct-06-2022.html">
     Oct 6th, 2022 (Python processed)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-10/oct-07-2022.html">
     Oct 7th, 2022 (Linear: STA – draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-10/oct-08-2022.html">
     Oct 8th, 2022 (Linear: STA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-10/oct-09-2022.html">
     Oct 9th, 2022 (Opticflow stats)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-10/oct-11-2022.html">
     Oct 11th, 2022 (Rot Conv verify)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2022-10/oct-16-2022.html">
     Oct 16th, 2022 (Linear: GLM – spatial)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  January 2023
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/2023-01.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/2023-01_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/08_wild.html">
     (08) Wild play
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/10_nardin.html">
     (10) Nardin play
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/15_sim-draft.html">
     (15) Simulation – draft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/16_sim-wrong.html">
     (16) Simulation – wrong
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/21_sim-explore.html">
     (21) Simulation – explore
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/23_sim-self-draft.html">
     (23) Simulation – self-motion aspect [draft]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/24_sim-self-draft.html">
     (24) Simulation – self [still draft]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/28_sim-self.html">
     (28) Simulation – self [velocity: new way]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/29_sim-full-draft.html">
     (29) Simulation – full [draft]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-01/30_sim-full-final.html">
     (30) Simulation – full [final]
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  February 2023
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/2023-02.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/2023-02_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/01_play-nvae.html">
     (01) NVAE – play
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/02_play-vae2d.html">
     (02) VAE2D – play
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/09_rot-conv.html">
     (09) RotConv2d – verified
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/23_sim-gen.html">
     (23) Simulation – generate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/24_sim-gen-decoupled.html">
     (24) Simulation – generate (fix &amp; obj uncoupled)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/24_sim-gen-save.html">
     (24) Simulation – generate (save)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/25_fit-cuda.html">
     (25) Fit – cuda (gaban)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/25_fit-cuda0.html">
     (25) Fit – cuda0
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/25_fit-cuda1.html">
     (25) Fit – cuda1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/25_fit-cuda2.html">
     (25) Fit – cuda2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-02/30_kl-balancer-debug.html">
     (30) KL Balancer
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  March 2023
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/2023-03.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/2023-03_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/17_sim-new-draft.html">
     (17) Sim New – draft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/22_sim-new-draft.html">
     (22) Sim New – draft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/23_sim-new.html">
     (23) Sim New – visualize
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/30_fit-cuda.html">
     (30) Fit – cuda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/30_fit-cuda0.html">
     (30) Fit – cuda0
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/30_fit-cuda1.html">
     (30) Fit – cuda2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/30_fit-cuda2.html">
     (30) Fit – cuda2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/30_sim-final.html">
     (30) Sim – added
     <code class="docutils literal notranslate">
      <span class="pre">
       terrain
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2023-03/31_sim-factors.html">
     (31) Sim – true generative factors
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  April 2023
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/2023-04.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/2023-04_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="02_fit-lin.html">
     (02) Fit neurons – Linear
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_fit-glm.html">
     (03) Fit neurons – GLM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_loop-glm.html">
     (03) Fit neurons – GLM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_loop-ridge.html">
     (03) Fit neurons – Ridge
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_dan.html">
     (04) Dan notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_profiler.html">
     (04) PyTorch profiler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_sim-kNN.html">
     (06) Sim – kNN analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_readout-3d.html">
     (07) Readout: 3D conv
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_readout-sep.html">
     (07) Readout: Separable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08_GLM-clu090.html">
     (08) Reservoir + GLM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08_GLM-clu096.html">
     (08) Reservoir + GLM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08_sim-dim65-manyseeds.html">
     (08) Sim – many seeds
     <code class="docutils literal notranslate">
      <span class="pre">
       dim=65
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08_sim-accept-filter.html">
     (08) Sim – behavior of
     <code class="docutils literal notranslate">
      <span class="pre">
       filter()
      </span>
     </code>
     when
     <code class="docutils literal notranslate">
      <span class="pre">
       dim=65
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09_sim-final-save.html">
     (09) Sim – generate &amp; save
     <code class="docutils literal notranslate">
      <span class="pre">
       dim=65
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="10_GLM-clu090.html">
     (10) Reservoir + GLM
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/nb/2023-04/??_reservoir.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hadivafaii/jb-MTMST"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/hadivafaii/jb-MTMST/issues/new?title=Issue%20on%20page%20%2Fnb/2023-04/??_reservoir.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hadivafaii/jb-MTMST/master?urlpath=tree/docs/nb/2023-04/??_reservoir.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-neuron">
   Load neuron
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reservoir">
   Reservoir
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-features">
     Extract features
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#todo-what-is-r-between-pred-and-y-trn">
       TODO: what is r between pred and y_trn?
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#another-neuron-clu267">
   Another neuron:
   <code class="docutils literal notranslate">
    <span class="pre">
     clu267
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Reservoir
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Reservoir
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Extract features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#neuron-7">
     Neuron # 7
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="fit-neurons-mt">
<h1>(??) Fit neurons (MT)<a class="headerlink" href="#fit-neurons-mt" title="Permalink to this headline">¶</a></h1>
<p><strong>Motivation</strong>: Load models, evaluate then fit MT <br></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/_extras&#39;</span><span class="p">)</span>
<span class="n">fig_base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/figs&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/tmp&#39;</span><span class="p">)</span>

<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;_MTMST&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">vae.train_vae</span> <span class="kn">import</span> <span class="n">TrainerVAE</span><span class="p">,</span> <span class="n">ConfigTrainVAE</span>
<span class="kn">from</span> <span class="nn">vae.vae2d</span> <span class="kn">import</span> <span class="n">VAE</span><span class="p">,</span> <span class="n">ConfigVAE</span>
<span class="kn">from</span> <span class="nn">analysis.opticflow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">figures.fighelper</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># warnings, tqdm, &amp; style</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">rich.jupyter</span> <span class="kn">import</span> <span class="nb">print</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">set_style</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">analysis.linear</span> <span class="kn">import</span> <span class="n">LinearModel</span><span class="p">,</span> <span class="n">flatten_stim</span>
<span class="kn">from</span> <span class="nn">base.dataset</span> <span class="kn">import</span> <span class="n">setup_supervised_data</span><span class="p">,</span> <span class="n">setup_repeat_data</span><span class="p">,</span> <span class="n">time_embed</span>
</pre></div>
</div>
</div>
</div>
<section id="load-neuron">
<h2>Load neuron<a class="headerlink" href="#load-neuron" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConfigVAE</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">h_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">expt</span> <span class="o">=</span> <span class="s1">&#39;clu090&#39;</span>
<span class="n">grp</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">expt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scale</span> <span class="o">=</span> <span class="mf">2.25</span>
<span class="n">hf_kws</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s1">&#39;sres&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">hf</span> <span class="o">=</span> <span class="n">HyperFlow</span><span class="p">(</span>
    <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="mi">2</span><span class="p">:],</span>
    <span class="n">center</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="o">**</span><span class="n">hf_kws</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">stim</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">compute_hyperflow</span><span class="p">()</span>
<span class="n">spks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;spks&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">good</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;badspks&#39;</span><span class="p">])</span>
<span class="n">good</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">good</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># src, tgt = setup_supervised_data(lags, good, stim, spks)</span>
<span class="n">stim_r</span><span class="p">,</span> <span class="n">spks_r</span><span class="p">,</span> <span class="n">intvl</span> <span class="o">=</span> <span class="n">setup_repeat_data</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_kws</span><span class="o">=</span><span class="n">hf_kws</span><span class="p">)</span>

<span class="n">stim_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
<span class="n">stim</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>
<span class="k">if</span> <span class="n">stim_r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">stim_r</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>

<span class="n">stim</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">stim_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((72000, 2, 19, 19), (36000, 2, 19, 19))
</pre></div>
</div>
</div>
</div>
</section>
<section id="reservoir">
<h2>Reservoir<a class="headerlink" href="#reservoir" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">ConfigVAE</span><span class="p">(</span>
    <span class="n">n_kers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">n_latent_scales</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_groups_per_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_latent_per_group</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">scale_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">residual_kl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ada_groups</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">TrainerVAE</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">ConfigTrainVAE</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">total_latents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>210
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
<span class="n">vae</span><span class="o">.</span><span class="n">scales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+--------------+------------+
| Module Name  | Num Params |
+--------------+------------+
|     VAE      |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.0</span> Mil  |
|     ---      |    ---     |
|     stem     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1</span> K    |
| pre_process  |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96.0</span> K   |
|  enc_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.4</span> Mil   |
|     enc0     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.6</span> K   |
| enc_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
| dec_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
|    expand    |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.0</span> K   |
|  dec_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> Mil   |
| post_process |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.0</span> K   |
|     out      |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">578</span>     |
+--------------+------------+ 


</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, 4]
</pre></div>
</div>
</div>
</div>
<section id="extract-features">
<h3>Extract features<a class="headerlink" href="#extract-features" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stim</span>
<span class="n">enc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">)</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)))):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stim</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">])</span>
    <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">e4</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">e8</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
        <span class="nb">input</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">enc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4</span><span class="p">,</span> <span class="n">e8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>

<span class="c1"># Stim Repeat</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stim_r</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">e4_r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">e8_r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
    <span class="nb">input</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">enc_r</span> <span class="o">=</span> <span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4_r</span><span class="p">,</span> <span class="n">e8_r</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">enc</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">enc_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████| 144/144 [00:52&lt;00:00,  2.73it/s]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((72000, 5312, 4, 4), (1000, 5312, 4, 4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc_r</span><span class="p">))</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((72000, 500), (1000, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>
    
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">x_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
    <span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;~&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.303702294021782</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.07040245621759</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.23168658917338</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_1.png" src="../../_images/??_reservoir_14_1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.23573361705703</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.13576744951038</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.65558165842052</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_5.png" src="../../_images/??_reservoir_14_5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-69.64174009158128</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.636720000772385</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.74115544874821</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_9.png" src="../../_images/??_reservoir_14_9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-94.31653402058492</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.37264128293487</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.5962220961835</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_13.png" src="../../_images/??_reservoir_14_13.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-95.68296477393112</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.00168055716584</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.60839899001178</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_17.png" src="../../_images/??_reservoir_14_17.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-82.63456533995075</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.224893742165804</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.47464543015665</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_21.png" src="../../_images/??_reservoir_14_21.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-63.90301386116959</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.31496397954474</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.070480099414137</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_25.png" src="../../_images/??_reservoir_14_25.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-44.18051086991483</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.4439876882096154</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.2277712257947604</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_14_29.png" src="../../_images/??_reservoir_14_29.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">good</span><span class="p">)</span>
<span class="n">src_r</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">intvl</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">src_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((54386, 5, 500), (200, 5, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">src_r</span><span class="p">,</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.787549034207046</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.00812149451333</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.14655501593958</span><span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<section id="todo-what-is-r-between-pred-and-y-trn">
<h4>TODO: what is r between pred and y_trn?<a class="headerlink" href="#todo-what-is-r-between-pred-and-y-trn" title="Permalink to this headline">¶</a></h4>
<p>Use this to calibrate your expectations of the Conv3D model that is running on Cuda:1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(54386,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pred</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_22_0.png" src="../../_images/??_reservoir_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp_stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span> <span class="n">pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.2910217247130925, 0.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.88628477613221</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.07998697957536</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.803989856854027</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.200090545108051</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.372907007006905</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31.626102279419634</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.53823622976818</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.760925598463274</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.809941353133436</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.50059746738271</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.458186513856475</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.04140535023382</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.4215249858006</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.1345893853703</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.250497317802385</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.84568947472112</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.595636706869257</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.108051583593014</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.41549486189459</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.90832918786476</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0376026961835048</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.45090074721545</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.33396062460725</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.715965601877265</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-142.95786446570565</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-161.85240369493715</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-121.37702026103537</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-60.6510439132681</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-175.71343353191287</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.297179810140527</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.0786150964219</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66.42561925896864</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.786726774946864</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.591662374950886</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.114230252844802</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.41352296151989</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.212554391247686</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.24974906412323</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.556597957824586</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.125156135786014</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.77115803849767</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.227380670483061</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.073199545120413</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.20247003885475</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-483.3049047890623</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-873.8526849554321</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-241.351295725346</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-85.79240966990096</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.582925222718806</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.88214350279159</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.51342272430204</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.817071588083852</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.067600833173088</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.501291571278472</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.403669636638027</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.115669111144422</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-331.59465678240485</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.492412166475475</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.487474629781005</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31.76987606020305</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-108.84217011902363</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.24027863881393</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.6165835373206425</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.11927506662155</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3h 11min 40s, sys: 24min 59s, total: 3h 36min 39s
Wall time: 48min 30s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2456880/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_27_0.png" src="../../_images/??_reservoir_27_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.008521475472016</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.4215249858006</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.1345893853703</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.14234636286034</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 12min 20s, sys: 1min 40s, total: 14min
Wall time: 3min 11s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 51.008521475472016,
 0.005: 68.4215249858006,
 0.01: 68.1345893853703,
 0.03: 62.14234636286034}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 0.775161130449842,
 0.005: 0.8282908049278253,
 0.01: 0.8278796889546903,
 0.03: 0.8360040524579301}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_32_0.png" src="../../_images/??_reservoir_32_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">8e-3</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.008521475472016</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.64272725095095</span><span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 7min 9s, sys: 57.9 s, total: 8min 7s
Wall time: 1min 52s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_34_0.png" src="../../_images/??_reservoir_34_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.620833661532856</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.73280416563001</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.88607909687642</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.534939583145729</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.481304709670795</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.225870171918434</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.82857113791968</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.967546962093795</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.247746768830837</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.6771601217158</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.961977524761124</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.09666361114553</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73.73576121198646</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73.88461227680936</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.89730582896179</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.18703136327374</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.53250501238174</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.85490131694263</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.25825227526537</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.942512422352042</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.695456645532353</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.347546386732496</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.48318383134491</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.85706886219539</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-294.16961324664845</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-228.80219011776762</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-150.65127991536906</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-73.97429914967704</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-125.65038560201182</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.366855445390296</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.76711322538855</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68.8743999574422</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.517786163452744</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.5428817358841</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.487418252496862</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.336313216152035</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.44357805216618</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59.13667117135945</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.14235833564682</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.31622984683137</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.35659608965757</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.06952339432246</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.0685673309302497</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.799575869454532</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-906.4656004371702</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-582.1211520931226</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-343.9997840584188</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-93.82358015183985</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.053441180057185</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.90104345650469</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.3674782462358</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.060883117983227</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.45046547671018</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.452053564788248</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.175896788188602</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.236563995979967</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-13.549677981868546</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.294752786996476</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42.69756774523514</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.487164706552264</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-81.3098562408521</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-91.38082354485175</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1600959833629076</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.699765296919182</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2h 52min 48s, sys: 25min 36s, total: 3h 18min 25s
Wall time: 49min 23s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2969908/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_40_0.png" src="../../_images/??_reservoir_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.0956011152039</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73.88461227680936</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.89730582896179</span><span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 8min 59s, sys: 1min 9s, total: 10min 8s
Wall time: 2min 13s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 61.0956011152039, 0.01: 73.88461227680936, 0.05: 53.89730582896179}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 0.8066820117593878, 0.01: 0.8626518723561223, 0.05: 0.8692976787845867}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_45_0.png" src="../../_images/??_reservoir_45_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70.88916643251153</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.07950939031531</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.62691499801377</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70.20907595304146</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67.29583982325616</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.05871082305687</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.693117836001484</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 14min 23s, sys: 1min 49s, total: 16min 13s
Wall time: 3min 32s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_48_0.png" src="../../_images/??_reservoir_48_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.03425217597673</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.01657247197635</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.9008986826959</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.7708330453482</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59.62959241727932</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52.699833089280276</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.37176100889194</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 15min 4s, sys: 2min, total: 17min 4s
Wall time: 3min 50s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_51_0.png" src="../../_images/??_reservoir_51_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="another-neuron-clu267">
<h2>Another neuron: <code class="docutils literal notranslate"><span class="pre">clu267</span></code><a class="headerlink" href="#another-neuron-clu267" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConfigVAE</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">h_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">expt</span> <span class="o">=</span> <span class="s1">&#39;clu267&#39;</span>
<span class="n">grp</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">expt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scale</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">hf_kws</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s1">&#39;sres&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">hf</span> <span class="o">=</span> <span class="n">HyperFlow</span><span class="p">(</span>
    <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="mi">2</span><span class="p">:],</span>
    <span class="n">center</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;hyperflow&#39;</span><span class="p">])[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="o">**</span><span class="n">hf_kws</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">stim</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">compute_hyperflow</span><span class="p">()</span>
<span class="n">spks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;spks&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">good</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s1">&#39;badspks&#39;</span><span class="p">])</span>
<span class="n">good</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">good</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># src, tgt = setup_supervised_data(lags, good, stim, spks)</span>
<span class="n">stim_r</span><span class="p">,</span> <span class="n">spks_r</span><span class="p">,</span> <span class="n">intvl</span> <span class="o">=</span> <span class="n">setup_repeat_data</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_kws</span><span class="o">=</span><span class="n">hf_kws</span><span class="p">)</span>

<span class="n">stim_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
<span class="n">stim</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>
<span class="k">if</span> <span class="n">stim_r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">stim_r</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">stim_scale</span>

<span class="n">stim</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">stim_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((43200, 19, 19, 2), (12040, 19, 19, 2))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">useful</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">useful_cells</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">expt</span><span class="p">,</span> <span class="p">{})</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">useful</span><span class="p">:</span>
    <span class="n">useful</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">spks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">useful</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>Reservoir<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">ConfigVAE</span><span class="p">(</span>
    <span class="n">n_kers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">n_latent_scales</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_groups_per_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_latent_per_group</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">scale_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">residual_kl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ada_groups</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">TrainerVAE</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">ConfigTrainVAE</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">total_latents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>210
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
<span class="n">vae</span><span class="o">.</span><span class="n">scales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+--------------+------------+
| Module Name  | Num Params |
+--------------+------------+
|     VAE      |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.0</span> Mil  |
|     ---      |    ---     |
|     stem     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1</span> K    |
| pre_process  |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96.0</span> K   |
|  enc_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.4</span> Mil   |
|     enc0     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.6</span> K   |
| enc_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
| dec_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
|    expand    |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.0</span> K   |
|  dec_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> Mil   |
| post_process |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.0</span> K   |
|     out      |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">578</span>     |
+--------------+------------+ 


</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, 4]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>Reservoir<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">ConfigVAE</span><span class="p">(</span>
    <span class="n">n_kers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">n_latent_scales</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_groups_per_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_latent_per_group</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">scale_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">residual_kl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ada_groups</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">TrainerVAE</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">ConfigTrainVAE</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">total_latents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>210
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
<span class="n">vae</span><span class="o">.</span><span class="n">scales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+--------------+------------+
| Module Name  | Num Params |
+--------------+------------+
|     VAE      |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.0</span> Mil  |
|     ---      |    ---     |
|     stem     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1</span> K    |
| pre_process  |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96.0</span> K   |
|  enc_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.4</span> Mil   |
|     enc0     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.6</span> K   |
| enc_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
| dec_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4</span> Mil   |
|    expand    |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71.0</span> K   |
|  dec_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.5</span> Mil   |
| post_process |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.0</span> K   |
|     out      |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">578</span>     |
+--------------+------------+ 


</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, 4]
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h3>Extract features<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stim</span>
<span class="n">enc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">)</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)))):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stim</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">stim</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">e4</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">e8</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
        <span class="nb">input</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">enc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4</span><span class="p">,</span> <span class="n">e8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>

<span class="c1"># Stim Repeat</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">stim_r</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ftr</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model_ema</span><span class="o">.</span><span class="n">xtract_ftr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">e4_r</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">silu</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">e8_r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span>
    <span class="nb">input</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ftr</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">enc_r</span> <span class="o">=</span> <span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">e4_r</span><span class="p">,</span> <span class="n">e8_r</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">enc</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">enc_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████| 87/87 [00:20&lt;00:00,  4.22it/s]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((43200, 5248, 4, 4), (1000, 5248, 4, 4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc</span><span class="p">))</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">flatten_stim</span><span class="p">(</span><span class="n">enc_r</span><span class="p">))</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((43200, 500), (1000, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="k">for</span> <span class="n">neuron_i</span> <span class="ow">in</span> <span class="n">useful</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

        <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
            <span class="n">x_tst</span><span class="o">=</span><span class="n">x_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">],</span>
            <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Neuron # </span><span class="si">{</span><span class="n">neuron_i</span><span class="si">}</span><span class="s2">. lag = </span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s2">, r2:</span><span class="se">\n</span><span class="si">{</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;~&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.40657192024695</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.074905984385076</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-19.047669449121642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.347453507168716</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.278817971923772</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_1.png" src="../../_images/??_reservoir_68_1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-38.377894725809945</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-9.498493832994036</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.227497292720063</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.21216817148688</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.26437348682762</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_3.png" src="../../_images/??_reservoir_68_3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.530597877612255</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.2123446424512405</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.40601789300351</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.082031409291417</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.25053633283949</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_5.png" src="../../_images/??_reservoir_68_5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.080213733641912</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.586293743601578</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.737947933324815</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.97338314024249</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.238949308230563</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_7.png" src="../../_images/??_reservoir_68_7.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-33.89465571528913</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.01026669533291</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.279436716233175</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.89096135453419</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.23006489630997</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_9.png" src="../../_images/??_reservoir_68_9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.56249797497559</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.606555107675736</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.964535720573348</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.832169195284347</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.22369853702906</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_11.png" src="../../_images/??_reservoir_68_11.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.801972803467393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.7596594081491297</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.729358533630533</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.790558296601418</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.21920974676113</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_13.png" src="../../_images/??_reservoir_68_13.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.556587042436067</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.075090731438835</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.759252040812587</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.783936293494467</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.218351474521295</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_15.png" src="../../_images/??_reservoir_68_15.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.254592967542226</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.575749377342753</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.961952776770172</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.806034897799023</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.220570892261218</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_17.png" src="../../_images/??_reservoir_68_17.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.059109530051707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.41599025572479</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.351305459082543</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.857259622818596</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.22588818527025</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_19.png" src="../../_images/??_reservoir_68_19.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.864163492497084</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.89284727008228</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8050167642223327</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6685234834044707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7064479123444656</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_23.png" src="../../_images/??_reservoir_68_23.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.833496189447253</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.259771969674466</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8338817030248746</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6687964219010079</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7064302597850292</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_25.png" src="../../_images/??_reservoir_68_25.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.87059635552801</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.462538493059133</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8626788061685708</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6707032640924204</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7066037743304276</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_27.png" src="../../_images/??_reservoir_68_27.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.07011774848366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.568631662379887</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8892588629016984</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6733816210763743</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7068738837006983</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_29.png" src="../../_images/??_reservoir_68_29.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.661215740411176</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.886474807040033</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.9576991234682586</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.681865117724878</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7077501231242733</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_31.png" src="../../_images/??_reservoir_68_31.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.638154654339957</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.083267103497892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.022472366581506</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6924794231103926</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7088669390266311</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_33.png" src="../../_images/??_reservoir_68_33.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-22.312905983290833</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.33840468218987</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.1270069055081544</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.707683979366025</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.710469381104617</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_35.png" src="../../_images/??_reservoir_68_35.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.990842881881047</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.606327824262671</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.2447547508310342</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7251761257861977</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7123159032758952</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_37.png" src="../../_images/??_reservoir_68_37.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.89922367341302</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.950919531142642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.3900856736755118</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7467314310581008</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7145918376338711</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_39.png" src="../../_images/??_reservoir_68_39.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.987526628323554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.241581859903002</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5310801405512109</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.7675087284809035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.716781962613533</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_41.png" src="../../_images/??_reservoir_68_41.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.476487994800804</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.494594935967083</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.506290705438786</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.640141224570005</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.345588721556076</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_45.png" src="../../_images/??_reservoir_68_45.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.3281394388409362</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17.147157973320304</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.095702532902685</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.075865296381366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.28394543241481</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_47.png" src="../../_images/??_reservoir_68_47.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.613433561658023</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.826251452728698</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.936208945582795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.662175193289606</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.239045111609727</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_49.png" src="../../_images/??_reservoir_68_49.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.00022839987753</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.8271455720366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.75772829237353</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.435996455171974</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.21493979597269</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_51.png" src="../../_images/??_reservoir_68_51.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.243779433845484</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.207414698976194</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.43437438204689</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.406386027018272</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.212467416581298</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_53.png" src="../../_images/??_reservoir_68_53.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.43359895539705</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.70367338756394</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.929191320021527</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.56428529201892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.230451666569785</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_55.png" src="../../_images/??_reservoir_68_55.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.55102272869564</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.279623774715084</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.20768906688223</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.912299046477463</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.269179442278865</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_57.png" src="../../_images/??_reservoir_68_57.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.573794965625071</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.131197464454225</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.426572707474346</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.424609187408823</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.325890231834357</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_59.png" src="../../_images/??_reservoir_68_59.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.836804672377514</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.04826031105208</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.683450259532087</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.074633115771086</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.397413792804734</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_61.png" src="../../_images/??_reservoir_68_61.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.639209847656172</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.48372571298828</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.23186681754519</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17.834563616645372</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.48092131636914</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_63.png" src="../../_images/??_reservoir_68_63.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-92.3050990077092</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.85879497482124</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.599928854392564</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.761351775105869</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.9632458135947939</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_67.png" src="../../_images/??_reservoir_68_67.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-92.23084473706098</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.9970220314146</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.774523786249986</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.634135217798762</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.8677783358620248</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_69.png" src="../../_images/??_reservoir_68_69.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-67.92579631559555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.48645149419082</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.62679945119428</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.38704094505219</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7861425405743425</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_71.png" src="../../_images/??_reservoir_68_71.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-53.24393918526309</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.7890985896898</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.696487101891975</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.965707788479035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7236974047363463</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_73.png" src="../../_images/??_reservoir_68_73.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-64.81641009645622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.613897481276425</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.891564070694663</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.352863513815043</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.6821918815151937</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_75.png" src="../../_images/??_reservoir_68_75.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-79.58630219425812</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51.70972693425713</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.034181340415202</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.524331800438476</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.664034609090348</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_77.png" src="../../_images/??_reservoir_68_77.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-74.96385899403522</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.443924240525796</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.153377314877762</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.480779753743425</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.669143516467031</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_79.png" src="../../_images/??_reservoir_68_79.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.316446998879165</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.1001603900513</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.094119500632885</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.2148947744853125</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.6980674114435823</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_81.png" src="../../_images/??_reservoir_68_81.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.289150225599638</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.589240712403935</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.07141909460631</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.756622052203607</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7479036443673213</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_83.png" src="../../_images/??_reservoir_68_83.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.33569152849148</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.568196045159446</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.086145382218294</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.126974588140763</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.8163302310897134</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_85.png" src="../../_images/??_reservoir_68_85.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-58.61548728986716</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-46.49959789769393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-34.64402580469654</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.236498156153257</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.658086180873976</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_89.png" src="../../_images/??_reservoir_68_89.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-61.79223991819662</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-48.35917388558224</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.1971948359036</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.309694329273242</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.66566694166346</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_91.png" src="../../_images/??_reservoir_68_91.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-61.56683024227607</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-49.820584096004936</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.717905803529845</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.380728937725475</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.673051895393666</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_93.png" src="../../_images/??_reservoir_68_93.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-58.99998849816295</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-51.02354026616523</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.244126311701464</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.45508499878684</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.680813674885886</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_95.png" src="../../_images/??_reservoir_68_95.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-51.521822490020575</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-51.78721189624022</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.758114183105306</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.530880343058197</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.688768133975362</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_97.png" src="../../_images/??_reservoir_68_97.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-54.185234099892355</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-53.656589531993085</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.40290217013891</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.621658098866035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.698243321041673</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_99.png" src="../../_images/??_reservoir_68_99.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-52.97402260787629</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-54.895870615367116</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.99283528222295</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.708207545090758</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.707323571350443</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_101.png" src="../../_images/??_reservoir_68_101.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-38.30020283441302</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-54.83607368615677</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-38.50704594688597</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.790281397847473</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.71601424696322</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_103.png" src="../../_images/??_reservoir_68_103.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.116597413455516</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-55.48218053090039</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-39.07006956071915</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.877879351389794</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.72526640971185</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_105.png" src="../../_images/??_reservoir_68_105.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-34.06510270115803</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-57.291606956577844</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-39.72746744369153</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.974032279675413</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.7353558625177</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_107.png" src="../../_images/??_reservoir_68_107.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.89520991684442</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.8534591907535</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.488614267666629</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.342280586211534</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.801028838644086</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_111.png" src="../../_images/??_reservoir_68_111.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.444558880938246</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.57117695395853</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.668269597519298</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.164956091167205</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.7824144640270765</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_113.png" src="../../_images/??_reservoir_68_113.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.26852343997473</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.3890718048393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.589454544195565</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.024494056051432</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.767660078738059</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_115.png" src="../../_images/??_reservoir_68_115.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64.83518300246094</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.52238524725867</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.268961332051642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.918716596925421</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.75646745970342</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_117.png" src="../../_images/??_reservoir_68_117.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65.54693298587672</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.678621590654465</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.633623052120669</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.857845340294942</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.750045752385848</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_119.png" src="../../_images/??_reservoir_68_119.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63.56917788142946</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.88623868074705</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.652526637712125</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.8461785127496215</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.748747035071224</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_121.png" src="../../_images/??_reservoir_68_121.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61.64551414133159</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44.91954176125073</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12.267787160851096</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.891532689108802</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.753389743102712</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_123.png" src="../../_images/??_reservoir_68_123.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.52040582712106</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.879923208721124</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.528723223323933</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.987617221446317</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.76333722471807</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_125.png" src="../../_images/??_reservoir_68_125.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53.39516065685799</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.42926427864738</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.51309859257078</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.12935414750888</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.778136476023612</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_127.png" src="../../_images/??_reservoir_68_127.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.896684097085526</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.172126876416385</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.202641428127055</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.316659551213432</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.797764457091683</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_129.png" src="../../_images/??_reservoir_68_129.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-414.33618220140795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.71612939758431</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.841978508406275</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.568762086923206</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.3353858603839299</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_133.png" src="../../_images/??_reservoir_68_133.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-548.3533087548572</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.59356900800207</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.45812339454801</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.017045082810312</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.2880892763289955</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_135.png" src="../../_images/??_reservoir_68_135.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-444.103465168979</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.90392689029555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.526688825843564</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.376800213580902</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.25009738508734447</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_137.png" src="../../_images/??_reservoir_68_137.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-357.8126360613227</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.605604061669478</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.07280081174261</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.65611012657341</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.22051762413373144</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_139.png" src="../../_images/??_reservoir_68_139.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-288.8587479183993</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.18140825246687</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.047487427779544</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.837794754728531</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.20122720127413452</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_141.png" src="../../_images/??_reservoir_68_141.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-220.18967529034717</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.522909908772622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.44357433972523</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.916675102146396</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.19275916154637418</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_143.png" src="../../_images/??_reservoir_68_143.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-167.65700679493852</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.218572943773342</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37.22919692256519</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.880724539677473</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.19654638700108418</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_145.png" src="../../_images/??_reservoir_68_145.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-134.47598936733849</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.025662382129127</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.52191131920344</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.7461460870463</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.2108906298923685</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_147.png" src="../../_images/??_reservoir_68_147.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-126.8085743711199</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.072828260287748</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.30072925416394</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.508514414408561</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.23630799468725705</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_149.png" src="../../_images/??_reservoir_68_149.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-59.6255585767427</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.6253955471475781</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.559926194420555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.178326454049209</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.2715413454200677</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_151.png" src="../../_images/??_reservoir_68_151.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.850278156107514</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.022785675024208</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5823123434313802</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.510582904410774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6402286187694024</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_155.png" src="../../_images/??_reservoir_68_155.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.696297861419809</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.221834718042892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5196549520917868</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.502128978375695</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.639344957032841</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_157.png" src="../../_images/??_reservoir_68_157.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.7649357205786576</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.353081255455891</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.458630449341336</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4935395054369147</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6384470728882725</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_159.png" src="../../_images/??_reservoir_68_159.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.018607404903876</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.520006475671843</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.3827346962928644</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4833825941475096</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6373916137448994</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_161.png" src="../../_images/??_reservoir_68_161.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.639740265955785</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.75502579523621</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.2985130143235546</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4725210172964918</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.636267314424523</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_163.png" src="../../_images/??_reservoir_68_163.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.360858753094968</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.969075940074617</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.2137591930073688</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4618761088142094</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6351660538561195</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_165.png" src="../../_images/??_reservoir_68_165.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.432352180694192</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.1266596871817876</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.1365627993066063</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4511398496272596</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.634052082369709</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_167.png" src="../../_images/??_reservoir_68_167.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.609440065950668</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.1733330331012666</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.0533318867347319</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4403089862478744</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6329211194348723</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_169.png" src="../../_images/??_reservoir_68_169.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.713602846080992</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.3054539221165857</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.9707595201511765</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.42935662533057</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.631780638927772</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_171.png" src="../../_images/??_reservoir_68_171.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.64863009945106</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.3816331117908605</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.8938041903032046</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.4200232265341626</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.6308092864962163</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_173.png" src="../../_images/??_reservoir_68_173.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-56.071656962323836</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.567292584175117</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.443291844060774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8053818029133519</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.023624066114280584</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_177.png" src="../../_images/??_reservoir_68_177.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-65.86174969859482</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.86706753694821</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.6706237796388965</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8343977330715013</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.026596945129686578</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_179.png" src="../../_images/??_reservoir_68_179.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-77.46316401157985</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.862325189177973</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.835015259071509</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8564589470477224</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.028869489848903918</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_181.png" src="../../_images/??_reservoir_68_181.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-82.22188802178074</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.61561512920875</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.890305119541285</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8655805238064085</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.029827541105387212</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_183.png" src="../../_images/??_reservoir_68_183.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.3000599543671</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.967230178498856</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.783652482945136</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8558155364673081</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.028870812229742082</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_185.png" src="../../_images/??_reservoir_68_185.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-79.22195987460555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25.09435772197707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.638761399651162</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8418871202326539</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02749597661333425</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_187.png" src="../../_images/??_reservoir_68_187.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.75437596039716</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23.74298508592757</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.342393606595854</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8105502108044282</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.024359799308670826</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_189.png" src="../../_images/??_reservoir_68_189.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-69.69670760857909</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.25022538314554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.963451054780833</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.768963678496104</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.020176778548119945</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_191.png" src="../../_images/??_reservoir_68_191.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-69.20205106195007</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20.663336510596274</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.539881391746361</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7217881340452648</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.015423097281153098</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_193.png" src="../../_images/??_reservoir_68_193.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-75.37449006350143</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.69548542661982</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.029777506985024</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6646459263461413</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.009659749961921094</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_195.png" src="../../_images/??_reservoir_68_195.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-100.51573859046954</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.835432130350554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.289509283013697</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.097741607417795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.22168721654363</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_199.png" src="../../_images/??_reservoir_68_199.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-96.26343492193475</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.795002943419984</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.2794839391359</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.08802552321034</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.220501518878578</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_201.png" src="../../_images/??_reservoir_68_201.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-93.04949844280081</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.042097108262617</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.334416709386115</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.087847343109644</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.220332625451732</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_203.png" src="../../_images/??_reservoir_68_203.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-97.30552958514838</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.076561123889075</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.495094502670153</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.101675624946694</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.221637765565514</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_205.png" src="../../_images/??_reservoir_68_205.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-99.58529042703417</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.915189531523808</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.671658573003548</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.121800277947344</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.22367214276948</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_207.png" src="../../_images/??_reservoir_68_207.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-98.83513969873971</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.469758443129376</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.87152950174529</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.14903947553868</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.22651355368297</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_209.png" src="../../_images/??_reservoir_68_209.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-98.13079961150406</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.998695117202697</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.094469146683913</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.182749130436584</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.230086339157662</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_211.png" src="../../_images/??_reservoir_68_211.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-93.90516813204779</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.155638833769146</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.316339932390882</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.220173045530323</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.23410748366674</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_213.png" src="../../_images/??_reservoir_68_213.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-88.840259025712</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.16067317067692</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.5570274727898</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.262900416690766</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.23872915506484</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_215.png" src="../../_images/??_reservoir_68_215.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-88.3238490336635</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-27.7088288171607</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.862161558488346</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.313708019730583</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.244195566914104</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_217.png" src="../../_images/??_reservoir_68_217.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.674573291713589</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-25.17866501478794</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.924686848062642</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.822162775279427</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.7618796592849</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_221.png" src="../../_images/??_reservoir_68_221.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.861797743762615</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-22.46832588025147</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.25822212914011</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.552891455808396</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.725855129125094</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_223.png" src="../../_images/??_reservoir_68_223.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.372911448230585</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.60314510176622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.02426326053238</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.37457252534532</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.700679654533445</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_225.png" src="../../_images/??_reservoir_68_225.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32.51464916498297</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-21.417314655781226</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.21039052828076</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.30274151592993</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.68850892241812</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_227.png" src="../../_images/??_reservoir_68_227.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.4516700876109</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.331921720295163</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.568781330161876</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.31539722304644</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.687444129295095</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_229.png" src="../../_images/??_reservoir_68_229.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.141616107985373</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.337689458536758</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-29.36429987912803</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.438467268681713</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.69989426556834</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_231.png" src="../../_images/??_reservoir_68_231.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.270410884319343</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-23.535814383365206</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-30.758161237585348</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.682016162783878</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.72673490759948</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_233.png" src="../../_images/??_reservoir_68_233.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.718457411407666</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-24.728217339834945</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.12846124297493</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-31.979457794436517</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.76138385181648</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_235.png" src="../../_images/??_reservoir_68_235.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0666931023915804</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.570948154148798</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-33.75172309111283</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.34984763487445</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.80524935875662</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_237.png" src="../../_images/??_reservoir_68_237.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.60369245213677</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-28.661088686402913</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-35.42698640333366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.75330669772194</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-32.85377921401405</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_239.png" src="../../_images/??_reservoir_68_239.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.522528348912836</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.087434714334172</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.5219201896947374</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7120581653261349</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.031053604280073532</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_243.png" src="../../_images/??_reservoir_68_243.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.644931958860035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.6088839088153986</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.2020299262929366</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6932047474978664</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0300075952006984</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_245.png" src="../../_images/??_reservoir_68_245.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.857247985827142</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.620253693612453</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.7178110341290909</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6385586351574268</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.024871803900883283</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_247.png" src="../../_images/??_reservoir_68_247.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.054583470607092</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.213969481344826</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1802151487303347</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5575188538127107</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.016514065944484013</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_249.png" src="../../_images/??_reservoir_68_249.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.8204611602498217</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.6866445933602545</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4442004898638774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.44171525515317445</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.004261896443358282</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_251.png" src="../../_images/??_reservoir_68_251.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.916525010187753</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5694211679753036</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.45304916530237715</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.29019675970599623</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.012127979177045667</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_253.png" src="../../_images/??_reservoir_68_253.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.6244296988356774</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.999065668307809</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.365897500239055</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.13086190017891353</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.029580096851855586</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_255.png" src="../../_images/??_reservoir_68_255.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-11.674187516785084</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.349962171735777</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.3054687733222945</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.042405260067956974</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.048771128862545865</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_257.png" src="../../_images/??_reservoir_68_257.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-18.33846546411795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.704130152979393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.2309777125013595</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.22110747685464283</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.06878418482478832</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_259.png" src="../../_images/??_reservoir_68_259.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Neuron # <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>. lag = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, r2:
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-20.861013125398074</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.537419155388616</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-4.015879350332585</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: 
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.38538466649002956</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.08746822096359352</span><span style="font-weight: bold">}</span>
</pre>
</div><img alt="../../_images/??_reservoir_68_261.png" src="../../_images/??_reservoir_68_261.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">



</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1h 44min 30s, sys: 4min 30s, total: 1h 49min 1s
Wall time: 9min 10s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">good</span><span class="p">)</span>
<span class="n">src_r</span> <span class="o">=</span> <span class="n">time_embed</span><span class="p">(</span><span class="n">x_r</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">idxs</span><span class="o">=</span><span class="n">intvl</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">src_r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((36591, 10, 500), (201, 10, 500))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">src_r</span><span class="p">,</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.98253971862001</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49.48968636326325</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.149068866979235</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.345905391399462</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_73_0.png" src="../../_images/??_reservoir_73_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-296.825406527139</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.81541099266323</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.185901576651842</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.2555279351993196</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-225.8419451613009</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-78.1711580578063</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.854565499098145</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.199686685724094</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-805.421420894257</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-260.84427711282945</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.786946215299224</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.3004195896572996</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-22.745016214795257</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-64.13821953295862</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.985908280052028</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.56813803059379</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.6424345171163</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31.38278148605287</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.9154906856268</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.84710513024222</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.492607926345656</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.984036822856394</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.46699724124367</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.970273108897366</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65.98735366952049</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58.66058714739366</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30.56978528949983</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.49532162325504</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2991.572463844293</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-763.5752012452142</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.04200412212233</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.23066363349865</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9461596687374785</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.56006470837457</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.20182741301235</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.664562099228824</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.99757524186751</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.31923852652776</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.23719328003905</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.85477703736372</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56.09714320542673</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50.55231392204733</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.07039582219759</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29.6862159776607</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-33.40179612205028</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-26.23296336846297</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.819802790857239</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.36506341086927</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.876636461585335</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54.3561656169271</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.890935707819487</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.725134437800264</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-17239.83596240022</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5309.601172500764</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-57.53594790798382</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.342890483668754</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-34.61657861340812</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.841900443527727</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.340383370835387</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14.43209573623314</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-36.23085774438386</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-37.40688865800508</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-14.502329734349262</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.439297296868142</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2h 11min 15s, sys: 15min 59s, total: 2h 27min 15s
Wall time: 31min 2s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2969908/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_77_0.png" src="../../_images/??_reservoir_77_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">4e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">6e-3</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">509</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.004</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.323840716014065</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65.98735366952049</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.006</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58.78159519628389</span><span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 14min 28s, sys: 1min 52s, total: 16min 20s
Wall time: 3min 30s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.004: 21.323840716014065, 0.005: 65.98735366952049, 0.006: 58.78159519628389}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.004: 0.850862575143545,
 0.005: 0.8515834605261383,
 0.006: 0.8484946983014074}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_82_0.png" src="../../_images/??_reservoir_82_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">2e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">8e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">509</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.002</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54.726434725588355</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.876636461585335</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.49639710620258</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54.3561656169271</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5min 17s, sys: 39.8 s, total: 5min 56s
Wall time: 1min 16s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.002: 54.726434725588355,
 0.005: 60.876636461585335,
 0.008: 57.49639710620258,
 0.01: 54.3561656169271}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.002: 0.816730300833981,
 0.005: 0.823988498802013,
 0.008: 0.8192084257801312,
 0.01: 0.8150759454886867}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_88_0.png" src="../../_images/??_reservoir_88_0.png" />
</div>
</div>
</section>
<section id="neuron-7">
<h3>Neuron # 7<a class="headerlink" href="#neuron-7" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">good</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">src_r</span><span class="p">,</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">8e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">3e-2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48.45670079790126</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52.49199007159222</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.11001380280206</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.4684477257725</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">lag</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">good</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="n">idxs</span> <span class="o">&gt;</span> <span class="n">lag</span><span class="p">]</span>

<span class="n">neuron_i</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
        <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-81.57196662111173</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-48.29200018758553</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-14.314233707853097</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-10.160843164412414</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-8.212734455238113</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.74182273329907</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46.75944157397522</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90494686805101</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.104215215672175</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.0876824722854561</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.047083591610416</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.282142294950816</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.495504415813944</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.498379934582438</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.863022918579449</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.8407488712473774</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.593614709899434</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.7489187516394278</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.466367143576646</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.603167379733433</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.88583067400881</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40.75103022960318</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.613126110902982</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-0.9409148585645122</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-9.320388889608466</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15.99835616157449</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.061993765114625</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.75081917137936</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19.90040799989362</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.788075535126062</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.900646778568824</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.476067248491608</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10.30231499828329</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.605338458850753</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.978873724196633</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47.88014144426296</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38.26168190326541</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.03174526757141</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.2988167771788</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.797152636760903</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.882583628882255</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-5.016332150006986</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-15.510295626454763</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-16.517975380028748</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-12.9828713392121</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35.9783266547432</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24.40487033428497</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11.488103061302946</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7.476493032361919</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.749978691409986</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45.76295201703682</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34.51406232082546</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.13361228144466</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18.81750082730308</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.729920913687598</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-43.45682346126311</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-14.47879344962022</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9.849487571924865</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.671199791902307</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27.74019115639499</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1.5462574301634557</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-3.071094079074377</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.388900994714897</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.375068936562522</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.8190335217427345</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-167.32719381937565</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-2.881777392639151</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26.42271776066909</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22.307972190543857</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13.168130432934145</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36.22730370224706</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56.7462218783237</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.17709172812484</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55.794374408412196</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41.56021057887299</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.60071729953549</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28.241977445089063</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43.58235965155035</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39.97587126456115</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21.720515535778862</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2h 3min 59s, sys: 15min 12s, total: 2h 19min 11s
Wall time: 29min 33s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2969908/2870421635.py:4: RuntimeWarning: All-NaN slice encountered
  best = np.nanmax(best, 0);
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_96_0.png" src="../../_images/??_reservoir_96_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">glm_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">category</span><span class="o">=</span><span class="s1">&#39;PoissonRegressor&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">enc</span><span class="p">[</span><span class="n">idxs</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">spks</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="n">neuron_i</span><span class="p">],</span>
    <span class="n">x_tst</span><span class="o">=</span><span class="n">enc_r</span><span class="p">[</span><span class="n">intvl</span> <span class="o">-</span> <span class="n">lag</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
    <span class="n">y_tst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">spks_r</span><span class="p">[</span><span class="n">neuron_i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">3e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">8e-3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">glm</span> <span class="o">=</span> <span class="n">LinearModel</span><span class="p">(</span><span class="o">**</span><span class="n">glm_kws</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
<span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.001</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56.7462218783237</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.003</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62.370853358571296</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.005</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60.17709172812484</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.008</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57.57309847231193</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55.794374408412196</span>
<span style="font-weight: bold">}</span>
</pre>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 7min 18s, sys: 52.4 s, total: 8min 10s
Wall time: 1min 42s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r2_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 56.7462218783237,
 0.003: 62.370853358571296,
 0.005: 60.17709172812484,
 0.008: 57.57309847231193,
 0.01: 55.794374408412196}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">r_tst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0.001: 0.8004467572385365,
 0.003: 0.7947794830616541,
 0.005: 0.7852522566915222,
 0.008: 0.7710579565156384,
 0.01: 0.7628137355096081}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">show_pred</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/??_reservoir_102_0.png" src="../../_images/??_reservoir_102_0.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nb/2023-04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hadi Vafaii<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>