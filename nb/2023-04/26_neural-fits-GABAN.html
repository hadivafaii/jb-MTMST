

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>(26) Load and plot neural results &#8212; MT/MST project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'nb/2023-04/26_neural-fits-GABAN';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="(26) Load and plot neural results" href="26_neural-fits-KABA.html" />
    <link rel="prev" title="(25) Diameters: dist" href="25_diameters.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../md/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../md/intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2022-01.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2022-01_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022-01/jan-23-2022.html">Jan 23rd, 2022 (jb tutorial)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">October 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2022-10.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2022-10_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-01-2022.html">Oct 1st, 2022 (Load Wild Data)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-06-2022.html">Oct 6th, 2022 (Python processed)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-07-2022.html">Oct 7th, 2022 (Linear: STA – draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-08-2022.html">Oct 8th, 2022 (Linear: STA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-09-2022.html">Oct 9th, 2022 (Opticflow stats)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-11-2022.html">Oct 11th, 2022 (Rot Conv verify)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-16-2022.html">Oct 16th, 2022 (Linear: GLM – spatial)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-01.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-01_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/08_wild.html">(08) Wild play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/10_nardin.html">(10) Nardin play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/15_sim-draft.html">(15) Simulation – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/16_sim-wrong.html">(16) Simulation – wrong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/21_sim-explore.html">(21) Simulation – explore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/23_sim-self-draft.html">(23) Simulation – self-motion aspect [draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/24_sim-self-draft.html">(24) Simulation – self [still draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/28_sim-self.html">(28) Simulation – self [velocity: new way]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/29_sim-full-draft.html">(29) Simulation – full [draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/30_sim-full-final.html">(30) Simulation – full [final]</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">February 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-02.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-02_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/01_play-nvae.html">(01) NVAE – play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/02_play-vae2d.html">(02) VAE2D – play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/09_rot-conv.html">(09) RotConv2d – verified</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/23_sim-gen.html">(23) Simulation – generate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/24_sim-gen-decoupled.html">(24) Simulation – generate (fix &amp; obj uncoupled)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/24_sim-gen-save.html">(24) Simulation – generate (save)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda.html">(25) Fit – cuda (gaban)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda0.html">(25) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda1.html">(25) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda2.html">(25) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/30_kl-balancer-debug.html">(30) KL Balancer</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">March 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-03.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-03_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/17_sim-new-draft.html">(17) Sim New – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/22_sim-new-draft.html">(22) Sim New – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/23_sim-new.html">(23) Sim New – visualize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda.html">(30) Fit – cuda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda0.html">(30) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda1.html">(30) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda2.html">(30) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_sim-final.html">(30) Sim – added <code class="docutils literal notranslate"><span class="pre">terrain</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/31_sim-factors.html">(31) Sim – true generative factors</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">April 2023</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-04.html">Summary</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../md/2023-04_updates.html">Updates</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="02_fit-lin.html">(02) Fit neurons – Linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_fit-glm.html">(03) Fit neurons – GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_loop-glm.html">(03) Fit neurons – GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_loop-ridge.html">(03) Fit neurons – Ridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_dan.html">(04) Dan notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_profiler.html">(04) PyTorch profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_sim-kNN.html">(06) Sim – kNN analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_readout-3d.html">(07) Readout: 3D conv</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_readout-sep.html">(07) Readout: Separable</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_GLM-clu090.html">(08) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_GLM-clu096.html">(08) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_sim-accept-filter.html">(08) Sim – behavior of <code class="docutils literal notranslate"><span class="pre">filter()</span></code> when <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="08_sim-dim65-manyseeds.html">(08) Sim – many seeds <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="09_sim-final-save.html">(09) Sim – generate &amp; save <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="10_GLM-clu090.html">(10) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_GLM-pix.html">(12) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_dim17-accept-filter.html">(13) Sim – behavior of <code class="docutils literal notranslate"><span class="pre">filter()</span></code> when <code class="docutils literal notranslate"><span class="pre">dim=17</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="13_dim17-dists.html">(13) Sim – dists for <code class="docutils literal notranslate"><span class="pre">dim=17</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda.html">(13) Fit – cuda</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda0.html">(13) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda1.html">(13) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_fit-cuda2.html">(13) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_GLM-loop.html">(14) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_GLM-loop.html">(15) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_GLM-save.html">(16) Reservoir + GLM + Save</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_fixate1-glm-GABAN.html">(18) Fixate1 + GLM (GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_fixate1-glm-KABA.html">(18) Fixate1 + GLM (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="20_eval.html">(20) Eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="23_nardin.html">(23) Nardin notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="24_meeting-plots.html">(24) Make some figs</a></li>
<li class="toctree-l2"><a class="reference internal" href="25_diameters.html">(25) Diameters: dist</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">(26) Load and plot neural results</a></li>
<li class="toctree-l2"><a class="reference internal" href="26_neural-fits-KABA.html">(26) Load and plot neural results</a></li>

<li class="toctree-l2"><a class="reference internal" href="29_combine-fits.html">(29) Combine neural fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="%3F%3F_logging.html">(??) Regression – DCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="tmp.html">(??) Tmp</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hadivafaii/jb-MTMST" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hadivafaii/jb-MTMST/issues/new?title=Issue%20on%20page%20%2Fnb/2023-04/26_neural-fits-GABAN.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/nb/2023-04/26_neural-fits-GABAN.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>(26) Load and plot neural results</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-0">Fixate 0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-2">Terrain 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-4">Terrain 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-2-local">Fixate 2 (local)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-1">Fixate 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir">Reservoir</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-1">Terrain 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transl-0">Transl 0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate2">Fixate2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-8">Terrain 8</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-older-stuff-below">Note: older stuff below</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-1-ema">Fixate 1, EMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Fixate 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-mask-bug-fixed-res">Apply mask (bug fixed; Res)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-mask-not-res">Apply Mask Not (Res)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-to-latents-reservoir">Fit to latents (Reservoir)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lags-12-res">Lags 12 (res)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir-loop-lags-incorrect-name-it-was-10-lags">Reservoir (loop lags)(incorrect name: it was 10 lags)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir-no-lags-loop">Reservoir (no lags loop)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitted-vae-fixate1-only-top-lag">Fitted VAE fixate1 (only top lag)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitted-vae-fixate1">Fitted VAE (fixate1)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate1-blue-being-trained">Fixate1 (blue, being trained)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-paradigm-scale-2-no-act-fn-avg-pool-loop-lags">New paradigm: scale=2, no act fn, avg pool, loop lags</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-study-behavior-of-log-a-20-maybe-don-t-need-to-that-far">TODO: study behavior of log_a = -20, maybe don’t need to that far</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-normalize">No Normalize</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#res-50-pcs">Res + 50 PCs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir-version">Reservoir version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trained-vae-version">Trained VAE version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trainer-evaluation">Trainer evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load">Load</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-readout">Load Readout</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Reservoir</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another">Another</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Load Readout</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="load-and-plot-neural-results">
<h1>(26) Load and plot neural results<a class="headerlink" href="#load-and-plot-neural-results" title="Permalink to this headline">#</a></h1>
<p><strong>Motivation</strong>: Fits on GABAN <br></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/_extras&#39;</span><span class="p">)</span>
<span class="n">fig_base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/figs&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/tmp&#39;</span><span class="p">)</span>

<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;_MTMST&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">vae.train_vae</span> <span class="kn">import</span> <span class="n">TrainerVAE</span><span class="p">,</span> <span class="n">ConfigTrainVAE</span>
<span class="kn">from</span> <span class="nn">vae.vae2d</span> <span class="kn">import</span> <span class="n">VAE</span><span class="p">,</span> <span class="n">ConfigVAE</span>
<span class="kn">from</span> <span class="nn">figures.fighelper</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.glm</span> <span class="kn">import</span> <span class="o">*</span>


<span class="c1"># warnings, tqdm, &amp; style</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">rich.jupyter</span> <span class="kn">import</span> <span class="nb">print</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">set_style</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="fixate-0">
<h2>Fixate 0<a class="headerlink" href="#fixate-0" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;fixate0_nf-80_(2023_04_28,22:46)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a318d83f084e6baf2afa9b4d323f67561e5a475016791d72ea5c027608af267f.png" src="../../_images/a318d83f084e6baf2afa9b4d323f67561e5a475016791d72ea5c027608af267f.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.103415</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.195303</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.295576</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.282542</td>
      <td>NaN</td>
      <td>-2.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.355716</td>
      <td>NaN</td>
      <td>-2.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.125516</td>
      <td>0.941254</td>
      <td>-4.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>137</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.166465</td>
      <td>0.958395</td>
      <td>-10.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>138</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.119654</td>
      <td>0.846710</td>
      <td>5.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.296732</td>
      <td>0.930033</td>
      <td>1.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>140</th>
      <td>fixate0</td>
      <td>80</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.514065</td>
      <td>0.946823</td>
      <td>2.0</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="terrain-2">
<h2>Terrain 2<a class="headerlink" href="#terrain-2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;terrain2_nf-420_(2023_04_28,15:15)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f35d11d6e569fd04d44633ee2e9c6fa2df4ae3233d8e8b6ac212f6d4808f3ee9.png" src="../../_images/f35d11d6e569fd04d44633ee2e9c6fa2df4ae3233d8e8b6ac212f6d4808f3ee9.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.126017</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.269970</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.355404</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.392256</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.517220</td>
      <td>NaN</td>
      <td>-10.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.527142</td>
      <td>0.941254</td>
      <td>5.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>137</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.256062</td>
      <td>0.958395</td>
      <td>-4.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>138</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.395757</td>
      <td>0.846710</td>
      <td>-10.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>139</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.583993</td>
      <td>0.930033</td>
      <td>-4.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>140</th>
      <td>terrain2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.366117</td>
      <td>0.946823</td>
      <td>-4.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="terrain-4">
<h2>Terrain 4<a class="headerlink" href="#terrain-4" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;terrain4_nf-420_(2023_04_28,14:08)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8709f2e23aca17ae1a8fbfa2669bafdbf5643476abeedf3ae5e89944ac893cfb.png" src="../../_images/8709f2e23aca17ae1a8fbfa2669bafdbf5643476abeedf3ae5e89944ac893cfb.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.101991</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.261541</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.342266</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.362755</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.496990</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.235852</td>
      <td>0.941254</td>
      <td>1.0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>137</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.343941</td>
      <td>0.958395</td>
      <td>-8.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>138</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.208465</td>
      <td>0.846710</td>
      <td>-8.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>139</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.302298</td>
      <td>0.930033</td>
      <td>14.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>140</th>
      <td>terrain4</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.304345</td>
      <td>0.946823</td>
      <td>5.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="fixate-2-local">
<h2>Fixate 2 (local)<a class="headerlink" href="#fixate-2-local" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;fixate2_nf-420_(2023_04_28,12:46)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2246fd3d572746dda176ed0645a53885929875913f302ca2cdea1bb916b05d62.png" src="../../_images/2246fd3d572746dda176ed0645a53885929875913f302ca2cdea1bb916b05d62.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.126174</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.284086</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.368924</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.392427</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.529386</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.293882</td>
      <td>0.941254</td>
      <td>-8.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>137</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.234650</td>
      <td>0.958395</td>
      <td>5.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>138</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.381015</td>
      <td>0.846710</td>
      <td>-10.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.558847</td>
      <td>0.930033</td>
      <td>-10.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>140</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.502257</td>
      <td>0.946823</td>
      <td>4.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="fixate-1">
<h2>Fixate 1<a class="headerlink" href="#fixate-1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;fixate1_nf-420_(2023_04_27,20:20)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eca9d03e47d7f66d307adfc0f55abb4093491a6feb899363e68a4baeacb998eb.png" src="../../_images/eca9d03e47d7f66d307adfc0f55abb4093491a6feb899363e68a4baeacb998eb.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.133941</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.285753</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.374930</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.405268</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.539773</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.347837</td>
      <td>0.941254</td>
      <td>-8.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>137</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.339210</td>
      <td>0.958395</td>
      <td>0.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>138</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.488304</td>
      <td>0.846710</td>
      <td>5.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.665234</td>
      <td>0.930033</td>
      <td>2.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>140</th>
      <td>fixate1</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.524965</td>
      <td>0.946823</td>
      <td>4.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="reservoir">
<h2>Reservoir<a class="headerlink" href="#reservoir" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;reservoir_nf-420_(2023_04_27,18:40)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/52f2a43100ba5cd7c230094d0c1f3b1d135a2d03e0c7b5509ae4602006d25f67.png" src="../../_images/52f2a43100ba5cd7c230094d0c1f3b1d135a2d03e0c7b5509ae4602006d25f67.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.131917</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.251354</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.323846</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.317135</td>
      <td>NaN</td>
      <td>-2.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.443366</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.349292</td>
      <td>0.941254</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>137</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.217899</td>
      <td>0.958395</td>
      <td>-8.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.378731</td>
      <td>0.846710</td>
      <td>-8.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>139</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.324245</td>
      <td>0.930033</td>
      <td>10.0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>140</th>
      <td>reservoir</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.440339</td>
      <td>0.946823</td>
      <td>2.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="terrain-1">
<h2>Terrain 1<a class="headerlink" href="#terrain-1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;terrain1_nf-210_(2023_04_27,12:50)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9ff3dbc34f5b68f8e58367566ac1a266b1b70feaa98d7a225630c56531a0a05e.png" src="../../_images/9ff3dbc34f5b68f8e58367566ac1a266b1b70feaa98d7a225630c56531a0a05e.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.122108</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.255892</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.345269</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.379949</td>
      <td>NaN</td>
      <td>-6.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.494393</td>
      <td>NaN</td>
      <td>-2.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.481060</td>
      <td>0.941254</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>137</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.397871</td>
      <td>0.958395</td>
      <td>5.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>138</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.357366</td>
      <td>0.846710</td>
      <td>3.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>139</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.557131</td>
      <td>0.930033</td>
      <td>5.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>140</th>
      <td>terrain1</td>
      <td>210</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.453233</td>
      <td>0.946823</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="transl-0">
<h2>Transl 0<a class="headerlink" href="#transl-0" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;transl0_nf-70_(2023_04_27,13:30)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d6d3d18eff973b65cba33469d44bb011fe9c4b7c66c0f2092e462a7b7ea69534.png" src="../../_images/d6d3d18eff973b65cba33469d44bb011fe9c4b7c66c0f2092e462a7b7ea69534.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.097910</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.182568</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.264290</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.242731</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.349288</td>
      <td>NaN</td>
      <td>-2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.243246</td>
      <td>0.941254</td>
      <td>5.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>137</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.275857</td>
      <td>0.958395</td>
      <td>8.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.246526</td>
      <td>0.846710</td>
      <td>6.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.523472</td>
      <td>0.930033</td>
      <td>4.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>140</th>
      <td>transl0</td>
      <td>70</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.381603</td>
      <td>0.946823</td>
      <td>6.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="fixate2">
<h2>Fixate2<a class="headerlink" href="#fixate2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;fixate2_nf-420_(2023_04_27,13:57)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/51f4c3ff377e123570f68795f6d54a9caeadb9f963481c4d96f4b8cb3b993109.png" src="../../_images/51f4c3ff377e123570f68795f6d54a9caeadb9f963481c4d96f4b8cb3b993109.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.123681</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.275163</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.366766</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.385418</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.527858</td>
      <td>NaN</td>
      <td>-10.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.248173</td>
      <td>0.941254</td>
      <td>-2.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>137</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.202553</td>
      <td>0.958395</td>
      <td>-4.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>138</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.492103</td>
      <td>0.846710</td>
      <td>-2.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>139</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.501889</td>
      <td>0.930033</td>
      <td>-2.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>140</th>
      <td>fixate2</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.515691</td>
      <td>0.946823</td>
      <td>5.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="terrain-8">
<h2>Terrain 8<a class="headerlink" href="#terrain-8" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;terrain8_nf-420_(2023_04_26,22:51)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4bfc79ba82f4b34dc47ae93c99b2e8c58aa5cb658b9b40e4dd40c25a70b9e970.png" src="../../_images/4bfc79ba82f4b34dc47ae93c99b2e8c58aa5cb658b9b40e4dd40c25a70b9e970.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.132376</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.263272</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.365046</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.390277</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.524664</td>
      <td>NaN</td>
      <td>-2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.382596</td>
      <td>0.941254</td>
      <td>-4.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.237910</td>
      <td>0.958395</td>
      <td>8.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.416113</td>
      <td>0.846710</td>
      <td>6.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.581004</td>
      <td>0.930033</td>
      <td>-10.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>140</th>
      <td>terrain8</td>
      <td>420</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.483837</td>
      <td>0.946823</td>
      <td>6.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="note-older-stuff-below">
<h2>Note: older stuff below<a class="headerlink" href="#note-older-stuff-below" title="Permalink to this headline">#</a></h2>
</section>
<hr class="docutils" />
<section id="fixate-1-ema">
<h2>Fixate 1, EMA<a class="headerlink" href="#fixate-1-ema" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;EMA_fixate1_nf-2752_(2023_04_25,23:24)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a07c70fd388541d800b8e3ac3ffb6c4a5b7c5c99b8c396c784eb7dffa4df684c.png" src="../../_images/a07c70fd388541d800b8e3ac3ffb6c4a5b7c5c99b8c396c784eb7dffa4df684c.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.134035</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.286510</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.374805</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.405224</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.539948</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.349733</td>
      <td>0.941254</td>
      <td>-6.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>137</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.352120</td>
      <td>0.958395</td>
      <td>-2.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>138</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.482231</td>
      <td>0.846710</td>
      <td>5.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.662430</td>
      <td>0.930033</td>
      <td>2.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>140</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.522654</td>
      <td>0.946823</td>
      <td>4.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="id1">
<h2>Fixate 1<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;fixate1_nf-2752_(2023_04_25,19:34)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eca9d03e47d7f66d307adfc0f55abb4093491a6feb899363e68a4baeacb998eb.png" src="../../_images/eca9d03e47d7f66d307adfc0f55abb4093491a6feb899363e68a4baeacb998eb.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.133941</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.285753</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.374930</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.405268</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.539773</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.347837</td>
      <td>0.941254</td>
      <td>-8.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>137</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.339210</td>
      <td>0.958395</td>
      <td>0.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>138</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.488304</td>
      <td>0.846710</td>
      <td>5.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.665234</td>
      <td>0.930033</td>
      <td>2.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>140</th>
      <td>fixate1</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.524965</td>
      <td>0.946823</td>
      <td>4.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="apply-mask-bug-fixed-res">
<h2>Apply mask (bug fixed; Res)<a class="headerlink" href="#apply-mask-bug-fixed-res" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;reservoir_nf-2752_(2023_04_25,21:07)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/52f2a43100ba5cd7c230094d0c1f3b1d135a2d03e0c7b5509ae4602006d25f67.png" src="../../_images/52f2a43100ba5cd7c230094d0c1f3b1d135a2d03e0c7b5509ae4602006d25f67.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.131917</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.251354</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.323846</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.317135</td>
      <td>NaN</td>
      <td>-2.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.443366</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.349292</td>
      <td>0.941254</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>137</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.217899</td>
      <td>0.958395</td>
      <td>-8.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.378731</td>
      <td>0.846710</td>
      <td>-8.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>139</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.324245</td>
      <td>0.930033</td>
      <td>10.0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>140</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.440339</td>
      <td>0.946823</td>
      <td>2.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="apply-mask-not-res">
<h2>Apply Mask Not (Res)<a class="headerlink" href="#apply-mask-not-res" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;ApplyMaskNot_reservoir_nf-2752_(2023_04_24,21:10)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_neural_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">show_neural_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9aa34c3d2b852074f23ae3cf4353dd2f394d1e0052e1df18dc853979054d5a13.png" src="../../_images/9aa34c3d2b852074f23ae3cf4353dd2f394d1e0052e1df18dc853979054d5a13.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>nf</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>max_perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.121150</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.185795</td>
      <td>NaN</td>
      <td>-10.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.259854</td>
      <td>NaN</td>
      <td>-10.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.262318</td>
      <td>NaN</td>
      <td>-10.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.405829</td>
      <td>NaN</td>
      <td>-10.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.474153</td>
      <td>0.941254</td>
      <td>-6.0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>137</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.460349</td>
      <td>0.958395</td>
      <td>-10.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>138</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.578292</td>
      <td>0.846710</td>
      <td>2.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.680606</td>
      <td>0.930033</td>
      <td>-10.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>140</th>
      <td>reservoir</td>
      <td>2752</td>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.521322</td>
      <td>0.946823</td>
      <td>2.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="fit-to-latents-reservoir">
<h2>Fit to latents (Reservoir)<a class="headerlink" href="#fit-to-latents-reservoir" title="Permalink to this headline">#</a></h2>
<section id="lags-12-res">
<h3>Lags 12 (res)<a class="headerlink" href="#lags-12-res" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;Lags12_reservoir_nf-2752_(2023_04_24,10:14)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/05c62f1d8e637943bfe56fbf4aae746974a340e10b6d24dd0b8635c74e08c9c9.png" src="../../_images/05c62f1d8e637943bfe56fbf4aae746974a340e10b6d24dd0b8635c74e08c9c9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;best_lag&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;top_lag&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
<span class="n">delta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        1,  2,  1,  0,  0,  1,  1,  1,  2,  1,  1,  4,  0,  2,  4,  1,  1,
        1,  0,  0,  0,  0,  0, 10,  0,  0,  1,  4,  1,  2,  5,  1,  2,  0,
        1,  3,  1,  0,  2,  1,  3,  2,  0,  4,  0,  0,  8,  1,  1,  1,  0,
        2,  2,  2,  8,  0,  1,  3,  1,  2,  2,  4,  8,  2,  2,  0,  0,  4,
        5,  2, 12,  2,  0,  0,  1,  1,  3,  2,  2, 12,  1,  1,  7,  1,  3,
        1, 11, 12,  0,  1,  2,  1,  1,  5,  1,  3,  6,  1,  0,  6,  0,  4,
        2,  6,  5,  3,  2,  0,  7,  7,  1,  2,  2, 10, 12,  0,  1,  0, 11,
        5,  7, 10,  2,  1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.3333333333333335
</pre></div>
</div>
</div>
</div>
</section>
<section id="reservoir-loop-lags-incorrect-name-it-was-10-lags">
<h3>Reservoir (loop lags)(incorrect name: it was 10 lags)<a class="headerlink" href="#reservoir-loop-lags-incorrect-name-it-was-10-lags" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;FitZ6lags_reservoir_nf-2752_(2023_04_23,23:12)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6013521816e27f4e32fa14c0de41f9e6cae23b5bb1894f66d4ac90b421c683b2.png" src="../../_images/6013521816e27f4e32fa14c0de41f9e6cae23b5bb1894f66d4ac90b421c683b2.png" />
</div>
</div>
</section>
<section id="reservoir-no-lags-loop">
<h3>Reservoir (no lags loop)<a class="headerlink" href="#reservoir-no-lags-loop" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;FitZ6lags_reservoir_nf-2752_(2023_04_23,22:43)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b03b2f37a0322c139e694caf1fc53e14dc43a2a052df059616ded906e5262e2d.png" src="../../_images/b03b2f37a0322c139e694caf1fc53e14dc43a2a052df059616ded906e5262e2d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>141
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitted-vae-fixate1-only-top-lag">
<h3>Fitted VAE fixate1 (only top lag)<a class="headerlink" href="#fitted-vae-fixate1-only-top-lag" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;FitZ6lags_fixate1_nf-2752_(2023_04_23,22:18)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3e365642875c1856c844775a007ac7044466c9d346641d364c724baf68558bc8.png" src="../../_images/3e365642875c1856c844775a007ac7044466c9d346641d364c724baf68558bc8.png" />
</div>
</div>
</section>
<section id="fitted-vae-fixate1">
<h3>Fitted VAE (fixate1)<a class="headerlink" href="#fitted-vae-fixate1" title="Permalink to this headline">#</a></h3>
<p>Here there was a loop over lags, that’s why best lag and top lags are different</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;Fit2Latents_fixate1_nf-2752_(2023_04_23,21:19)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/02c42da2a7da3a4a165b50a827c997e2972b51c9543dad561ec479abe9d92294.png" src="../../_images/02c42da2a7da3a4a165b50a827c997e2972b51c9543dad561ec479abe9d92294.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>log_alpha</th>
      <th>best_lag</th>
      <th>top_lag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.129674</td>
      <td>4.0</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.279581</td>
      <td>4.0</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.360959</td>
      <td>-2.0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.394657</td>
      <td>-2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.530708</td>
      <td>2.0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.219541</td>
      <td>15.0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>137</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.111684</td>
      <td>15.0</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>138</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.475832</td>
      <td>2.0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.573677</td>
      <td>15.0</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>140</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.405689</td>
      <td>-2.0</td>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 7 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="fixate1-blue-being-trained">
<h2>Fixate1 (blue, being trained)<a class="headerlink" href="#fixate1-blue-being-trained" title="Permalink to this headline">#</a></h2>
<section id="new-paradigm-scale-2-no-act-fn-avg-pool-loop-lags">
<h3>New paradigm: scale=2, no act fn, avg pool, loop lags<a class="headerlink" href="#new-paradigm-scale-2-no-act-fn-avg-pool-loop-lags" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;LoopLags_reservoir_nf-2752_(2023_04_23,09:43)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9c79b03becd319894cc292cb91fbd49cacbde1123bc3f0a5d2b6b8e8c864b28e.png" src="../../_images/9c79b03becd319894cc292cb91fbd49cacbde1123bc3f0a5d2b6b8e8c864b28e.png" />
</div>
</div>
</section>
<section id="todo-study-behavior-of-log-a-20-maybe-don-t-need-to-that-far">
<h3>TODO: study behavior of log_a = -20, maybe don’t need to that far<a class="headerlink" href="#todo-study-behavior-of-log-a-20-maybe-don-t-need-to-that-far" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ro</span> <span class="ow">in</span> <span class="n">ro_all</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">ro</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp_stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">temporal</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1cdc94f71af1b2b3f7d4530a35fc885df336bc5fa68b2845d343ca3d3d603719.png" src="../../_images/1cdc94f71af1b2b3f7d4530a35fc885df336bc5fa68b2845d343ca3d3d603719.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">expt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;ytu029&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a035bf4e0973cb0597f202b9bf908a31a1105bca806a1678e17ba08c56efffd9.png" src="../../_images/a035bf4e0973cb0597f202b9bf908a31a1105bca806a1678e17ba08c56efffd9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">temporal</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fafe90a52e0&gt;]
</pre></div>
</div>
<img alt="../../_images/ce108c8a5e0abad6e2abbefd6c74dcf4cc6c3cb60ea9593f9fb5fac0ab238a7a.png" src="../../_images/ce108c8a5e0abad6e2abbefd6c74dcf4cc6c3cb60ea9593f9fb5fac0ab238a7a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.3330163762165965, 0.5035951135110508)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>r</th>
      <th>nnll</th>
      <th>r_tst</th>
      <th>r2_tst</th>
    </tr>
    <tr>
      <th>alpha</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.000000e-20</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-19</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-18</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-17</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-16</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-15</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-14</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-09</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-08</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-07</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-06</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625162</td>
    </tr>
    <tr>
      <th>1.000000e-05</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.625131</td>
    </tr>
    <tr>
      <th>1.000000e-04</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.624797</td>
    </tr>
    <tr>
      <th>1.000000e-03</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.621875</td>
    </tr>
    <tr>
      <th>1.000000e-02</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157357</td>
      <td>-713.592049</td>
    </tr>
    <tr>
      <th>1.000000e-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157355</td>
      <td>-713.295463</td>
    </tr>
    <tr>
      <th>1.000000e+00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157333</td>
      <td>-710.351062</td>
    </tr>
    <tr>
      <th>1.000000e+01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.157063</td>
      <td>-682.964583</td>
    </tr>
    <tr>
      <th>1.000000e+02</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.151512</td>
      <td>-518.160324</td>
    </tr>
    <tr>
      <th>1.000000e+03</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.085299</td>
      <td>-222.602259</td>
    </tr>
    <tr>
      <th>1.000000e+04</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.040931</td>
      <td>-90.700663</td>
    </tr>
    <tr>
      <th>1.000000e+05</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.135172</td>
      <td>-18.794910</td>
    </tr>
    <tr>
      <th>1.000000e+06</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.265073</td>
      <td>6.798990</td>
    </tr>
    <tr>
      <th>1.000000e+07</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.322936</td>
      <td>3.059649</td>
    </tr>
    <tr>
      <th>1.000000e+08</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.331622</td>
      <td>-1.810795</td>
    </tr>
    <tr>
      <th>1.000000e+09</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.332546</td>
      <td>-2.770189</td>
    </tr>
    <tr>
      <th>1.000000e+10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.332612</td>
      <td>-2.875205</td>
    </tr>
    <tr>
      <th>1.000000e+11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.333016</td>
      <td>-2.885803</td>
    </tr>
    <tr>
      <th>1.000000e+12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.331572</td>
      <td>-2.886865</td>
    </tr>
    <tr>
      <th>1.000000e+13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.186725</td>
      <td>-2.886977</td>
    </tr>
    <tr>
      <th>1.000000e+14</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.886984</td>
    </tr>
    <tr>
      <th>1.000000e+15</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.886984</td>
    </tr>
    <tr>
      <th>1.000000e+16</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.886984</td>
    </tr>
    <tr>
      <th>1.000000e+17</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.886984</td>
    </tr>
    <tr>
      <th>1.000000e+18</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.886984</td>
    </tr>
    <tr>
      <th>1.000000e+19</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.886984</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">temporal</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dt2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">temporal</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7f345ff0b7591101025260cdcda96ff6cec7396031568786f244deccb5210f7b.png" src="../../_images/7f345ff0b7591101025260cdcda96ff6cec7396031568786f244deccb5210f7b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">temporal</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dt1</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dt2</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">add_grid</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e2de05e77dfc0e5517918f792f67f39a3a60a7a20d94a776c9e9a9d671f8be3d.png" src="../../_images/e2de05e77dfc0e5517918f792f67f39a3a60a7a20d94a776c9e9a9d671f8be3d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">dt1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">best_lags</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">temporal</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">n_lags</span> <span class="o">-</span> <span class="n">ro</span><span class="o">.</span><span class="n">best_lags</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">t</span> <span class="o">&lt;</span> <span class="n">ro</span><span class="o">.</span><span class="n">n_lags</span> <span class="ow">and</span>
        <span class="n">dt1</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt1</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cond</span><span class="p">:</span>
        <span class="n">ro</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/629686e3619c2c6d38119c1c46d4557c99edb56e59b388d1794d8b05d28a5662.png" src="../../_images/629686e3619c2c6d38119c1c46d4557c99edb56e59b388d1794d8b05d28a5662.png" />
<img alt="../../_images/c87893521e93987c5df82284ce4501a3bd9ef9022f628f7a1c830caa4609fd68.png" src="../../_images/c87893521e93987c5df82284ce4501a3bd9ef9022f628f7a1c830caa4609fd68.png" />
<img alt="../../_images/70c12feefe51bc807406274a1278a33dc062554c97921d47a0b1de32ee7c9544.png" src="../../_images/70c12feefe51bc807406274a1278a33dc062554c97921d47a0b1de32ee7c9544.png" />
<img alt="../../_images/0acc485ef2849209e8a9b1ff9d0ef813521e558a96467ed3382d784995518e84.png" src="../../_images/0acc485ef2849209e8a9b1ff9d0ef813521e558a96467ed3382d784995518e84.png" />
<img alt="../../_images/73b2eeba1ec9568e562008c7e2188802aa6aede47348793eb3017c1af5b29f6f.png" src="../../_images/73b2eeba1ec9568e562008c7e2188802aa6aede47348793eb3017c1af5b29f6f.png" />
<img alt="../../_images/a1c6bd4550b29a164a3aaa391aa64b6693a06e758d499e87e8faa19ccdb34f59.png" src="../../_images/a1c6bd4550b29a164a3aaa391aa64b6693a06e758d499e87e8faa19ccdb34f59.png" />
<img alt="../../_images/df01f2fd10f5f56ef39c46c73d38cd7936b62079e141b4257b66ab141d9ce4a5.png" src="../../_images/df01f2fd10f5f56ef39c46c73d38cd7936b62079e141b4257b66ab141d9ce4a5.png" />
<img alt="../../_images/0e7f82a03f2ea1c7bf1899fef0dcb95e1f1c3555cf191298a7d6444fc12bfa98.png" src="../../_images/0e7f82a03f2ea1c7bf1899fef0dcb95e1f1c3555cf191298a7d6444fc12bfa98.png" />
<img alt="../../_images/76e52981c1b3103ed5dff8aa87b5f94055cd8fdc5eee1a23c848f79d76aba473.png" src="../../_images/76e52981c1b3103ed5dff8aa87b5f94055cd8fdc5eee1a23c848f79d76aba473.png" />
<img alt="../../_images/7ecd84d19600c1ffa1718705984b95153c6c015cb97854763751f43cb78aee45.png" src="../../_images/7ecd84d19600c1ffa1718705984b95153c6c015cb97854763751f43cb78aee45.png" />
<img alt="../../_images/caa1bc81b8721297d789ecdaca5de83395ed023b762d65a782ec8a08e57f7c96.png" src="../../_images/caa1bc81b8721297d789ecdaca5de83395ed023b762d65a782ec8a08e57f7c96.png" />
<img alt="../../_images/b66abcff8caaf22ea1844b525547ee25d4415a6fff821f90f1b75b553212e1a1.png" src="../../_images/b66abcff8caaf22ea1844b525547ee25d4415a6fff821f90f1b75b553212e1a1.png" />
<img alt="../../_images/26c0eda00cf2f5377e041667e57e52ae667e0e5b426a40c389ceae46249f7571.png" src="../../_images/26c0eda00cf2f5377e041667e57e52ae667e0e5b426a40c389ceae46249f7571.png" />
<img alt="../../_images/141a5f499650bfe56b2e6890921fdf7165ea24c54e4f169f40db081436535603.png" src="../../_images/141a5f499650bfe56b2e6890921fdf7165ea24c54e4f169f40db081436535603.png" />
<img alt="../../_images/2455a8e733b4b14d6c9de35ed28108ba6fdf295dad2ed85da2f06e67bb7719ae.png" src="../../_images/2455a8e733b4b14d6c9de35ed28108ba6fdf295dad2ed85da2f06e67bb7719ae.png" />
<img alt="../../_images/b21e5f0f2288d101669f433788549b572b58af01b671b3196d555074f39f3936.png" src="../../_images/b21e5f0f2288d101669f433788549b572b58af01b671b3196d555074f39f3936.png" />
</div>
</div>
</section>
<section id="no-normalize">
<h3>No Normalize<a class="headerlink" href="#no-normalize" title="Permalink to this headline">#</a></h3>
<p>(before pca, that is)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;NoNorm_reservoir_nf-2752_(2023_04_22,22:42)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/822aeb9a842580e94ae34db205980ddfd42f8b6644ec16d79bd6e0cb5d2feb7d.png" src="../../_images/822aeb9a842580e94ae34db205980ddfd42f8b6644ec16d79bd6e0cb5d2feb7d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>log_alpha</th>
      <th>pix_ranks</th>
      <th>pix_counts</th>
      <th>lags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.139155</td>
      <td>1.0</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.280470</td>
      <td>-1.0</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.352477</td>
      <td>-1.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.368143</td>
      <td>-1.0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.494264</td>
      <td>-2.0</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>19</td>
      <td>0.412536</td>
      <td>0.0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>20</td>
      <td>0.268113</td>
      <td>10.0</td>
      <td>0</td>
      <td>7</td>
      <td>5</td>
    </tr>
    <tr>
      <th>138</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>21</td>
      <td>0.397543</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>139</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>22</td>
      <td>0.536426</td>
      <td>0.0</td>
      <td>6</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>140</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>23</td>
      <td>0.553620</td>
      <td>1.0</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>141 rows × 8 columns</p>
</div></div></div>
</div>
</section>
<section id="res-50-pcs">
<h3>Res + 50 PCs<a class="headerlink" href="#res-50-pcs" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;50PCs_reservoir_nf-2752_(2023_04_22,20:25)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/abaf9e3a7c3a52ccd26235454a1e45d9d5c2bdbc996187038caa2114ed4690b2.png" src="../../_images/abaf9e3a7c3a52ccd26235454a1e45d9d5c2bdbc996187038caa2114ed4690b2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">mu</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ro_all</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">sd</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ro_all</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9b5a65ab8b631b3a887419e0cf30eeae8b0df85d769f7ed8d472b8dc649b0d82.png" src="../../_images/9b5a65ab8b631b3a887419e0cf30eeae8b0df85d769f7ed8d472b8dc649b0d82.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">mu</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ro_all</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">sd</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ro_all</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\sigma$&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2293bc90415b3bef804083d2e3188a99f344023588fa9d80d457acde81591b77.png" src="../../_images/2293bc90415b3bef804083d2e3188a99f344023588fa9d80d457acde81591b77.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;log_alpha&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>log_alpha</th>
      <th>pix_ranks</th>
      <th>pix_counts</th>
      <th>lags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>YUWEI</td>
      <td>clu104</td>
      <td>0</td>
      <td>0.840678</td>
      <td>-15.0</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>29</th>
      <td>YUWEI</td>
      <td>clu120</td>
      <td>0</td>
      <td>0.837180</td>
      <td>-15.0</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>33</th>
      <td>YUWEI</td>
      <td>clu142</td>
      <td>0</td>
      <td>0.770100</td>
      <td>-15.0</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>39</th>
      <td>YUWEI</td>
      <td>clu181</td>
      <td>0</td>
      <td>0.741743</td>
      <td>-15.0</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>49</th>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>1</td>
      <td>0.853204</td>
      <td>-15.0</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>50</th>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>2</td>
      <td>0.855954</td>
      <td>-15.0</td>
      <td>7</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>51</th>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.905697</td>
      <td>-15.0</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>57</th>
      <td>YUWEI</td>
      <td>clu223</td>
      <td>10</td>
      <td>0.278625</td>
      <td>-15.0</td>
      <td>4</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>62</th>
      <td>YUWEI</td>
      <td>clu226</td>
      <td>0</td>
      <td>0.666988</td>
      <td>-15.0</td>
      <td>0</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>65</th>
      <td>YUWEI</td>
      <td>clu229</td>
      <td>6</td>
      <td>0.572514</td>
      <td>-15.0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>69</th>
      <td>YUWEI</td>
      <td>clu267</td>
      <td>4</td>
      <td>0.808381</td>
      <td>-15.0</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>74</th>
      <td>YUWEI</td>
      <td>clu267</td>
      <td>9</td>
      <td>0.432969</td>
      <td>-15.0</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>78</th>
      <td>YUWEI</td>
      <td>clu267</td>
      <td>14</td>
      <td>0.612785</td>
      <td>-15.0</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>81</th>
      <td>YUWEI</td>
      <td>clu292</td>
      <td>6</td>
      <td>0.539289</td>
      <td>-15.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>89</th>
      <td>YUWEI</td>
      <td>clu293</td>
      <td>5</td>
      <td>0.493639</td>
      <td>-15.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>94</th>
      <td>YUWEI</td>
      <td>clu293</td>
      <td>10</td>
      <td>0.435627</td>
      <td>-15.0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>111</th>
      <td>YUWEI</td>
      <td>clu295</td>
      <td>8</td>
      <td>0.736592</td>
      <td>-15.0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>113</th>
      <td>YUWEI</td>
      <td>clu295</td>
      <td>11</td>
      <td>0.485577</td>
      <td>-15.0</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>117</th>
      <td>YUWEI</td>
      <td>ytu028</td>
      <td>4</td>
      <td>0.715278</td>
      <td>-15.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>125</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>5</td>
      <td>0.572048</td>
      <td>-15.0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>133</th>
      <td>YUWEI</td>
      <td>ytu029</td>
      <td>16</td>
      <td>0.326452</td>
      <td>-15.0</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> 
    <span class="p">(</span><span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;expt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;clu221&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>alpha</th>
      <th>r</th>
      <th>nnll</th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>r_tst</th>
      <th>r2_tst</th>
      <th>max_r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>765</th>
      <td>0</td>
      <td>1.000000e-15</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.815896</td>
      <td>64.296194</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>766</th>
      <td>1</td>
      <td>1.000000e-10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.815896</td>
      <td>64.296194</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>767</th>
      <td>2</td>
      <td>1.000000e-04</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.815896</td>
      <td>64.296194</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>768</th>
      <td>3</td>
      <td>1.000000e-02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.815896</td>
      <td>64.296193</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>769</th>
      <td>4</td>
      <td>1.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.815895</td>
      <td>64.295969</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>770</th>
      <td>5</td>
      <td>1.000000e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.815885</td>
      <td>64.293950</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>771</th>
      <td>6</td>
      <td>1.000000e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.815780</td>
      <td>64.273764</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>772</th>
      <td>7</td>
      <td>1.000000e+03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.814762</td>
      <td>64.073128</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>773</th>
      <td>8</td>
      <td>1.000000e+04</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.806661</td>
      <td>62.294082</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>774</th>
      <td>9</td>
      <td>1.000000e+05</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.779809</td>
      <td>53.661318</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>775</th>
      <td>10</td>
      <td>1.000000e+06</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.743383</td>
      <td>29.013409</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>776</th>
      <td>11</td>
      <td>1.000000e+07</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.730582</td>
      <td>1.176097</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>777</th>
      <td>12</td>
      <td>1.000000e+10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.730633</td>
      <td>-7.914492</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>778</th>
      <td>13</td>
      <td>1.000000e+12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>0.727179</td>
      <td>-7.925951</td>
      <td>0.900849</td>
    </tr>
    <tr>
      <th>779</th>
      <td>14</td>
      <td>1.000000e+15</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>YUWEI</td>
      <td>clu221</td>
      <td>3</td>
      <td>NaN</td>
      <td>-7.926067</td>
      <td>0.900849</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="reservoir-version">
<h3>Reservoir version<a class="headerlink" href="#reservoir-version" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;reservoir_nf-2752_(2023_04_22,16:34)&#39;</span>
<span class="n">df</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">ro_all</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">summarize_readout_fits</span><span class="p">(</span><span class="n">fit_name</span><span class="p">)</span>

<span class="n">show_readout_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d9a5145bf69e40252d265ddb51e752954865e0b0bfce3298c87dc22bea8029f4.png" src="../../_images/d9a5145bf69e40252d265ddb51e752954865e0b0bfce3298c87dc22bea8029f4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>root</th>
      <th>expt</th>
      <th>cell</th>
      <th>perf</th>
      <th>log_alpha</th>
      <th>pix_ranks</th>
      <th>pix_counts</th>
      <th>lags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>YUWEI</td>
      <td>clu036</td>
      <td>0</td>
      <td>0.138983</td>
      <td>3.0</td>
      <td>7</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>YUWEI</td>
      <td>clu037</td>
      <td>0</td>
      <td>0.281033</td>
      <td>1.0</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>YUWEI</td>
      <td>clu038</td>
      <td>0</td>
      <td>0.352344</td>
      <td>1.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>YUWEI</td>
      <td>clu039</td>
      <td>0</td>
      <td>0.368468</td>
      <td>1.0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>YUWEI</td>
      <td>clu040</td>
      <td>0</td>
      <td>0.494499</td>
      <td>0.0</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>YUWEI</td>
      <td>clu043</td>
      <td>0</td>
      <td>0.368548</td>
      <td>1.0</td>
      <td>7</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>YUWEI</td>
      <td>clu044</td>
      <td>0</td>
      <td>0.365008</td>
      <td>1.0</td>
      <td>0</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>YUWEI</td>
      <td>clu053</td>
      <td>0</td>
      <td>0.504210</td>
      <td>2.0</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>YUWEI</td>
      <td>clu055</td>
      <td>0</td>
      <td>0.423810</td>
      <td>1.0</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>YUWEI</td>
      <td>clu059</td>
      <td>0</td>
      <td>0.633931</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="trained-vae-version">
<h3>Trained VAE version<a class="headerlink" href="#trained-vae-version" title="Permalink to this headline">#</a></h3>
<p>TODO</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>inf
</pre></div>
</div>
</div>
</div>
</section>
<section id="trainer-evaluation">
<h3>Trainer evaluation<a class="headerlink" href="#trainer-evaluation" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_norms</span> <span class="o">=</span> <span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">all_lognorm</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">all_norms</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">101</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f8c45ed6658e340ff5c7f1204b70547007f033b59ad070eade5a8e1c3172e9b5.png" src="../../_images/f8c45ed6658e340ff5c7f1204b70547007f033b59ad070eade5a8e1c3172e9b5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grads</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">grads</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">grads</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fe6189f52f5de2e5cb0c0f7607960543613568881a8396c9e3dca894c80f03cc.png" src="../../_images/fe6189f52f5de2e5cb0c0f7607960543613568881a8396c9e3dca894c80f03cc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">grad_clip</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">bad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">grads</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">([</span><span class="s1">&#39;Threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;%&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">thres</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
    <span class="n">tot</span> <span class="o">=</span> <span class="p">(</span><span class="n">bad</span> <span class="o">&gt;</span> <span class="n">thres</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">tot</span> <span class="o">/</span> <span class="mi">70000</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">perc</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">thres</span><span class="p">),</span> <span class="n">tot</span><span class="p">,</span> <span class="n">perc</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+-----------+-----+-------+
| Threshold |  #  |   %   |
+-----------+-----+-------+
|    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>    | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">511</span> |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.73</span> |
|    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">800</span>    |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.043</span> |
|    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2000</span>   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.034</span> |
|    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4000</span>   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.031</span> |
|    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8000</span>   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.026</span> |
|   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20000</span>   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.021</span> |
|   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40000</span>   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span> |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span> |
|   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80000</span>   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.017</span> |
+-----------+-----+-------+ 

</pre>
</div></div>
</div>
</section>
</section>
<section id="load">
<h2>Load<a class="headerlink" href="#load" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">base.utils_model</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="n">tr</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;fixate1_k-32_z-13x[3,6,12]_enc(1x3)-dec(1x2)-pre(1x3)-post(1x3)&#39;</span><span class="p">,</span>
    <span class="n">fit_name</span><span class="o">=</span><span class="s1">&#39;ep200-b500-lr(0.002)_beta(0.1:0x0.3)_lamb(0.001)_gr(400.0)_(2023_04_18,16:48)&#39;</span><span class="p">,</span>
    <span class="n">checkpoint</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span>
    <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;checkpoint&#39;: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;checkpoint&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'checkpoint'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>defaultdict(dict,
            {&#39;grad&#39;: {0: 620.02783203125,
              1: 548.1597900390625,
              2: 574.1665649414062,
              3: 528.7373046875,
              4: 552.8775634765625,
              5: 490.29827880859375,
              6: 512.96923828125,
              7: 548.6211547851562,
              8: 548.2747192382812,
              9: 560.6716918945312,
              10: 552.1534423828125,
              11: 624.803466796875,
              12: 539.2872314453125,
              13: 614.0498657226562,
              14: 528.2135009765625,
              15: 539.8253173828125,
              16: 613.2606811523438,
              17: 530.2435913085938,
              18: 596.0543212890625,
              19: 547.4933471679688,
              20: 508.1014404296875,
              21: 502.63934326171875,
              22: 533.7025146484375,
              23: 511.7557373046875,
              24: 465.74310302734375,
              25: 474.46978759765625,
              26: 466.5031433105469,
              27: 481.94671630859375,
              29: 464.0534973144531,
              30: 521.7659912109375,
              31: 491.81610107421875,
              32: 412.4526062011719,
              33: 510.6286926269531,
              35: 406.42919921875,
              418: 412.4786071777344,
              425: 467.1896667480469,
              525: 406.5228271484375,
              528: 429.5543212890625,
              531: 407.3088073730469,
              532: 495.4371643066406,
              534: 408.1133728027344,
              537: 430.1729736328125,
              538: 417.23419189453125,
              578: 450.16925048828125,
              579: 485.412109375,
              581: 424.7698669433594,
              583: 458.37823486328125,
              585: 466.8449401855469,
              594: 405.90338134765625,
              596: 416.1627502441406,
              599: 454.188720703125,
              604: 417.3047180175781,
              607: 447.7807312011719,
              610: 501.8489685058594,
              612: 616.6571655273438,
              613: 436.5841369628906,
              614: 736.9529418945312,
              615: 671.489990234375,
              617: 754.9290771484375,
              618: 526.5949096679688,
              619: 408.8209228515625,
              620: 545.5906372070312,
              621: 425.17938232421875,
              623: 529.80615234375,
              624: 416.29266357421875,
              625: 507.8061218261719,
              626: 599.3812866210938,
              628: 422.4273681640625,
              629: 451.49859619140625,
              631: 478.4276123046875,
              633: 545.1566162109375,
              635: 681.5765991210938,
              636: 445.6784362792969,
              637: 476.6335754394531,
              638: 477.46783447265625,
              640: 523.8135375976562,
              641: 420.20037841796875,
              645: 437.8053894042969,
              647: 462.353759765625,
              655: 405.9515380859375,
              656: 412.21380615234375,
              657: 450.358154296875,
              662: 456.5515441894531,
              667: 428.8677978515625,
              668: 437.3229064941406,
              671: 405.72314453125,
              672: 546.3736572265625,
              674: 527.8206176757812,
              676: 604.0517578125,
              678: 603.2548217773438,
              679: 546.2044067382812,
              680: 572.4047241210938,
              681: 572.2543334960938,
              683: 562.7252807617188,
              685: 602.6480712890625,
              687: 633.24755859375,
              688: 531.3399047851562,
              689: 461.49578857421875,
              690: 563.3287963867188,
              691: 450.8050537109375,
              692: 442.9119873046875,
              693: 517.831298828125,
              694: 499.2591247558594,
              695: 531.48828125,
              696: 490.8894348144531,
              697: 490.04620361328125,
              698: 478.5777587890625,
              699: 487.057861328125,
              700: 466.31658935546875,
              701: 521.1748657226562,
              702: 462.5174255371094,
              704: 426.6910095214844,
              707: 510.2276611328125,
              709: 486.4438781738281,
              711: 449.2493591308594,
              714: 449.8832702636719,
              719: 430.205810546875,
              722: 402.2147521972656,
              746: 530.045166015625,
              750: 539.7456665039062,
              752: 453.5538330078125,
              753: 446.62335205078125,
              755: 582.033203125,
              757: 645.9746704101562,
              758: 753.0078735351562,
              759: 453.9517517089844,
              760: 464.219970703125,
              761: 577.3944702148438,
              762: 555.4077758789062,
              763: 602.8529663085938,
              764: 612.0303344726562,
              766: 472.17132568359375,
              767: 430.5453796386719,
              769: 651.4957885742188,
              770: 499.6688232421875,
              771: 721.5986328125,
              772: 591.564453125,
              774: 582.1559448242188,
              776: 566.4539794921875,
              778: 631.6332397460938,
              779: 542.16162109375,
              781: 431.6065979003906,
              782: 403.9322814941406,
              784: 485.4192810058594,
              786: 604.4041137695312,
              787: 446.9221496582031,
              788: 686.771484375,
              789: 691.6546020507812,
              791: 698.3086547851562,
              792: 721.4293823242188,
              793: 472.2770080566406,
              794: 684.30322265625,
              795: 815.9873046875,
              796: 631.7042236328125,
              798: 569.215087890625,
              800: 602.3964233398438,
              801: 584.0947265625,
              803: 518.181884765625,
              808: 433.5026550292969,
              810: 404.6087646484375,
              815: 466.63983154296875,
              817: 430.1673583984375,
              819: 409.330078125,
              822: 434.338134765625,
              826: 481.0442810058594,
              827: 418.309814453125,
              831: 460.0919189453125,
              833: 418.69110107421875,
              834: 631.535400390625,
              836: 693.8961791992188,
              837: 740.9227294921875,
              839: 672.8311157226562,
              840: 634.722900390625,
              841: 486.53179931640625,
              842: 566.8582763671875,
              843: 408.4042053222656,
              844: 596.4715576171875,
              845: 480.7647705078125,
              846: 544.2578735351562,
              847: 475.3231201171875,
              848: 463.8822326660156,
              849: 476.7474365234375,
              850: 528.1650390625,
              851: 455.965087890625,
              852: 468.31475830078125,
              853: 527.577880859375,
              854: 553.8427124023438,
              855: 466.7547302246094,
              856: 494.7469177246094,
              857: 524.373779296875,
              858: 528.1522216796875,
              859: 421.0151672363281,
              860: 517.8916625976562,
              861: 464.6602478027344,
              862: 470.4946594238281,
              863: 501.7563171386719,
              864: 488.93353271484375,
              865: 501.81146240234375,
              866: 577.8336181640625,
              867: 497.6832580566406,
              868: 557.3251342773438,
              869: 448.7093200683594,
              870: 486.0043640136719,
              871: 488.9683532714844,
              872: 631.512451171875,
              873: 456.0000305175781,
              874: 475.7032165527344,
              875: 456.92486572265625,
              876: 552.1812133789062,
              877: 537.89404296875,
              878: 441.3037109375,
              880: 442.9287414550781,
              882: 497.1324157714844,
              883: 460.44195556640625,
              884: 467.4173278808594,
              885: 446.6446533203125,
              886: 495.0917663574219,
              887: 465.9497985839844,
              888: 442.3171081542969,
              889: 441.72955322265625,
              890: 469.43115234375,
              891: 516.1448974609375,
              892: 493.7910461425781,
              893: 422.0355529785156,
              894: 590.7213134765625,
              895: 455.9676818847656,
              896: 447.9080505371094,
              897: 451.69097900390625,
              898: 503.99359130859375,
              899: 452.19256591796875,
              900: 510.0740661621094,
              901: 489.90533447265625,
              902: 485.2308044433594,
              903: 459.1723937988281,
              904: 436.8726806640625,
              906: 511.9890441894531,
              907: 541.9193115234375,
              908: 556.5020141601562,
              909: 629.4772338867188,
              911: 654.1768798828125,
              912: 623.7348022460938,
              914: 508.0528869628906,
              915: 527.0220947265625,
              917: 610.8357543945312,
              919: 649.1371459960938,
              920: 674.4185180664062,
              922: 589.7958374023438,
              923: 527.305419921875,
              924: 496.61773681640625,
              925: 558.81494140625,
              926: 456.4115905761719,
              927: 543.8225708007812,
              928: 569.525634765625,
              931: 491.70263671875,
              933: 486.97998046875,
              934: 431.5329284667969,
              935: 472.44818115234375,
              937: 516.956298828125,
              938: 407.9178771972656,
              939: 529.7109375,
              940: 592.760986328125,
              942: 515.5637817382812,
              944: 548.4598388671875,
              945: 540.7420654296875,
              947: 482.70697021484375,
              949: 513.6060180664062,
              950: 496.6763916015625,
              952: 434.27032470703125,
              954: 466.9788513183594,
              956: 599.1808471679688,
              957: 569.04345703125,
              959: 440.934326171875,
              960: 405.2994689941406,
              961: 507.1181640625,
              962: 416.6824951171875,
              963: 487.991455078125,
              965: 414.0658264160156,
              967: 482.8554382324219,
              968: 403.4299011230469,
              969: 442.1333312988281,
              970: 487.9237365722656,
              972: 405.323974609375,
              974: 445.7684631347656,
              982: 411.21435546875,
              991: 432.8869323730469,
              1014: 433.4830322265625,
              1018: 424.0348815917969,
              1036: 521.0672607421875,
              1038: 527.4116821289062,
              1039: 500.7166748046875,
              1040: 541.4349975585938,
              1041: 470.8985290527344,
              1046: 429.78863525390625,
              1056: 432.1480407714844,
              1062: 433.5635681152344,
              1064: 467.6231994628906,
              1082: 449.0110778808594,
              1094: 426.1650695800781,
              1097: 513.3099365234375,
              1099: 511.81329345703125,
              1106: 400.18829345703125,
              1122: 424.5744934082031,
              1138: 418.841064453125,
              1142: 574.3101196289062,
              1144: 590.0374145507812,
              1146: 526.0673217773438,
              1147: 441.4019470214844,
              1148: 639.4427490234375,
              1149: 588.42236328125,
              1151: 555.3084716796875,
              1153: 573.1742553710938,
              1154: 462.4231262207031,
              1155: 480.24755859375,
              1156: 485.995849609375,
              1157: 432.7004089355469,
              1159: 414.0794982910156,
              1161: 520.84228515625,
              1163: 445.55938720703125,
              1164: 405.0456848144531,
              1165: 494.92901611328125,
              1166: 514.6738891601562,
              1168: 432.1439208984375,
              1170: 445.82830810546875,
              1249: 428.1543273925781,
              1250: 457.40850830078125,
              1253: 413.414306640625,
              1265: 475.984619140625,
              1268: 542.4090576171875,
              1271: 521.8870849609375,
              1273: 630.7347412109375,
              1274: 445.2971496582031,
              1275: 583.6246337890625,
              1276: 625.8285522460938,
              1278: 458.35638427734375,
              1280: 431.2462463378906,
              1285: 420.46807861328125,
              1317: 408.9068908691406,
              1326: 416.4070739746094,
              1327: 434.2756042480469,
              1332: 469.7199401855469,
              1342: 433.8836975097656,
              1354: 449.3578796386719,
              1374: 420.41668701171875,
              1383: 453.68328857421875,
              1387: 492.7626647949219,
              1390: 413.77899169921875,
              1393: 465.21588134765625,
              1422: 441.9283447265625,
              1423: 432.3330383300781,
              1443: 441.4111022949219,
              1444: 456.1717529296875,
              1448: 456.4691162109375,
              1450: 552.0838012695312,
              1453: 449.3011169433594,
              1455: 546.6806030273438,
              1457: 503.1837463378906,
              1463: 445.52703857421875,
              1469: 415.0050964355469,
              1483: 433.84735107421875,
              1489: 427.78857421875,
              1492: 428.03131103515625,
              1494: 459.1254577636719,
              1497: 412.7463684082031,
              1515: 489.0108642578125,
              1518: 469.7513122558594,
              1520: 635.4965209960938,
              1522: 654.0623779296875,
              1523: 615.8074951171875,
              1525: 607.2947387695312,
              1527: 563.4262084960938,
              1528: 402.0660400390625,
              1529: 488.98760986328125,
              1530: 542.8130493164062,
              1533: 434.1062316894531,
              1535: 468.53619384765625,
              1537: 487.4652099609375,
              1538: 532.9771118164062,
              1539: 467.2921142578125,
              1540: 451.6025695800781,
              1541: 473.125244140625,
              1542: 490.06243896484375,
              1543: 547.213623046875,
              1544: 442.6475830078125,
              1545: 403.8310241699219,
              1546: 431.8149719238281,
              1547: 629.3883056640625,
              1548: 478.3756408691406,
              1549: 489.80426025390625,
              1550: 407.09820556640625,
              1551: 474.8214416503906,
              1553: 496.9604187011719,
              1554: 418.0364685058594,
              1555: 489.3256530761719,
              1556: 430.35235595703125,
              1557: 427.51629638671875,
              1559: 473.5697326660156,
              1560: 461.7955017089844,
              1561: 437.1260681152344,
              1562: 454.33819580078125,
              1563: 472.56103515625,
              1565: 460.5844421386719,
              1566: 415.4698486328125,
              1567: 440.7251892089844,
              1568: 462.732666015625,
              1571: 438.71453857421875,
              1573: 496.3886413574219,
              1574: 450.98138427734375,
              1575: 487.8868713378906,
              1576: 475.64141845703125,
              1581: 429.3198547363281,
              1583: 462.2405700683594,
              1672: 434.1766052246094,
              1678: 536.1737670898438,
              1680: 483.6749572753906,
              1683: 457.3200378417969,
              1685: 493.2535095214844,
              1687: 550.9641723632812,
              1689: 597.5574340820312,
              1691: 479.2986755371094,
              1693: 532.2586059570312,
              1695: 587.9791870117188,
              1697: 527.9800415039062,
              1698: 459.2013244628906,
              1699: 464.46710205078125,
              1700: 427.3724365234375,
              1701: 479.4708251953125,
              1702: 402.689697265625,
              1703: 407.17095947265625,
              1705: 420.33154296875,
              1707: 492.67071533203125,
              1708: 450.3953552246094,
              1709: 455.256103515625,
              1710: 442.0781555175781,
              1711: 418.635009765625,
              1713: 402.5719909667969,
              1715: 485.9892272949219,
              1716: 401.57073974609375,
              1717: 454.1852111816406,
              1718: 430.0661926269531,
              1719: 461.4501037597656,
              1720: 446.5407409667969,
              1721: 419.9358825683594,
              1723: 453.5538024902344,
              1724: 421.1991882324219,
              1725: 516.1234741210938,
              1726: 424.8346862792969,
              1729: 471.9108581542969,
              1731: 510.3330993652344,
              1732: 477.8536376953125,
              1737: 458.4761047363281,
              1739: 498.3027038574219,
              1740: 539.2392578125,
              1745: 430.8064880371094,
              1747: 421.7276611328125,
              1832: 421.51519775390625,
              1913: 427.5638427734375,
              1957: 408.5324401855469,
              1972: 453.7016296386719,
              1974: 421.6502685546875,
              2046: 429.1696472167969,
              2053: 424.8276062011719,
              2057: 413.1380920410156,
              2126: 442.99749755859375,
              2228: 457.256103515625,
              2388: 421.99676513671875,
              2391: 425.1793212890625,
              2393: 501.57476806640625,
              2396: 413.8235168457031,
              2398: 440.63348388671875,
              2400: 439.7841491699219,
              2627: 401.16473388671875,
              5497: 427.3570251464844,
              9412: 417.43707275390625,
              14010: 88342.8671875,
              14015: 3974.215087890625,
              14016: 836.0286865234375,
              20614: 16879.970703125,
              20636: 12768315.0,
              21679: 27305570304.0,
              23828: 2075083.25,
              23829: 66280.875,
              23830: 211452.515625,
              23831: 774.8525390625,
              23832: 3181.04443359375,
              23833: 150284.21875,
              23834: 685283.5625,
              23835: 6555.396484375,
              23836: 4328.01611328125,
              23837: 12354.2744140625,
              23838: 1832.028564453125,
              23839: 842.4379272460938,
              23840: 4939.24462890625,
              23841: 45842.89453125,
              23842: 1176963121152.0,
              23843: 211018.765625,
              23844: 33806.78515625,
              23845: 17689.513671875,
              23846: 269553504.0,
              23847: 4079.534423828125,
              23849: 1339.9932861328125,
              23850: 612.1824340820312,
              35462: 1441516.125,
              36795: 893102129152.0,
              70263: 624.3383178710938,
              73993: 411.2547302246094,
              77193: 461.0033874511719,
              77653: 482.7698669433594,
              78355: 605.413818359375,
              80669: 465.36810302734375,
              82650: 434.5764465332031,
              82905: 1010.745849609375},
             &#39;loss&#39;: {0: 66.43940734863281,
              1: 68.683349609375,
              2: 66.27693939208984,
              3: 68.09571075439453,
              4: 66.39925384521484,
              5: 68.78044891357422,
              6: 67.87169647216797,
              7: 65.02664947509766,
              8: 65.6878662109375,
              9: 66.91886901855469,
              10: 65.11341094970703,
              11: 65.14645385742188,
              12: 64.70951080322266,
              13: 64.78336334228516,
              14: 63.115806579589844,
              15: 67.29086303710938,
              16: 64.36587524414062,
              17: 65.6646499633789,
              18: 64.62400817871094,
              19: 65.15577697753906,
              20: 65.10894775390625,
              21: 65.76726531982422,
              22: 63.322662353515625,
              23: 61.534019470214844,
              24: 65.45858001708984,
              25: 67.38883209228516,
              26: 64.48780822753906,
              27: 63.35621643066406,
              29: 62.25107192993164,
              30: 63.09698486328125,
              31: 61.77977752685547,
              32: 62.595306396484375,
              33: 62.41463851928711,
              35: 60.06863021850586,
              418: 23.852819442749023,
              425: 22.994211196899414,
              525: 20.948305130004883,
              528: 20.318288803100586,
              531: 19.55428123474121,
              532: 20.429767608642578,
              534: 19.818153381347656,
              537: 20.60797119140625,
              538: 20.770557403564453,
              578: 19.973657608032227,
              579: 19.170345306396484,
              581: 19.769763946533203,
              583: 20.750730514526367,
              585: 19.378007888793945,
              594: 19.446163177490234,
              596: 20.253910064697266,
              599: 18.410249710083008,
              604: 20.1744384765625,
              607: 19.30522346496582,
              610: 19.215200424194336,
              612: 19.51170539855957,
              613: 18.926633834838867,
              614: 18.891860961914062,
              615: 21.11465072631836,
              617: 18.365188598632812,
              618: 18.81647300720215,
              619: 18.320117950439453,
              620: 18.003786087036133,
              621: 18.93015480041504,
              623: 19.843469619750977,
              624: 19.310779571533203,
              625: 18.3266658782959,
              626: 18.961774826049805,
              628: 18.017215728759766,
              629: 18.7248477935791,
              631: 18.624746322631836,
              633: 19.36381721496582,
              635: 18.32545280456543,
              636: 18.214025497436523,
              637: 19.449081420898438,
              638: 18.24555778503418,
              640: 18.516616821289062,
              641: 19.142656326293945,
              645: 18.68809700012207,
              647: 18.48904800415039,
              655: 18.317584991455078,
              656: 19.13686180114746,
              657: 18.659029006958008,
              662: 18.370929718017578,
              667: 19.323122024536133,
              668: 18.785114288330078,
              671: 18.550491333007812,
              672: 18.1307430267334,
              674: 17.22304344177246,
              676: 17.658266067504883,
              678: 19.796417236328125,
              679: 17.725305557250977,
              680: 19.42765235900879,
              681: 19.652034759521484,
              683: 19.44349479675293,
              685: 19.12050437927246,
              687: 18.312402725219727,
              688: 17.74811553955078,
              689: 19.357826232910156,
              690: 18.24771499633789,
              691: 18.16678237915039,
              692: 18.02645492553711,
              693: 18.61496925354004,
              694: 17.99544906616211,
              695: 17.939970016479492,
              696: 18.755216598510742,
              697: 18.229551315307617,
              698: 19.545621871948242,
              699: 17.68461799621582,
              700: 18.20522689819336,
              701: 18.114574432373047,
              702: 19.328874588012695,
              704: 17.404882431030273,
              707: 18.12982940673828,
              709: 17.480762481689453,
              711: 17.782434463500977,
              714: 18.383174896240234,
              719: 17.771299362182617,
              722: 18.334636688232422,
              746: 17.00667381286621,
              750: 17.313133239746094,
              752: 16.53127098083496,
              753: 17.119192123413086,
              755: 17.889394760131836,
              757: 18.097923278808594,
              758: 18.19993782043457,
              759: 17.84495735168457,
              760: 17.09543800354004,
              761: 17.393699645996094,
              762: 17.307064056396484,
              763: 18.776622772216797,
              764: 18.26516342163086,
              766: 16.027538299560547,
              767: 18.17693328857422,
              769: 17.6448974609375,
              770: 17.684677124023438,
              771: 16.98647689819336,
              772: 17.783527374267578,
              774: 17.78059196472168,
              776: 17.677894592285156,
              778: 17.661361694335938,
              779: 17.361452102661133,
              781: 16.904808044433594,
              782: 16.552961349487305,
              784: 16.84183692932129,
              786: 17.30185890197754,
              787: 17.302724838256836,
              788: 18.0990047454834,
              789: 18.290876388549805,
              791: 18.378828048706055,
              792: 18.601198196411133,
              793: 17.785247802734375,
              794: 19.330184936523438,
              795: 18.62097930908203,
              796: 17.594057083129883,
              798: 17.071941375732422,
              800: 17.627016067504883,
              801: 17.090192794799805,
              803: 17.301923751831055,
              808: 15.999266624450684,
              810: 17.520437240600586,
              815: 16.696197509765625,
              817: 17.561485290527344,
              819: 17.381418228149414,
              822: 16.290212631225586,
              826: 16.51424217224121,
              827: 15.955883026123047,
              831: 16.94132423400879,
              833: 16.230012893676758,
              834: 16.89845085144043,
              836: 18.735183715820312,
              837: 18.518245697021484,
              839: 17.357980728149414,
              840: 17.30302619934082,
              841: 16.471961975097656,
              842: 16.590591430664062,
              843: 17.543046951293945,
              844: 16.651023864746094,
              845: 16.759864807128906,
              846: 17.21747589111328,
              847: 17.246442794799805,
              848: 16.387083053588867,
              849: 16.500957489013672,
              850: 16.420616149902344,
              851: 17.137744903564453,
              852: 17.06749725341797,
              853: 16.566497802734375,
              854: 17.413450241088867,
              855: 16.97846221923828,
              856: 15.8236083984375,
              857: 17.21862030029297,
              858: 17.9429931640625,
              859: 15.688660621643066,
              860: 15.943532943725586,
              861: 16.771345138549805,
              862: 17.28446388244629,
              863: 16.584774017333984,
              864: 15.596362113952637,
              865: 15.985795021057129,
              866: 16.551286697387695,
              867: 15.762459754943848,
              868: 17.161270141601562,
              869: 15.778281211853027,
              870: 15.795893669128418,
              871: 16.00511932373047,
              872: 15.813956260681152,
              873: 15.293477058410645,
              874: 16.793161392211914,
              875: 15.975281715393066,
              876: 16.195053100585938,
              877: 16.74386978149414,
              878: 16.674715042114258,
              880: 16.060184478759766,
              882: 15.12000846862793,
              883: 15.997115135192871,
              884: 15.918742179870605,
              885: 16.481645584106445,
              886: 16.207813262939453,
              887: 15.964542388916016,
              888: 17.174579620361328,
              889: 15.168633460998535,
              890: 16.25554084777832,
              891: 16.644268035888672,
              892: 16.771461486816406,
              893: 16.33737564086914,
              894: 15.968774795532227,
              895: 16.78468894958496,
              896: 16.315519332885742,
              897: 15.797908782958984,
              898: 16.37955093383789,
              899: 16.606733322143555,
              900: 15.456026077270508,
              901: 16.363113403320312,
              902: 15.429601669311523,
              903: 16.900930404663086,
              904: 16.197250366210938,
              906: 16.58376693725586,
              907: 16.89884376525879,
              908: 15.996782302856445,
              909: 16.579973220825195,
              911: 17.38678550720215,
              912: 15.714351654052734,
              914: 16.362844467163086,
              915: 17.13897132873535,
              917: 16.2193660736084,
              919: 17.532560348510742,
              920: 16.953454971313477,
              922: 17.53172492980957,
              923: 16.055965423583984,
              924: 16.64558982849121,
              925: 15.499112129211426,
              926: 15.562359809875488,
              927: 16.754528045654297,
              928: 17.170509338378906,
              931: 16.459028244018555,
              933: 16.832910537719727,
              934: 16.061389923095703,
              935: 16.71774673461914,
              937: 16.21118927001953,
              938: 15.612968444824219,
              939: 16.52787208557129,
              940: 15.582833290100098,
              942: 15.970647811889648,
              944: 16.0644588470459,
              945: 16.605934143066406,
              947: 15.345219612121582,
              949: 16.71139907836914,
              950: 16.07830047607422,
              952: 16.39582061767578,
              954: 14.832887649536133,
              956: 17.71827507019043,
              957: 16.835731506347656,
              959: 16.03388214111328,
              960: 15.984163284301758,
              961: 15.959539413452148,
              962: 15.510828018188477,
              963: 15.642221450805664,
              965: 15.571398735046387,
              967: 15.672139167785645,
              968: 16.02154541015625,
              969: 15.495741844177246,
              970: 15.680977821350098,
              972: 15.546270370483398,
              974: 15.886330604553223,
              982: 16.325063705444336,
              991: 15.35808277130127,
              1014: 15.772295951843262,
              1018: 14.676281929016113,
              1036: 15.666744232177734,
              1038: 16.309450149536133,
              1039: 15.74282455444336,
              1040: 16.13886070251465,
              1041: 16.30188751220703,
              1046: 15.737174987792969,
              1056: 14.55152416229248,
              1062: 14.186180114746094,
              1064: 14.383492469787598,
              1082: 14.193023681640625,
              1094: 15.154014587402344,
              1097: 15.102952003479004,
              1099: 14.496766090393066,
              1106: 15.027217864990234,
              1122: 13.979382514953613,
              1138: 13.209577560424805,
              1142: 14.906586647033691,
              1144: 14.573952674865723,
              1146: 14.713090896606445,
              1147: 14.591826438903809,
              1148: 15.772974967956543,
              1149: 14.370368003845215,
              1151: 15.085780143737793,
              1153: 15.922393798828125,
              1154: 16.456159591674805,
              1155: 16.035184860229492,
              1156: 14.620942115783691,
              1157: 15.315156936645508,
              1159: 16.545682907104492,
              1161: 14.867286682128906,
              1163: 15.123095512390137,
              1164: 14.89378547668457,
              1165: 14.036457061767578,
              1166: 14.800596237182617,
              1168: 15.21275806427002,
              1170: 14.427992820739746,
              1249: 13.504732131958008,
              1250: 13.037403106689453,
              1253: 14.375409126281738,
              1265: 13.220385551452637,
              1268: 14.430791854858398,
              1271: 14.06580924987793,
              1273: 14.249411582946777,
              1274: 13.32471752166748,
              1275: 15.930135726928711,
              1276: 14.001693725585938,
              1278: 13.258199691772461,
              1280: 13.978647232055664,
              1285: 12.633744239807129,
              1317: 13.738290786743164,
              1326: 12.80694580078125,
              1327: 13.93790054321289,
              1332: 13.304344177246094,
              1342: 13.487775802612305,
              1354: 13.536223411560059,
              1374: 13.07443618774414,
              1383: 13.036775588989258,
              1387: 13.120819091796875,
              1390: 12.826217651367188,
              1393: 13.366125106811523,
              1422: 12.79129695892334,
              1423: 12.094329833984375,
              1443: 12.66626262664795,
              1444: 12.819254875183105,
              1448: 12.756916046142578,
              1450: 12.719202995300293,
              1453: 12.905864715576172,
              1455: 12.96784496307373,
              1457: 12.167008399963379,
              1463: 12.234016418457031,
              1469: 12.618558883666992,
              1483: 12.36374282836914,
              1489: 12.003738403320312,
              1492: 12.30242919921875,
              1494: 13.05500602722168,
              1497: 13.174516677856445,
              1515: 11.722922325134277,
              1518: 12.240174293518066,
              1520: 12.699440002441406,
              1522: 13.0513277053833,
              1523: 13.516875267028809,
              1525: 13.359525680541992,
              1527: 13.91065502166748,
              1528: 13.316731452941895,
              1529: 13.160598754882812,
              1530: 13.817926406860352,
              1533: 13.13821792602539,
              1535: 12.161563873291016,
              1537: 13.006024360656738,
              1538: 12.256928443908691,
              1539: 12.567645072937012,
              1540: 12.221476554870605,
              1541: 13.604522705078125,
              1542: 12.045705795288086,
              1543: 13.039745330810547,
              1544: 12.920680046081543,
              1545: 12.152447700500488,
              1546: 11.71026611328125,
              1547: 12.928874969482422,
              1548: 12.478545188903809,
              1549: 12.35512638092041,
              1550: 12.06184196472168,
              1551: 11.69395923614502,
              1553: 12.57833480834961,
              1554: 12.193961143493652,
              1555: 12.769207954406738,
              1556: 12.199830055236816,
              1557: 12.617840766906738,
              1559: 12.474262237548828,
              1560: 11.925416946411133,
              1561: 12.275595664978027,
              1562: 12.646251678466797,
              1563: 12.109790802001953,
              1565: 11.982093811035156,
              1566: 11.518221855163574,
              1567: 12.206852912902832,
              1568: 11.522904396057129,
              1571: 12.267520904541016,
              1573: 12.445524215698242,
              1574: 11.885102272033691,
              1575: 12.715267181396484,
              1576: 12.336324691772461,
              1581: 12.62248706817627,
              1583: 11.970864295959473,
              1672: 11.520678520202637,
              1678: 11.806062698364258,
              1680: 12.013108253479004,
              1683: 12.176131248474121,
              1685: 11.68265438079834,
              1687: 11.651172637939453,
              1689: 11.869800567626953,
              1691: 11.977376937866211,
              1693: 12.478334426879883,
              1695: 11.890114784240723,
              1697: 12.514446258544922,
              1698: 11.582168579101562,
              1699: 12.106941223144531,
              1700: 11.93555736541748,
              1701: 12.416000366210938,
              1702: 11.756423950195312,
              1703: 12.611379623413086,
              1705: 11.591440200805664,
              1707: 11.709486961364746,
              1708: 11.829516410827637,
              1709: 11.37918758392334,
              1710: 11.669604301452637,
              1711: 11.83525562286377,
              1713: 11.968023300170898,
              1715: 12.147216796875,
              1716: 12.32069206237793,
              1717: 11.380109786987305,
              1718: 11.95712947845459,
              1719: 11.785057067871094,
              1720: 12.681073188781738,
              1721: 11.424722671508789,
              1723: 11.516789436340332,
              1724: 11.838508605957031,
              1725: 11.823494911193848,
              1726: 12.108280181884766,
              1729: 11.740886688232422,
              1731: 12.606534004211426,
              1732: 11.894123077392578,
              1737: 12.385780334472656,
              1739: 11.924230575561523,
              1740: 11.410568237304688,
              1745: 11.509292602539062,
              1747: 11.487069129943848,
              1832: 11.618873596191406,
              1913: 10.783965110778809,
              1957: 11.309725761413574,
              1972: 10.963223457336426,
              1974: 11.225793838500977,
              2046: 10.731887817382812,
              2053: 11.124872207641602,
              2057: 10.645015716552734,
              2126: 10.860723495483398,
              2228: 11.144767761230469,
              2388: 10.058114051818848,
              2391: 10.873299598693848,
              2393: 10.322514533996582,
              2396: 10.071541786193848,
              2398: 11.000144004821777,
              2400: 11.210657119750977,
              2627: 10.340682983398438,
              5497: 6.2088623046875,
              9412: 3.9647562503814697,
              14010: 210.8052978515625,
              14015: 9.536808013916016,
              14016: 8.794745445251465,
              20614: 21.084341049194336,
              20636: 30838.22265625,
              21679: 16826584.0,
              23828: 11400.28125,
              23829: 87.43489074707031,
              23830: 360.5307922363281,
              23831: 16.936159133911133,
              23832: 21.995723724365234,
              23833: 929.92431640625,
              23834: 2163.847412109375,
              23835: 45.03194808959961,
              23836: 47.600337982177734,
              23837: 135.88682556152344,
              23838: 20.959754943847656,
              23839: 12.783052444458008,
              23840: 17.45046615600586,
              23841: 84.6451416015625,
              23842: 1441542400.0,
              23843: 633.254150390625,
              23844: 373.6827087402344,
              23845: 68.36048889160156,
              23846: 728256.0625,
              23847: 90.69789123535156,
              23849: 34.58356475830078,
              23850: 21.004016876220703,
              35462: 8659.421875,
              36795: 1470333696.0,
              70263: 6.121031761169434,
              73993: 5.976468563079834,
              77193: 6.005696773529053,
              77653: 5.997102737426758,
              78355: 6.041504859924316,
              80669: 5.867330551147461,
              82650: 5.900740146636963,
              82905: 5.807215690612793},
             &#39;eval/epe&#39;: {2400: 9.185248,
              4800: 4.2028623,
              7200: 2.813796,
              9600: 2.4097838,
              12000: 2.465278,
              14400: 2.0766606,
              16800: 1.8591816,
              19200: 1.7504777,
              21600: 1.5539002,
              24000: 1.4507209,
              26400: 1.558447,
              28800: 1.6785831,
              31200: 1.5146267,
              33600: 1.5346466,
              36000: 1.5506017,
              38400: 1.4878103,
              40800: 1.6079283,
              43200: 1.564309,
              45600: 1.5683211,
              48000: 1.5648656,
              50400: 1.5617591,
              52800: 1.58183,
              55200: 1.5645881,
              57600: 1.6175674,
              60000: 1.5788256,
              62400: 1.5964794,
              64800: 1.595972,
              67200: 1.5868928,
              69600: 1.5927892,
              72000: 1.5593492,
              74400: 1.5076507,
              76800: 1.4866047,
              79200: 1.4400729,
              81600: 1.415839},
             &#39;eval/kl&#39;: {2400: 336.75766,
              4800: 133.7436,
              7200: 90.919266,
              9600: 79.98016,
              12000: 75.61161,
              14400: 71.81049,
              16800: 68.86177,
              19200: 64.70117,
              21600: 62.531147,
              24000: 61.6838,
              26400: 60.50594,
              28800: 58.39731,
              31200: 57.64644,
              33600: 56.465534,
              36000: 55.03464,
              38400: 55.20719,
              40800: 54.157055,
              43200: 53.22272,
              45600: 52.989254,
              48000: 51.762615,
              50400: 50.739693,
              52800: 50.29814,
              55200: 49.378887,
              57600: 48.335327,
              60000: 48.17956,
              62400: 46.95649,
              64800: 46.640835,
              67200: 46.201645,
              69600: 45.273308,
              72000: 45.356358,
              74400: 44.815865,
              76800: 44.83197,
              79200: 45.123486,
              81600: 45.00889},
             &#39;eval/r&#39;: {2400: 0.581390828261099,
              4800: 0.6173072975946368,
              7200: 0.6742898664734047,
              9600: 0.6813554298509046,
              12000: 0.6793214321248953,
              14400: 0.6918109177058884,
              16800: 0.7055906669202685,
              19200: 0.7558055809405407,
              21600: 0.7737655510910134,
              24000: 0.7849423758372606,
              26400: 0.7810415654366675,
              28800: 0.7858356188458189,
              31200: 0.7919829837785752,
              33600: 0.7930353517430386,
              36000: 0.7939633628430379,
              38400: 0.7970960585804999,
              40800: 0.7971755337426015,
              43200: 0.8003772813713222,
              45600: 0.802103425183155,
              48000: 0.8028272288091108,
              50400: 0.8204977106392115,
              52800: 0.8276558590818385,
              55200: 0.8348951820212366,
              57600: 0.8369523124011184,
              60000: 0.8437393613344696,
              62400: 0.846713521730354,
              64800: 0.8440537557085701,
              67200: 0.8451074167205377,
              69600: 0.8417326786543352,
              72000: 0.8476360996437755,
              74400: 0.8458914319421761,
              76800: 0.8472329152250182,
              79200: 0.8514719389225923,
              81600: 0.8512252410267258},
             &#39;eval/r2&#39;: {2400: 36.08332220424602,
              4800: 40.923069922214005,
              7200: 49.27669080435001,
              9600: 50.376716575193115,
              12000: 50.161273593316395,
              14400: 51.86569056059817,
              16800: 53.56748071271964,
              19200: 60.61176954367479,
              21600: 63.276148208654995,
              24000: 64.8996035809869,
              26400: 64.47293529028143,
              28800: 65.14225276672649,
              31200: 66.14421025078543,
              33600: 66.20372677309096,
              36000: 66.43991746087151,
              38400: 66.84004701111667,
              40800: 66.90795055070794,
              43200: 67.35488700548498,
              45600: 67.48340363613984,
              48000: 67.60319772756081,
              50400: 70.1179032469457,
              52800: 71.37081821071749,
              55200: 72.43495715847641,
              57600: 72.70738516092942,
              60000: 73.80458734210262,
              62400: 74.28255336732323,
              64800: 73.82568569211224,
              67200: 73.95331385013729,
              69600: 73.39855539025166,
              72000: 74.4110627014628,
              74400: 74.07569655906947,
              76800: 74.29584764625022,
              79200: 75.06987826522511,
              81600: 75.04845418102899},
             &#39;eval/r_aux&#39;: {2400: 0.6387437308221874,
              4800: 0.6873399653820708,
              7200: 0.7382172963941415,
              9600: 0.7529730335720065,
              12000: 0.7526265490120552,
              14400: 0.7591741604561307,
              16800: 0.7685904377800629,
              19200: 0.7919236930577328,
              21600: 0.8031459104017133,
              24000: 0.8110443664232051,
              26400: 0.8077477983999294,
              28800: 0.8100890065608123,
              31200: 0.8150445392204958,
              33600: 0.8185098126754731,
              36000: 0.8160124834322371,
              38400: 0.8227834288686139,
              40800: 0.8231890673594738,
              43200: 0.8254583903621534,
              45600: 0.8289496493240606,
              48000: 0.8316095901724431,
              50400: 0.8547634178877496,
              52800: 0.866036100506781,
              55200: 0.8723484572881811,
              57600: 0.8752528476203132,
              60000: 0.8799393034846339,
              62400: 0.8852770819768974,
              64800: 0.8832498209835813,
              67200: 0.8861671446903467,
              69600: 0.882570402710384,
              72000: 0.8890534429217397,
              74400: 0.8866549415413671,
              76800: 0.8876599531637787,
              79200: 0.8931855356179313,
              81600: 0.893673370473106},
             &#39;eval/r2_aux&#39;: {2400: 42.69209945900332,
              4800: 49.01757462369891,
              7200: 56.32775523772941,
              9600: 58.38218928026077,
              12000: 58.39291070924365,
              14400: 59.46261060325663,
              16800: 60.81986396035559,
              19200: 64.49339076970888,
              21600: 66.13872115612519,
              24000: 67.28000172145697,
              26400: 66.82465104566081,
              28800: 67.14572127528031,
              31200: 67.92045942991436,
              33600: 68.39929719000014,
              36000: 68.03479627881143,
              38400: 69.02464002502656,
              40800: 69.13151620115511,
              43200: 69.48831047870947,
              45600: 69.96842685922722,
              48000: 70.3808479223889,
              50400: 74.09158497009199,
              52800: 76.0997013697652,
              55200: 77.13539132968421,
              57600: 77.59893892046979,
              60000: 78.42366615810955,
              62400: 79.32603409870794,
              64800: 78.96428494552723,
              67200: 79.44905013593583,
              69600: 78.80498252450967,
              72000: 79.9746506290127,
              74400: 79.53096269759699,
              76800: 79.70260993724541,
              79200: 80.72541613691477,
              81600: 80.8207272736207},
             &#39;eval/disentang&#39;: {2400: 0.13566075,
              4800: 0.13636018,
              7200: 0.1314933,
              9600: 0.14826274,
              12000: 0.14124958,
              14400: 0.1452313,
              16800: 0.16111518,
              19200: 0.15816812,
              21600: 0.19518661,
              24000: 0.17460757,
              26400: 0.16569796,
              28800: 0.18154192,
              31200: 0.19791016,
              33600: 0.18623668,
              36000: 0.18942375,
              38400: 0.19440362,
              40800: 0.18378036,
              43200: 0.2076747,
              45600: 0.2132443,
              48000: 0.20575461,
              50400: 0.21054693,
              52800: 0.24651465,
              55200: 0.19782567,
              57600: 0.17368907,
              60000: 0.20344275,
              62400: 0.18533897,
              64800: 0.17660236,
              67200: 0.17837775,
              69600: 0.1891721,
              72000: 0.17543237,
              74400: 0.18835711,
              76800: 0.19339378,
              79200: 0.18568894,
              81600: 0.19684112},
             &#39;eval/complete&#39;: {2400: 0.09263518,
              4800: 0.13251053,
              7200: 0.16494054,
              9600: 0.17734748,
              12000: 0.21003224,
              14400: 0.2431336,
              16800: 0.25552475,
              19200: 0.2626599,
              21600: 0.26072147,
              24000: 0.24457563,
              26400: 0.25708935,
              28800: 0.27215308,
              31200: 0.26910523,
              33600: 0.29493687,
              36000: 0.29348442,
              38400: 0.29825985,
              40800: 0.28888524,
              43200: 0.29839668,
              45600: 0.30311963,
              48000: 0.3108531,
              50400: 0.30951336,
              52800: 0.3068097,
              55200: 0.27146628,
              57600: 0.30098748,
              60000: 0.2952446,
              62400: 0.28317904,
              64800: 0.27597505,
              67200: 0.2742677,
              69600: 0.26605514,
              72000: 0.26591828,
              74400: 0.27470595,
              76800: 0.27127913,
              79200: 0.26820174,
              81600: 0.27882376},
             &#39;eval/mi&#39;: {24000: 0.39089993492807124,
              48000: 0.48465983583057726,
              72000: 0.6275653342779332},
             &#39;eval/mi_norm&#39;: {24000: 0.1296712290971808,
              48000: 0.15949605280067322,
              72000: 0.20454497565603932},
             &#39;eval/mig&#39;: {24000: 0.03335470770022635,
              48000: 0.048593043821384234,
              72000: 0.058076190125778554}})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;checkpoint&#39;: 70,
 &#39;global_step&#39;: 84000,
 &#39;file&#39;: &#39;VAE+TrainerVAE-0070_(2023_04_19,07:58).pt&#39;,
 &#39;path&#39;: &#39;/home/hadi/Documents/MTMST/models/fixate1_k-32_z-13x[3,6,12]_enc(1x3)-dec(1x2)-pre(1x3)-post(1x3)/ep200-b500-lr(0.002)_beta(0.1:0x0.3)_lamb(0.001)_gr(400.0)_(2023_04_18,16:48)&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">analysis.glm</span> <span class="kn">import</span> <span class="n">_setup_path</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">_setup_path</span><span class="p">(</span><span class="s1">&#39;fixate1_nf-2752_(2023_04_22,08:46)&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">path</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/home/hadi/Documents/MTMST/results/Ridge/fixate1_nf-2752_(2023_04_22,08:46)&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;Trainer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>defaultdict(dict, {})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nf</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ftr_sizes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">nf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2752
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-readout">
<h2>Load Readout<a class="headerlink" href="#load-readout" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;fixate1_nf-2752_(2023_04_20,19:11)&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;Ridge&#39;</span><span class="p">,</span> <span class="n">fit_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_raw</span><span class="p">,</span> <span class="n">perf_all</span><span class="p">,</span> <span class="n">alpha_all</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="n">pix_ranks</span><span class="p">,</span> <span class="n">pix_counts</span><span class="p">,</span> <span class="n">best_lag_all</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pkl&#39;</span><span class="p">):</span>
        <span class="k">continue</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">expt</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">tr</span><span class="o">=</span><span class="n">tr</span><span class="p">,</span>
        <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
        <span class="n">expt</span><span class="o">=</span><span class="n">expt</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ro</span> <span class="o">=</span> <span class="n">Readout</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fit_name</span><span class="p">,</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
    <span class="n">perf_raw</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">alpha_all</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">alpha</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">mod</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>

    <span class="k">if</span> <span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">perf_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">perf_all</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    
    <span class="c1"># pixel stuff</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">best</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">best_pix</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
            <span class="n">ro</span><span class="o">.</span><span class="n">sorted_pix</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">best</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">([</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span>
            <span class="n">ro</span><span class="o">.</span><span class="n">best_pix_all</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="p">])</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">pix_ranks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span> 
        <span class="n">pix_counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="c1"># best lags all</span>
    <span class="n">best_lag_all</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">best_lags</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">perf_all</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_raw</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(141, 0.4627488846519593, 0.5212794165064774)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bench</span> <span class="o">=</span> <span class="n">perf_all</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">perf_all</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/568d104b849d1594390907c2c34fd78f89a3ea8cce3a951d0978d907bde72a93.png" src="../../_images/568d104b849d1594390907c2c34fd78f89a3ea8cce3a951d0978d907bde72a93.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">perf_all</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">avg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;avg = </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">alpha_all</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/693a10179e7cebde6ff6f45b8b9ea3db5712b368b592fbe347bf2e05ad87a6ff.png" src="../../_images/693a10179e7cebde6ff6f45b8b9ea3db5712b368b592fbe347bf2e05ad87a6ff.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5212794165064774
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">pix_ranks</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;pixel rank (0 means top norm in self.spatial)&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">pix_counts</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;pixel count (if it was top in a given lag)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7f93583594e02abaef5882d239ee49540201632a7a47bbeab4354620288c07ff.png" src="../../_images/7f93583594e02abaef5882d239ee49540201632a7a47bbeab4354620288c07ff.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">best_lag_all</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6beb8f5a6b49ee589e5d80412a5211dbabcf59dc4cd29724ccea583a94e05773.png" src="../../_images/6beb8f5a6b49ee589e5d80412a5211dbabcf59dc4cd29724ccea583a94e05773.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;YUWEI-ytu029&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0: 0.1022893510251601,
 1: 0.4360466153773416,
 2: 0.40561412074141145,
 3: 0.37693832371939673,
 4: 0.8206905335123917,
 5: 0.2828317705477584,
 6: 0.31989903465936664,
 7: 0.2096670552929668,
 8: 0.5534566705626145,
 9: 0.48721576839402975,
 12: 0.08779412520737312,
 13: 0.14355472464405394,
 15: 0.5397319499437503,
 16: 0.42146193141461,
 17: 0.4852473335426362,
 18: 0.3074856790506919,
 19: 0.349966116417738,
 20: 0.2323178544653955,
 21: 0.25070800182456693,
 22: 0.6407834500729908,
 23: 0.6973699330553931}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">best_lags</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([10,  0,  9, 10,  2,  0,  3, 10,  2,  2, 10, 10, 10, 10,  2,  0,  6,
        4,  0,  0,  2,  1,  5,  3])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.38814620683198264
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="p">)],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/86277552b8e395e736c13cefe609138c14428959c3631985f40fd82e1cc733c4.png" src="../../_images/86277552b8e395e736c13cefe609138c14428959c3631985f40fd82e1cc733c4.png" />
</div>
</div>
</section>
<section id="id2">
<h2>Reservoir<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;reservoir_nf-2752_(2023_04_21,21:49)&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;Ridge&#39;</span><span class="p">,</span> <span class="n">fit_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_raw</span><span class="p">,</span> <span class="n">perf_all</span><span class="p">,</span> <span class="n">alpha_all</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="n">pix_ranks</span><span class="p">,</span> <span class="n">pix_counts</span><span class="p">,</span> <span class="n">best_lag_all</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pkl&#39;</span><span class="p">):</span>
        <span class="k">continue</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">expt</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">tr</span><span class="o">=</span><span class="n">tr</span><span class="p">,</span>
        <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
        <span class="n">expt</span><span class="o">=</span><span class="n">expt</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ro</span> <span class="o">=</span> <span class="n">Readout</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fit_name</span><span class="p">,</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
    <span class="n">perf_raw</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">alpha_all</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">alpha</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">mod</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>

    <span class="k">if</span> <span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">perf_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">perf_all</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    
    <span class="c1"># pixel stuff</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">best</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">best_pix</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
            <span class="n">ro</span><span class="o">.</span><span class="n">sorted_pix</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">best</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">([</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span>
            <span class="n">ro</span><span class="o">.</span><span class="n">best_pix_all</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="p">])</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">pix_ranks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span> 
        <span class="n">pix_counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="c1"># best lags all</span>
    <span class="n">best_lag_all</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">best_lags</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">perf_all</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_raw</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(141, 0.45964343500818616, 0.5222416549236185)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bench</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.5222416549236185, 0.5212794165064774)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">statistic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">perf_all</span><span class="p">,</span> <span class="n">bench</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)]),</span>
    <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">,</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
    <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">statistic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0016935579472657988
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8124
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">null_distribution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/ce18d04349cc90ff1b4be6cf42efdc22516cf15df47d24c95bca0b73877726d9.png" src="../../_images/ce18d04349cc90ff1b4be6cf42efdc22516cf15df47d24c95bca0b73877726d9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">perf_all</span><span class="p">,</span> <span class="n">bench</span><span class="p">)]</span>
<span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">delta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(84, 127)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_all</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">delta</span><span class="p">)],</span> <span class="n">bench</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">delta</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.2728243675590871, 0.5444310891707166)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_all</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">delta</span><span class="p">)],</span> <span class="n">bench</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">delta</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.7805787338951885, 0.41712638575235755)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">perf_all</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">avg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;avg = </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">alpha_all</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5fbb40e5550ddf4551cec2f7d48702e20e94f8be3c1515eef38c8e563d162239.png" src="../../_images/5fbb40e5550ddf4551cec2f7d48702e20e94f8be3c1515eef38c8e563d162239.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5229729744537431
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.e-02, 1.e-01, 1.e+00, 1.e+01, 1.e+02, 1.e+03, 1.e+04, 1.e+05,
       1.e+06, 1.e+07, 1.e+08, 1.e+09, 1.e+10])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.e-05, 1.e-04, 1.e-03, 1.e-02, 1.e-01, 1.e+00, 1.e+01, 1.e+02,
       1.e+03, 1.e+04, 1.e+05, 1.e+06, 1.e+07, 1.e+08, 1.e+09, 1.e+10])
</pre></div>
</div>
</div>
</div>
</section>
<section id="another">
<h2>Another<a class="headerlink" href="#another" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">base.utils_model</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="n">tr</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;fixate1_k-32_z-20x[3,6,12]_enc(2x2)-dec(2x1)-pre(1x3)-post(1x3)&#39;</span><span class="p">,</span>
    <span class="n">fit_name</span><span class="o">=</span><span class="s1">&#39;ep150-b600-lr(0.002)_beta(0.1:0x0.5)_lamb(0.01)_gr(500.0)_(2023_04_20,13:04)&#39;</span><span class="p">,</span>
    <span class="n">checkpoint</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span>
    <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;checkpoint&#39;: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;checkpoint&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'checkpoint'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grads</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">grads</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">grads</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6c1768cb17a8279e5e68ec1b1f73a833471462ab208940d2cf35a92dd41e2420.png" src="../../_images/6c1768cb17a8279e5e68ec1b1f73a833471462ab208940d2cf35a92dd41e2420.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">grad_clip</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">bad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">grads</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">([</span><span class="s1">&#39;Threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;%&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">thres</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
    <span class="n">tot</span> <span class="o">=</span> <span class="p">(</span><span class="n">bad</span> <span class="o">&gt;</span> <span class="n">thres</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">tot</span> <span class="o">/</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;global_step&#39;</span><span class="p">]</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">perc</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">thres</span><span class="p">,</span> <span class="n">tot</span><span class="p">,</span> <span class="n">perc</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+-----------+-----+-------+
| Threshold |  #  |   %   |
+-----------+-----+-------+
|   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">500.0</span>   | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">239</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.299</span> |
|   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1000.0</span>  | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">155</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.194</span> |
|   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2500.0</span>  | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">130</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.162</span> |
|   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5000.0</span>  | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">122</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.152</span> |
|  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10000.0</span>  | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.125</span> |
|  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25000.0</span>  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">86</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.108</span> |
|  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50000.0</span>  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.088</span> |
|  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100000.0</span> |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span> | <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.074</span> |
+-----------+-----+-------+ 

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nf</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ftr_sizes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">nf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5056
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h2>Load Readout<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_name</span> <span class="o">=</span> <span class="s1">&#39;fixate1_nf-5056_(2023_04_21,10:21)&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;Ridge&#39;</span><span class="p">,</span> <span class="n">fit_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf_raw</span><span class="p">,</span> <span class="n">perf_all</span><span class="p">,</span> <span class="n">alpha_all</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="n">pix_ranks</span><span class="p">,</span> <span class="n">pix_counts</span><span class="p">,</span> <span class="n">best_lag_all</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pkl&#39;</span><span class="p">):</span>
        <span class="k">continue</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">expt</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">tr</span><span class="o">=</span><span class="n">tr</span><span class="p">,</span>
        <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
        <span class="n">expt</span><span class="o">=</span><span class="n">expt</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ro</span> <span class="o">=</span> <span class="n">Readout</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fit_name</span><span class="p">,</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
    <span class="n">perf_raw</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">alpha_all</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">alpha</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">mod</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>

    <span class="k">if</span> <span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">perf_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">perf_all</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    
    <span class="c1"># pixel stuff</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">best</span> <span class="ow">in</span> <span class="n">ro</span><span class="o">.</span><span class="n">best_pix</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
            <span class="n">ro</span><span class="o">.</span><span class="n">sorted_pix</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">best</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">([</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span>
            <span class="n">ro</span><span class="o">.</span><span class="n">best_pix_all</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="p">])</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">best</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">pix_ranks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span> 
        <span class="n">pix_counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="c1"># best lags all</span>
    <span class="n">best_lag_all</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">best_lags</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">perf_all</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_raw</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(141, 0.4457239030404945, 0.5045556079999242)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bench</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.5045556079999242, 0.5212794165064774)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">perf_all</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/75c29e5fe15b3891697ab99d01d671318964760a01eb42fcd031d68dbb7e209e.png" src="../../_images/75c29e5fe15b3891697ab99d01d671318964760a01eb42fcd031d68dbb7e209e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">perf_all</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">perf_all</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">avg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;avg = </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">alpha_all</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c9a5cc6d2a170aa72ee4086de29afa95b30b25979f452c046b10b82ea7dee945.png" src="../../_images/c9a5cc6d2a170aa72ee4086de29afa95b30b25979f452c046b10b82ea7dee945.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5045556079999242
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">pix_ranks</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;pixel rank (0 means top norm in self.spatial)&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">pix_counts</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;pixel count (if it was top in a given lag)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/339214787c5a6572cdb6994053856f554d5c7665b5ed486b7679e5c09c947f0f.png" src="../../_images/339214787c5a6572cdb6994053856f554d5c7665b5ed486b7679e5c09c947f0f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">best_lag_all</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cc9b1cd339b34294c204f173d631a57f3b7a4a769c2184b540b3d15412296bf7.png" src="../../_images/cc9b1cd339b34294c204f173d631a57f3b7a4a769c2184b540b3d15412296bf7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;YUWEI-ytu029&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0: 0.1596385802900117,
 1: 0.4312102769708232,
 2: 0.3711879265713121,
 3: 0.3511400999273341,
 4: 0.6872133525442575,
 5: 0.22031778291950138,
 6: 0.28850032117856056,
 7: 0.418936999488708,
 8: 0.6839463677945891,
 9: 0.5563718545050433,
 12: 0.12707139675259999,
 13: 0.14558917802775995,
 15: 0.4851338791483023,
 16: 0.25815601922508463,
 17: 0.4694858810183009,
 18: 0.3630104050923294,
 19: 0.325555736847559,
 20: 0.05135609208178479,
 21: 0.30060566960055557,
 22: 0.593844425401683,
 23: 0.548627208171222}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">best_lags</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 8,  0,  8,  0,  8, 10,  4,  1,  0,  3,  0,  0,  1, 10,  5,  0, 10,
        3,  0,  0,  0,  9,  2,  9])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3731856882646345
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">max_perf</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="p">)],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ro</span><span class="o">.</span><span class="n">perf</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2abe7d323208c92db5dca2d7b9a21fbfa305b914bfcd784d7ea5583e57c7389a.png" src="../../_images/2abe7d323208c92db5dca2d7b9a21fbfa305b914bfcd784d7ea5583e57c7389a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./nb/2023-04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="25_diameters.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">(25) Diameters: dist</p>
      </div>
    </a>
    <a class="right-next"
       href="26_neural-fits-KABA.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">(26) Load and plot neural results</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-0">Fixate 0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-2">Terrain 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-4">Terrain 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-2-local">Fixate 2 (local)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-1">Fixate 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir">Reservoir</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-1">Terrain 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transl-0">Transl 0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate2">Fixate2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terrain-8">Terrain 8</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-older-stuff-below">Note: older stuff below</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate-1-ema">Fixate 1, EMA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Fixate 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-mask-bug-fixed-res">Apply mask (bug fixed; Res)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-mask-not-res">Apply Mask Not (Res)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-to-latents-reservoir">Fit to latents (Reservoir)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lags-12-res">Lags 12 (res)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir-loop-lags-incorrect-name-it-was-10-lags">Reservoir (loop lags)(incorrect name: it was 10 lags)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir-no-lags-loop">Reservoir (no lags loop)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitted-vae-fixate1-only-top-lag">Fitted VAE fixate1 (only top lag)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitted-vae-fixate1">Fitted VAE (fixate1)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixate1-blue-being-trained">Fixate1 (blue, being trained)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-paradigm-scale-2-no-act-fn-avg-pool-loop-lags">New paradigm: scale=2, no act fn, avg pool, loop lags</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-study-behavior-of-log-a-20-maybe-don-t-need-to-that-far">TODO: study behavior of log_a = -20, maybe don’t need to that far</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-normalize">No Normalize</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#res-50-pcs">Res + 50 PCs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reservoir-version">Reservoir version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trained-vae-version">Trained VAE version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trainer-evaluation">Trainer evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load">Load</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-readout">Load Readout</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Reservoir</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another">Another</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Load Readout</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hadi Vafaii
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>