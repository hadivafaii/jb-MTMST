

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>(04) Debug – obj &#8212; MT/MST project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'nb/2023-05/04_debug-obj';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="(04) Visualize Receptive Fields" href="04_rev-corr.html" />
    <link rel="prev" title="(03) DCI vs. \(\beta\) (KABA)" href="03_dci-beta.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../md/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../md/intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2022-01.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2022-01_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022-01/jan-23-2022.html">Jan 23rd, 2022 (jb tutorial)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">October 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2022-10.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2022-10_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-01-2022.html">Oct 1st, 2022 (Load Wild Data)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-06-2022.html">Oct 6th, 2022 (Python processed)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-07-2022.html">Oct 7th, 2022 (Linear: STA – draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-08-2022.html">Oct 8th, 2022 (Linear: STA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-09-2022.html">Oct 9th, 2022 (Opticflow stats)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-11-2022.html">Oct 11th, 2022 (Rot Conv verify)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022-10/oct-16-2022.html">Oct 16th, 2022 (Linear: GLM – spatial)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-01.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-01_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/08_wild.html">(08) Wild play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/10_nardin.html">(10) Nardin play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/15_sim-draft.html">(15) Simulation – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/16_sim-wrong.html">(16) Simulation – wrong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/21_sim-explore.html">(21) Simulation – explore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/23_sim-self-draft.html">(23) Simulation – self-motion aspect [draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/24_sim-self-draft.html">(24) Simulation – self [still draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/28_sim-self.html">(28) Simulation – self [velocity: new way]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/29_sim-full-draft.html">(29) Simulation – full [draft]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/30_sim-full-final.html">(30) Simulation – full [final]</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">February 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-02.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-02_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/01_play-nvae.html">(01) NVAE – play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/02_play-vae2d.html">(02) VAE2D – play</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/09_rot-conv.html">(09) RotConv2d – verified</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/23_sim-gen.html">(23) Simulation – generate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/24_sim-gen-decoupled.html">(24) Simulation – generate (fix &amp; obj uncoupled)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/24_sim-gen-save.html">(24) Simulation – generate (save)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda.html">(25) Fit – cuda (gaban)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda0.html">(25) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda1.html">(25) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/25_fit-cuda2.html">(25) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/30_kl-balancer-debug.html">(30) KL Balancer</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">March 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-03.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-03_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/17_sim-new-draft.html">(17) Sim New – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/22_sim-new-draft.html">(22) Sim New – draft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/23_sim-new.html">(23) Sim New – visualize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda.html">(30) Fit – cuda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda0.html">(30) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda1.html">(30) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_fit-cuda2.html">(30) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/30_sim-final.html">(30) Sim – added <code class="docutils literal notranslate"><span class="pre">terrain</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-03/31_sim-factors.html">(31) Sim – true generative factors</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">April 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-04.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-04_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/02_fit-lin.html">(02) Fit neurons – Linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/03_fit-glm.html">(03) Fit neurons – GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/03_loop-glm.html">(03) Fit neurons – GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/03_loop-ridge.html">(03) Fit neurons – Ridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/04_dan.html">(04) Dan notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/04_profiler.html">(04) PyTorch profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/06_sim-kNN.html">(06) Sim – kNN analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/07_readout-3d.html">(07) Readout: 3D conv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/07_readout-sep.html">(07) Readout: Separable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/08_GLM-clu090.html">(08) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/08_GLM-clu096.html">(08) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/08_sim-accept-filter.html">(08) Sim – behavior of <code class="docutils literal notranslate"><span class="pre">filter()</span></code> when <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/08_sim-dim65-manyseeds.html">(08) Sim – many seeds <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/09_sim-final-save.html">(09) Sim – generate &amp; save <code class="docutils literal notranslate"><span class="pre">dim=65</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/10_GLM-clu090.html">(10) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/12_GLM-pix.html">(12) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/13_dim17-accept-filter.html">(13) Sim – behavior of <code class="docutils literal notranslate"><span class="pre">filter()</span></code> when <code class="docutils literal notranslate"><span class="pre">dim=17</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/13_dim17-dists.html">(13) Sim – dists for <code class="docutils literal notranslate"><span class="pre">dim=17</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/13_fit-cuda.html">(13) Fit – cuda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/13_fit-cuda0.html">(13) Fit – cuda0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/13_fit-cuda1.html">(13) Fit – cuda1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/13_fit-cuda2.html">(13) Fit – cuda2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/14_GLM-loop.html">(14) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/15_GLM-loop.html">(15) Reservoir + GLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/16_GLM-save.html">(16) Reservoir + GLM + Save</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/18_fixate1-glm-GABAN.html">(18) Fixate1 + GLM (GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/18_fixate1-glm-KABA.html">(18) Fixate1 + GLM (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/20_eval.html">(20) Eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/23_nardin.html">(23) Nardin notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/24_meeting-plots.html">(24) Make some figs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/25_diameters.html">(25) Diameters: dist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/26_neural-fits-GABAN.html">(26) Neural results plot (GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/26_neural-fits-KABA.html">(26) Neural results plot (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/29_combine-fits.html">(29) Combine neural fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/%3F%3F_logging.html">(??) Regression – DCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-04/tmp.html">(??) Tmp</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">May 2023</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-05.html">Summary</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../md/2023-05_updates.html">Updates</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_beta-fits-GABAN.html">(01) Neural <span class="math notranslate nohighlight">\(\beta\)</span> results (GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_beta-fits-KABA.html">(01) Neural <span class="math notranslate nohighlight">\(\beta\)</span> results (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_combine-beta-fits.html">(02) Combine <span class="math notranslate nohighlight">\(\beta\)</span> fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_combine-fits-subset.html">(03) Combine neural fits (subset)</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_dci-beta.html">(03) DCI vs. <span class="math notranslate nohighlight">\(\beta\)</span> (KABA)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">(04) Debug – obj</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_rev-corr.html">(04) Visualize Receptive Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_neural-align.html">(05) Neural <span class="math notranslate nohighlight">\(\beta\)</span> alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_tr-analysis-GABAN.html">(05) Trainers (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_tr-analysis-KABA.html">(05) Trainers (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_neural-analysis-tmp-GABAN.html">(07) Neural analysis (GABAN; tmp)</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_neural-analysis-tmp-KABA.html">(07) Neural analysis (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_neural-analysis-GABAN.html">(09) Neural analysis (GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_neural-analysis-KABA.html">(09) Neural analysis (KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_combine-fits-updated.html">(10) Combine neural fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_resume-fit-GABAN.html">(12) Resume fit (GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_PCA-NMF-Raw.html">(15) PCA, NMF, Raw</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fig_align.html">Fig: Alignment scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fig_DCI.html">Fig: DCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fig_EPE-NELBO.html">Fig: EPE/NELBO</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fig_intro.html">Fig: Intro, etc</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fig_MI.html">Fig: MI</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fig_psth.html">Fig: PSTH + STA</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fig_z-traversal.html">Load</a></li>






<li class="toctree-l2"><a class="reference internal" href="Table_Neural.html">Table: Neural</a></li>
<li class="toctree-l2"><a class="reference internal" href="Table_pvals.html">Table: pvals (perf + align)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tmp.html">tmp</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hadivafaii/jb-MTMST" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hadivafaii/jb-MTMST/issues/new?title=Issue%20on%20page%20%2Fnb/2023-05/04_debug-obj.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/nb/2023-05/04_debug-obj.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>(04) Debug – obj</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trainer">Trainer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review-train-options">Review train options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train">Train</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eval">Eval</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dci">DCI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imshow-expand">Imshow Expand</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="debug-obj">
<h1>(04) Debug – obj<a class="headerlink" href="#debug-obj" title="Permalink to this headline">#</a></h1>
<p><strong>Motivation</strong>: Fitting notebook, cuda (<code class="docutils literal notranslate"><span class="pre">gaban</span></code>), used to debug who obj not working without the shift in mean. <br></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/_extras&#39;</span><span class="p">)</span>
<span class="n">fig_base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/figs&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-MTMST/tmp&#39;</span><span class="p">)</span>

<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;_MTMST&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">vae.train_vae</span> <span class="kn">import</span> <span class="n">TrainerVAE</span><span class="p">,</span> <span class="n">ConfigTrainVAE</span>
<span class="kn">from</span> <span class="nn">vae.vae2d</span> <span class="kn">import</span> <span class="n">VAE</span><span class="p">,</span> <span class="n">ConfigVAE</span>
<span class="kn">from</span> <span class="nn">analysis.opticflow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">figures.fighelper</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># warnings, tqdm, &amp; style</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">rich.jupyter</span> <span class="kn">import</span> <span class="nb">print</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">set_style</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="trainer">
<h2>Trainer<a class="headerlink" href="#trainer" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span> <span class="o">=</span> <span class="n">VAE</span><span class="p">(</span><span class="n">ConfigVAE</span><span class="p">(</span>
    <span class="s1">&#39;obj1&#39;</span><span class="p">,</span> <span class="n">n_enc_cells</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_dec_cells</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_enc_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_dec_nodes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>              
    <span class="n">n_latent_scales</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_groups_per_scale</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_latent_per_group</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">TrainerVAE</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span>
    <span class="n">cfg</span><span class="o">=</span><span class="n">ConfigTrainVAE</span><span class="p">(</span>
        <span class="n">lr</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">160</span><span class="p">,</span> <span class="n">grad_clip</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">warm_restart</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">warmup_portion</span><span class="o">=</span><span class="mf">1.25e-2</span><span class="p">,</span>
        <span class="n">lambda_anneal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lambda_init</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">lambda_norm</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> 
        <span class="n">kl_beta</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">kl_anneal_cycles</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kl_anneal_portion</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">kl_const_portion</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">),</span>
    <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">total_latents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>280
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vae</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
<span class="n">vae</span><span class="o">.</span><span class="n">scales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">+--------------+------------+
| Module Name  | Num Params |
+--------------+------------+
|     VAE      |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.1</span> Mil  |
|     ---      |    ---     |
|     stem     |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">320</span>     |
| pre_process  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">151.6</span> K   |
|  enc_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8.3</span> Mil   |
|     enc0     |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66.0</span> K   |
| enc_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.7</span> Mil   |
| dec_sampler  |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.7</span> Mil   |
|    expand    |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">234.2</span> K   |
|  dec_tower   |  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3.8</span> Mil   |
| post_process |   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67.9</span> K   |
|     out      |    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">578</span>     |
+--------------+------------+ 

</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, 4, 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">vae</span><span class="o">.</span><span class="n">all_conv_layers</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">vae</span><span class="o">.</span><span class="n">all_lognorm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(151, 117)
</pre></div>
</div>
</div>
</div>
</section>
<section id="review-train-options">
<h2>Review train options<a class="headerlink" href="#review-train-options" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">({</span>
    <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span>
    <span class="nb">all</span><span class="p">(</span><span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;useful&#39;</span><span class="p">,</span> <span class="s1">&#39;dir&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">])</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008000; text-decoration-color: #008000">'sim'</span>: <span style="color: #008000; text-decoration-color: #008000">'obj1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_ch'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ker_sz'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>,
    <span style="color: #008000; text-decoration-color: #008000">'input_sz'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_enc_cells'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_enc_nodes'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_dec_cells'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_dec_nodes'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_pre_cells'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_pre_blocks'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_post_cells'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_post_blocks'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_latent_scales'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_latent_per_group'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_groups_per_scale'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>,
    <span style="color: #008000; text-decoration-color: #008000">'spectral_norm'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,
    <span style="color: #008000; text-decoration-color: #008000">'separable'</span>: <span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>,
    <span style="color: #008000; text-decoration-color: #008000">'compress'</span>: <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>,
    <span style="color: #008000; text-decoration-color: #008000">'use_bn'</span>: <span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>,
    <span style="color: #008000; text-decoration-color: #008000">'groups'</span>: <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">]</span>,
    <span style="color: #008000; text-decoration-color: #008000">'seed'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,
    <span style="color: #008000; text-decoration-color: #008000">'balanced_recon'</span>: <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>,
    <span style="color: #008000; text-decoration-color: #008000">'activation_fn'</span>: <span style="color: #008000; text-decoration-color: #008000">'swish'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'residual_kl'</span>: <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>,
    <span style="color: #008000; text-decoration-color: #008000">'scale_init'</span>: <span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ada_groups'</span>: <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>,
    <span style="color: #008000; text-decoration-color: #008000">'use_se'</span>: <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008000; text-decoration-color: #008000">'lr'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.002</span>,
    <span style="color: #008000; text-decoration-color: #008000">'epochs'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">160</span>,
    <span style="color: #008000; text-decoration-color: #008000">'batch_size'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">600</span>,
    <span style="color: #008000; text-decoration-color: #008000">'warm_restart'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,
    <span style="color: #008000; text-decoration-color: #008000">'warmup_portion'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0125</span>,
    <span style="color: #008000; text-decoration-color: #008000">'optimizer'</span>: <span style="color: #008000; text-decoration-color: #008000">'adamax_fast'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'optimizer_kws'</span>: <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'betas'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.999</span><span style="font-weight: bold">)</span>, <span style="color: #008000; text-decoration-color: #008000">'weight_decay'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0003</span>, <span style="color: #008000; text-decoration-color: #008000">'eps'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1e-08</span><span style="font-weight: bold">}</span>,
    <span style="color: #008000; text-decoration-color: #008000">'scheduler_type'</span>: <span style="color: #008000; text-decoration-color: #008000">'cosine'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'scheduler_kws'</span>: <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'T_max'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">158.0</span>, <span style="color: #008000; text-decoration-color: #008000">'eta_min'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1e-05</span><span style="font-weight: bold">}</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ema_rate'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.999</span>,
    <span style="color: #008000; text-decoration-color: #008000">'grad_clip'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1000</span>,
    <span style="color: #008000; text-decoration-color: #008000">'chkpt_freq'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>,
    <span style="color: #008000; text-decoration-color: #008000">'eval_freq'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>,
    <span style="color: #008000; text-decoration-color: #008000">'log_freq'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>,
    <span style="color: #008000; text-decoration-color: #008000">'use_amp'</span>: <span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>,
    <span style="color: #008000; text-decoration-color: #008000">'kl_beta'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.15</span>,
    <span style="color: #008000; text-decoration-color: #008000">'kl_beta_min'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0001</span>,
    <span style="color: #008000; text-decoration-color: #008000">'kl_balancer'</span>: <span style="color: #008000; text-decoration-color: #008000">'equal'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'kl_anneal_cycles'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,
    <span style="color: #008000; text-decoration-color: #008000">'kl_anneal_portion'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>,
    <span style="color: #008000; text-decoration-color: #008000">'kl_const_portion'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05</span>,
    <span style="color: #008000; text-decoration-color: #008000">'lambda_anneal'</span>: <span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>,
    <span style="color: #008000; text-decoration-color: #008000">'lambda_init'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1e-07</span>,
    <span style="color: #008000; text-decoration-color: #008000">'lambda_norm'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0001</span>,
    <span style="color: #008000; text-decoration-color: #008000">'spectral_reg'</span>: <span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">obj1_k-32_z-2<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x</span><span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>,<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>,<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span><span style="font-weight: bold">]</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_enc</span><span style="font-weight: bold">(</span>1x3<span style="font-weight: bold">)</span>-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">dec</span><span style="font-weight: bold">(</span>1x2<span style="font-weight: bold">)</span>-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">pre</span><span style="font-weight: bold">(</span>1x3<span style="font-weight: bold">)</span>-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">post</span><span style="font-weight: bold">(</span>1x3<span style="font-weight: bold">)</span>
ep160-b600-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">lr</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.002</span><span style="font-weight: bold">)</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_beta</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.15</span>:1x0.<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span><span style="font-weight: bold">)</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_lamb</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0001</span><span style="font-weight: bold">)</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_gr</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1000</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span><span class="o">.</span><span class="n">dl_trn</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">tr</span><span class="o">.</span><span class="n">dl_vld</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">tr</span><span class="o">.</span><span class="n">dl_tst</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="train">
<h2>Train<a class="headerlink" href="#train" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Debug5_</span><span class="si">{</span><span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">tr</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gstep # 2.17e+03, nelbo: 13.080, grad: 945.9:   1%| | 2/160 [25:53&lt;34:05:41, 776
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
Cell In[9], line 2
      1 comment = f&quot;Debug5_{tr.cfg.name()}&quot;
----&gt; 2 tr.train(comment)

File ~/Dropbox/git/_MTMST/base/train_base.py:86, in BaseTrainer.train(self, comment, epochs, save)
     79 self.pbar = tqdm(
     80 	epochs,
     81 	dynamic_ncols=True,
     82 	leave=True,
     83 	position=0,
     84 )
     85 for epoch in self.pbar:
---&gt; 86 	avg_loss = self.iteration(epoch, **kwargs)
     87 	msg = &#39;, &#39;.join([
     88 		f&quot;epoch # {epoch + 1:d}&quot;,
     89 		f&quot;avg loss: {avg_loss:3f}&quot;,
     90 	])
     91 	self.pbar.set_description(msg)

File ~/Dropbox/git/_MTMST/vae/train_vae.py:113, in TrainerVAE.iteration(self, epoch, **kwargs)
    111 		loss_sr = None
    112 # backward
--&gt; 113 self.scaler.scale(loss).backward()
    114 self.scaler.unscale_(self.optim)
    115 # clip grad

File ~/anaconda3/lib/python3.8/site-packages/torch/_tensor.py:487, in Tensor.backward(self, gradient, retain_graph, create_graph, inputs)
    477 if has_torch_function_unary(self):
    478     return handle_torch_function(
    479         Tensor.backward,
    480         (self,),
   (...)
    485         inputs=inputs,
    486     )
--&gt; 487 torch.autograd.backward(
    488     self, gradient, retain_graph, create_graph, inputs=inputs
    489 )

File ~/anaconda3/lib/python3.8/site-packages/torch/autograd/__init__.py:200, in backward(tensors, grad_tensors, retain_graph, create_graph, grad_variables, inputs)
    195     retain_graph = create_graph
    197 # The reason we repeat same the comment below is that
    198 # some Python versions print out the first line of a multi-line function
    199 # calls in the traceback and some print out the last line
--&gt; 200 Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
    201     tensors, grad_tensors_, retain_graph, create_graph, inputs,
    202     allow_unreachable=True, accumulate_grad=True)

KeyboardInterrupt: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">sim</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">dl_tst</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_opticflow</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4954ecfdcf02c0a2443bdfa68eb878b2e6c87e528b3816cf0e64a07514419c80.png" src="../../_images/4954ecfdcf02c0a2443bdfa68eb878b2e6c87e528b3816cf0e64a07514419c80.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">x_new</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_opticflow</span><span class="p">(</span><span class="n">x_new</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/704a2c5c99ce3de9d9d22bda5a6a6be4109822db5d326b71a7361c14ad82987d.png" src="../../_images/704a2c5c99ce3de9d9d22bda5a6a6be4109822db5d326b71a7361c14ad82987d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_opticflow_full</span><span class="p">(</span><span class="n">x_new</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fd05cb3c79c864b74f26c2cff061d1c7cf3357aabf654334ffbc80e18ceb391c.png" src="../../_images/fd05cb3c79c864b74f26c2cff061d1c7cf3357aabf654334ffbc80e18ceb391c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/55e7ee8c815f6509014071771869f3abb4be438ecedf77a17e4292b0decc8436.png" src="../../_images/55e7ee8c815f6509014071771869f3abb4be438ecedf77a17e4292b0decc8436.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">x_new</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/477b79958eb9a746d411880659980f33a27ef2cc5477bb0b901960077dc50dd1.png" src="../../_images/477b79958eb9a746d411880659980f33a27ef2cc5477bb0b901960077dc50dd1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/9093dec33f88be45cb77cf278c28d0660b68dd66a0a5f111b9a7ff0025dfc65a.png" src="../../_images/9093dec33f88be45cb77cf278c28d0660b68dd66a0a5f111b9a7ff0025dfc65a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">noise</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f3f20a03970&gt;]
</pre></div>
</div>
<img alt="../../_images/75e4820fdb6892845309fd631009afdb9ae999ceae41a81fe17641a97e072407.png" src="../../_images/75e4820fdb6892845309fd631009afdb9ae999ceae41a81fe17641a97e072407.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">val</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">use_ema</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 17s, sys: 15 s, total: 1min 32s
Wall time: 2min 44s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">loss</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;epe&#39;: 13.123721, &#39;kl&#39;: 255.42374}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;fig&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> (VAE)&quot;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/sample <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/dda3d6698b4d0dc7719a0140f40d9f29128f7fc5b16eea1a924111bc3f77736f.png" src="../../_images/dda3d6698b4d0dc7719a0140f40d9f29128f7fc5b16eea1a924111bc3f77736f.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/regression <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/bc138e059cb75db55ec0b7a8c43bc526298b99606e333ecc86a885dff25def5f.png" src="../../_images/bc138e059cb75db55ec0b7a8c43bc526298b99606e333ecc86a885dff25def5f.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/bar <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/522d746cbf11efb97ba41cce636a3ae3ffd43c6098cceb1a2b38e0e5834506df.png" src="../../_images/522d746cbf11efb97ba41cce636a3ae3ffd43c6098cceb1a2b38e0e5834506df.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/bar_aux <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/b69d8743f1d3302211467db6441744a0931ff8e16cd72b3f2b189264dcbc451b.png" src="../../_images/b69d8743f1d3302211467db6441744a0931ff8e16cd72b3f2b189264dcbc451b.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/mutual_info <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/0235d89329241b56e3c3013809ea02323545bb1079ea45ff70df3e4d29f7382a.png" src="../../_images/0235d89329241b56e3c3013809ea02323545bb1079ea45ff70df3e4d29f7382a.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div></div>
</div>
</section>
<section id="eval">
<h2>Eval<a class="headerlink" href="#eval" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">val</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">use_ema</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">val_ema</span><span class="p">,</span> <span class="n">loss_ema</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">use_ema</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 54s, sys: 27.8 s, total: 2min 22s
Wall time: 5min 33s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss_summary</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">k</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;vae&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s1">&#39;ema&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">loss_ema</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">}</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">loss</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">tr</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="se">\n\n</span><span class="si">{</span><span class="n">loss_summary</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fixate1_k-32_z-13x<span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>,<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span><span style="font-weight: bold">]</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_enc</span><span style="font-weight: bold">(</span>1x3<span style="font-weight: bold">)</span>-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">dec</span><span style="font-weight: bold">(</span>1x2<span style="font-weight: bold">)</span>-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">pre</span><span style="font-weight: bold">(</span>1x3<span style="font-weight: bold">)</span>-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">post</span><span style="font-weight: bold">(</span>1x3<span style="font-weight: bold">)</span>
ep400-b1000-<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">lr</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.002</span><span style="font-weight: bold">)</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_beta</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>:1x0.<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span><span style="font-weight: bold">)</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_lamb</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0001</span><span style="font-weight: bold">)</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">_gr</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1000</span><span style="font-weight: bold">)</span>

<span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'epe'</span>: <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'vae'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.34</span>, <span style="color: #008000; text-decoration-color: #008000">'ema'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.34</span><span style="font-weight: bold">}</span>, <span style="color: #008000; text-decoration-color: #008000">'kl'</span>: <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'vae'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.39</span>, <span style="color: #008000; text-decoration-color: #008000">'ema'</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33.4</span><span style="font-weight: bold">}}</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;fig&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> (VAE)&quot;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> (EMA)&quot;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">val_ema</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/sample <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/1c9e63bbe177bab735ba1feeb5c20bc2c9578609b4fd5b792dadeaa7c98dffce.png" src="../../_images/1c9e63bbe177bab735ba1feeb5c20bc2c9578609b4fd5b792dadeaa7c98dffce.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/sample <span style="font-weight: bold">(</span>EMA<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/c03f83ae64768bb0eb8f88bedac21c74cd6d726f768747a3213d5565ce150cd2.png" src="../../_images/c03f83ae64768bb0eb8f88bedac21c74cd6d726f768747a3213d5565ce150cd2.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/regression <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/d0c0993726f3102f037392a567eace4573f117edcaffc9f8f2641a7058d73904.png" src="../../_images/d0c0993726f3102f037392a567eace4573f117edcaffc9f8f2641a7058d73904.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/regression <span style="font-weight: bold">(</span>EMA<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/bbb9e06337a48507a4aa51c940f9116dcac497a9c6466e711e03dbd6ea2e51dd.png" src="../../_images/bbb9e06337a48507a4aa51c940f9116dcac497a9c6466e711e03dbd6ea2e51dd.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/bar <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/0e3a19116eccc7c4919b612009527a509ddf71fa9dac5e75472c134a8c0f4b0f.png" src="../../_images/0e3a19116eccc7c4919b612009527a509ddf71fa9dac5e75472c134a8c0f4b0f.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/bar <span style="font-weight: bold">(</span>EMA<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/76b368988cc1c7e681f876195fab12fab6597fd5eca118215623acd4659e36c8.png" src="../../_images/76b368988cc1c7e681f876195fab12fab6597fd5eca118215623acd4659e36c8.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/bar_aux <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/42b73fee9c4761bfcc8955947f0d3f34c453140ecfecff49521bd21b0515e1a6.png" src="../../_images/42b73fee9c4761bfcc8955947f0d3f34c453140ecfecff49521bd21b0515e1a6.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/bar_aux <span style="font-weight: bold">(</span>EMA<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/092c4052414fd6f3a98de405881ed277ffc576feba522ba6d3f72588f7ca34eb.png" src="../../_images/092c4052414fd6f3a98de405881ed277ffc576feba522ba6d3f72588f7ca34eb.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/mutual_info <span style="font-weight: bold">(</span>VAE<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/f132f811d28e1a3c500b560188c645195eadf455eaa77016c98c10a4e228b1c1.png" src="../../_images/f132f811d28e1a3c500b560188c645195eadf455eaa77016c98c10a4e228b1c1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">fig/mutual_info <span style="font-weight: bold">(</span>EMA<span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/e7093819bfd32d798be8488f50f5bd7240c9277ac326beb3983fb2e250409098.png" src="../../_images/e7093819bfd32d798be8488f50f5bd7240c9277ac326beb3983fb2e250409098.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">----------------------------------------------------------------------
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>148
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5.07322217e+03, 1.33244140e+05, 2.09492699e+08, 5.26388019e+10])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.00411634e+01, 1.93782291e+01, 2.68291146e+04, 9.56360960e+07])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gamma</span><span class="p">[:</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gamma</span><span class="p">[:</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">1</span><span class="p">:])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gamma</span><span class="p">[:</span><span class="mi">50000</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fc7bcafbfc6f35d8394c9fb9dd6175f3f3853ce4bf8b62e85c49488001671e6b.png" src="../../_images/fc7bcafbfc6f35d8394c9fb9dd6175f3f3853ce4bf8b62e85c49488001671e6b.png" />
</div>
</div>
</section>
<section id="dci">
<h2>DCI<a class="headerlink" href="#dci" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;regr/r2&#39;</span><span class="p">],</span> <span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;regr/r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;regr/r&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0.98787209, 0.98606033, 0.95231735, 0.77244376, 0.52869628,
        0.84190284, 0.83143266, 0.83057672, 0.612863  , 0.3815909 ,
        0.31850108]),
 0.7312960918564673,
 0.8431506020932581)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">do_zscore</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">do_zscore</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;z_vld&#39;</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">dl_vld</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">g</span><span class="p">)</span>
    <span class="n">x_tst</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;z_tst&#39;</span><span class="p">])</span>
    <span class="n">y_tst</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">dl_tst</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">g</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;z_vld&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">dl_vld</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">g</span>
    <span class="n">x_tst</span> <span class="o">=</span> <span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;z_tst&#39;</span><span class="p">]</span>
    <span class="n">y_tst</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">dl_tst</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">g</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">sk_linear</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">r2_out</span> <span class="o">=</span> <span class="n">sk_metric</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span>
    <span class="n">y_true</span><span class="o">=</span><span class="n">y_tst</span><span class="p">,</span>
    <span class="n">y_pred</span><span class="o">=</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_tst</span><span class="p">),</span>
    <span class="n">multioutput</span><span class="o">=</span><span class="s1">&#39;raw_values&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">r_out</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sp_dist</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span>
    <span class="n">XA</span><span class="o">=</span><span class="n">y_tst</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
    <span class="n">XB</span><span class="o">=</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_tst</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">r2_out</span><span class="p">,</span> <span class="n">r2_out</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">r_out</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0.9878726 , 0.98605802, 0.95225915, 0.7724239 , 0.5287071 ,
        0.8416592 , 0.83112916, 0.8305795 , 0.6128181 , 0.3814637 ,
        0.3185065 ]),
 0.7312251771670845,
 0.8431088999788942)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;z_vld&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">dl_vld</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">x_tst</span> <span class="o">=</span> <span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;z_tst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_tst</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">dl_tst</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">sd</span>
<span class="n">x_tst</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_tst</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">sd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">sk_linear</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">r2_out</span> <span class="o">=</span> <span class="n">sk_metric</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span>
    <span class="n">y_true</span><span class="o">=</span><span class="n">y_tst</span><span class="p">,</span>
    <span class="n">y_pred</span><span class="o">=</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_tst</span><span class="p">),</span>
    <span class="n">multioutput</span><span class="o">=</span><span class="s1">&#39;raw_values&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">r_out</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sp_dist</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span>
    <span class="n">XA</span><span class="o">=</span><span class="n">y_tst</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
    <span class="n">XB</span><span class="o">=</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_tst</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">r2_out</span><span class="p">,</span> <span class="n">r2_out</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">r_out</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0.98787209, 0.98606033, 0.95231735, 0.77244376, 0.52869628,
        0.84190284, 0.83143266, 0.83057672, 0.612863  , 0.3815909 ,
        0.31850108]),
 0.7312960918564673,
 0.8431506020932581)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;regr/r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;regr/d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">val_ema</span><span class="p">[</span><span class="s1">&#39;regr/c&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.7312960918564673, 0.1873543, 0.41861686)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">analysis.linear</span> <span class="kn">import</span> <span class="n">compute_dci</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
<span class="n">w</span> <span class="o">*=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">w</span> <span class="o">/=</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">compute_dci</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.1873543, 0.41861686)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((75000, 273), (75000, 11))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">importances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">273</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)):</span>
    <span class="n">_lr</span> <span class="o">=</span> <span class="n">sk_linear</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sk_inspect</span><span class="o">.</span><span class="n">permutation_importance</span><span class="p">(</span>
        <span class="n">_lr</span><span class="p">,</span> <span class="n">x_tst</span><span class="p">,</span> <span class="n">y_tst</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">importances</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">importances_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5c505e258feb4c94b704bbbd5676766f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">importances</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2ad97efb0def821ca328a523489837eca67de684bd603928e24ecd1c578d54e3.png" src="../../_images/2ad97efb0def821ca328a523489837eca67de684bd603928e24ecd1c578d54e3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compute_dci</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.3747561336550221, 0.7044918165259074)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f807f499880&gt;
</pre></div>
</div>
<img alt="../../_images/d3e1f84e18b8249b946219c132e93a9cdf1875c0c1c0bcac7ba6daaf90f3bc6c.png" src="../../_images/d3e1f84e18b8249b946219c132e93a9cdf1875c0c1c0bcac7ba6daaf90f3bc6c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f807e074430&gt;
</pre></div>
</div>
<img alt="../../_images/2db525c999f89c8690112dd0da781930bdc2a74012852ad8dfd1ab71ac7524ba.png" src="../../_images/2db525c999f89c8690112dd0da781930bdc2a74012852ad8dfd1ab71ac7524ba.png" />
</div>
</div>
</section>
<section id="imshow-expand">
<h2>Imshow Expand<a class="headerlink" href="#imshow-expand" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vae</span><span class="o">.</span><span class="n">expand</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">ModuleList</span><span style="font-weight: bold">(</span>
  <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>-<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> x <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">DeConv2D</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #808000; text-decoration-color: #808000">kernel_size</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>, <span style="color: #808000; text-decoration-color: #808000">stride</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">))</span>
  <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>-<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span><span style="font-weight: bold">)</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span> x <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">DeConv2D</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #808000; text-decoration-color: #808000">kernel_size</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span><span style="font-weight: bold">)</span>, <span style="color: #808000; text-decoration-color: #808000">stride</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">))</span>
  <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>-<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span><span style="font-weight: bold">)</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span> x <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">DeConv2D</span><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #808000; text-decoration-color: #808000">kernel_size</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span><span style="font-weight: bold">)</span>, <span style="color: #808000; text-decoration-color: #808000">stride</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">))</span>
<span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">scales</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">latent_scales</span><span class="p">()</span>
<span class="n">num</span> <span class="o">=</span> <span class="n">vae</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_latent_per_group</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vae</span><span class="o">.</span><span class="n">expand</span><span class="p">):</span>
    <span class="n">_w</span> <span class="o">=</span> <span class="n">to_np</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">z</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">z</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">_w</span><span class="p">[</span><span class="n">z</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">z</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;k=</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z=</span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expand_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> (scale = </span><span class="si">{</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cedae4d3e1c32fc461edc36ee136c58739e5a3a385d538cbb7e26d3b67fb39e4.png" src="../../_images/cedae4d3e1c32fc461edc36ee136c58739e5a3a385d538cbb7e26d3b67fb39e4.png" />
<img alt="../../_images/fd2cfe44bd14cf73e2260c4b4ac0fd03af31b983f659970127ab3e367ae516ef.png" src="../../_images/fd2cfe44bd14cf73e2260c4b4ac0fd03af31b983f659970127ab3e367ae516ef.png" />
<img alt="../../_images/e0f0e1e9e5298a10314ba62cce3ce812a28e4135e74e9c00af6c1954603ecd4b.png" src="../../_images/e0f0e1e9e5298a10314ba62cce3ce812a28e4135e74e9c00af6c1954603ecd4b.png" />
<img alt="../../_images/ac8f54cdf6f59c95d7f76e031e272cc9d8c8638f5dd46f27d2a9525fe11005aa.png" src="../../_images/ac8f54cdf6f59c95d7f76e031e272cc9d8c8638f5dd46f27d2a9525fe11005aa.png" />
<img alt="../../_images/d89e9d4a19babbaff75e28ded36f4ab6486d8e818f7930d78de4c57f419b5416.png" src="../../_images/d89e9d4a19babbaff75e28ded36f4ab6486d8e818f7930d78de4c57f419b5416.png" />
<img alt="../../_images/ccd63df086f2a554782fe729ac9654f6c229162553f69fc7755ab5c8f8f76309.png" src="../../_images/ccd63df086f2a554782fe729ac9654f6c229162553f69fc7755ab5c8f8f76309.png" />
<img alt="../../_images/9f19dd2ec4aa67e3b41687b41edc99f3f27b7539c45a286d26fea749f1650c39.png" src="../../_images/9f19dd2ec4aa67e3b41687b41edc99f3f27b7539c45a286d26fea749f1650c39.png" />
<img alt="../../_images/2806687d0bdd0a6e8e5b3a7f75f483550313140d7a700903bf99b9c13fb55bb2.png" src="../../_images/2806687d0bdd0a6e8e5b3a7f75f483550313140d7a700903bf99b9c13fb55bb2.png" />
<img alt="../../_images/b02fe1ac6b3b2240171211d704233132f906f2c1feece940f3334c751f593118.png" src="../../_images/b02fe1ac6b3b2240171211d704233132f906f2c1feece940f3334c751f593118.png" />
<img alt="../../_images/6ae50eaa4e5e13036b1b7c08f7d4c9023dcf8142ff1dff62f117e564d8ab9c45.png" src="../../_images/6ae50eaa4e5e13036b1b7c08f7d4c9023dcf8142ff1dff62f117e564d8ab9c45.png" />
<img alt="../../_images/21826c35265d3e38d0f127424e26bdef7c984bdbd8d3516e2e6b709bc768e4fa.png" src="../../_images/21826c35265d3e38d0f127424e26bdef7c984bdbd8d3516e2e6b709bc768e4fa.png" />
<img alt="../../_images/ba5b2ee27c9305a59b704a25ec1b4d5abd5590fa26f36ade8f77b7a7fcadf5ed.png" src="../../_images/ba5b2ee27c9305a59b704a25ec1b4d5abd5590fa26f36ade8f77b7a7fcadf5ed.png" />
<img alt="../../_images/d0a289fe0562044441c9d0b766d2455cfcd3d3b3148486a15d4d69fbf888f27c.png" src="../../_images/d0a289fe0562044441c9d0b766d2455cfcd3d3b3148486a15d4d69fbf888f27c.png" />
<img alt="../../_images/9fc85a5b70ba2bfd16abd48abfc8e9cc0e8db9e3c37eb93ff76c667438cb39dd.png" src="../../_images/9fc85a5b70ba2bfd16abd48abfc8e9cc0e8db9e3c37eb93ff76c667438cb39dd.png" />
<img alt="../../_images/34fa57cb32c4df30bc638ff89b26bf65d1f463dcbd8d4317ceed08479682369e.png" src="../../_images/34fa57cb32c4df30bc638ff89b26bf65d1f463dcbd8d4317ceed08479682369e.png" />
<img alt="../../_images/87c7a365c88e9c1c50f6682374aa9c52bb8c8e7b56a7014017de36fc0cf466f3.png" src="../../_images/87c7a365c88e9c1c50f6682374aa9c52bb8c8e7b56a7014017de36fc0cf466f3.png" />
<img alt="../../_images/8e3f1760c7b670345f7fb895b7f5a28d8b09a4e60b50db7b82309dc5e6ec0172.png" src="../../_images/8e3f1760c7b670345f7fb895b7f5a28d8b09a4e60b50db7b82309dc5e6ec0172.png" />
<img alt="../../_images/5661d0706e5cb78be29deb81b359d2bb5267a769e355e8a403f7fa14b0af913f.png" src="../../_images/5661d0706e5cb78be29deb81b359d2bb5267a769e355e8a403f7fa14b0af913f.png" />
<img alt="../../_images/9eb8f5a3961fe58db5ee979ef46cb38b8d2ed05d97aa94692f0b7ac8c28436c1.png" src="../../_images/9eb8f5a3961fe58db5ee979ef46cb38b8d2ed05d97aa94692f0b7ac8c28436c1.png" />
<img alt="../../_images/3eb9ba6dc64aa1c6d20916fded177bb87e7d71c5590cb7e0b88e403ee054c408.png" src="../../_images/3eb9ba6dc64aa1c6d20916fded177bb87e7d71c5590cb7e0b88e403ee054c408.png" />
<img alt="../../_images/e24d86f9f37a7938f80d520e944dd1873410ef41cea2121b1f072c9999d42f20.png" src="../../_images/e24d86f9f37a7938f80d520e944dd1873410ef41cea2121b1f072c9999d42f20.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5min 40s, sys: 280 ms, total: 5min 40s
Wall time: 5min 40s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vae</span><span class="o">.</span><span class="n">expand</span><span class="p">):</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()},</span> <span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0124108791351318</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0176</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9984</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0072</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0124</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0103</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0173</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0221</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0197</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0179</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9977</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0204</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9998</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0206</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9178216457366943</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8444</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9364</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8861</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9927</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9025</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8532</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8757</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8678</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9957</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9946</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8517</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9341</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9966</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9390156269073486</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8422</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9937</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9936</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8136</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9194</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9941</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9947</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9604</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0029</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9207</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9083</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9741</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8896</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9607516527175903</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9625</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9630</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9633</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9649</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9635</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9634</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9617</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9536</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9590</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9585</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9626</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9592</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9545</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.935439944267273</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9372</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0790</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9068</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9461</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9345</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9337</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9166</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9369</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9224</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8212</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9307</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9556</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8846462368965149</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8616</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8747</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8896</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8675</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8986</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8772</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8877</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8971</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9168</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8897</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8877</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8624</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8898</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.896066427230835</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9218</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8812</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9079</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9085</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8966</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9212</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8987</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9187</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9011</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8908</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7855</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9001</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9166</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9073945879936218</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8552</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9767</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7339</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9748</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9753</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9737</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9202</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9812</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9762</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8462</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8022</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9673</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8131</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8717076778411865</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9387</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9445</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9354</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6818</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9379</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9407</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6324</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9421</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9415</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9412</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9457</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6104</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9399</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8970179557800293</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8948</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8714</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8805</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8853</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8902</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8885</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0130</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8837</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8860</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8922</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8916</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8934</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8907</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9240987300872803</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9224</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8949</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8920</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.2374</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8908</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8839</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8972</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8900</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8993</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8934</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9010</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9059</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9053</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0245001316070557</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9643</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9660</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9593</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9625</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9568</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9693</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9686</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.7640</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9605</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9559</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9767</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9519</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9628</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8951259255409241</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8540</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9070</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9112</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9223</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8688</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8329</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8431</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9189</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9181</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8035</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9145</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0776</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8647</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9438376426696777</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9391</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9463</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9426</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9197</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9247</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9258</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9312</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9299</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9308</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9309</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9389</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0783</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9318</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9741033315658569</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9059</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9790</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8987</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9792</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9810</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9723</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9781</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8920</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9792</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9776</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9777</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1664</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9761</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9738444089889526</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9877</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9897</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8719</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8697</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0779</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8298</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9948</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9879</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0881</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9898</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0620</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9909</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9199</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9870063066482544</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9470</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9857</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9822</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1290</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9865</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9810</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9824</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9803</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9779</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9801</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9740</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9433</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9817</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0500739812850952</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9906</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.4140</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9378</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9717</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9852</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.2447</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9868</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9905</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1810</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0522</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9227</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9879</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9857</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0333240032196045</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0836</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.2622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9328</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0938</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0092</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9997</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9807</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0376</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0141</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9882</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0738</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9869</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9529003500938416</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8785</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8771</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9166</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9889</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1288</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9280</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9189</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8508</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9570</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.1514</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9348</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8708</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9860</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8749111890792847</span><span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">tensor</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8331</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9205</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9063</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8987</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7384</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9478</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9425</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8818</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7949</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7345</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9482</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8878</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9392</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">device</span>=<span style="color: #008000; text-decoration-color: #008000">'cuda:0'</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./nb/2023-05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="03_dci-beta.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">(03) DCI vs. <span class="math notranslate nohighlight">\(\beta\)</span> (KABA)</p>
      </div>
    </a>
    <a class="right-next"
       href="04_rev-corr.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">(04) Visualize Receptive Fields</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trainer">Trainer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review-train-options">Review train options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train">Train</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eval">Eval</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dci">DCI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imshow-expand">Imshow Expand</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hadi Vafaii
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>